{
  "hash": "ec5000d345daa17d27f538f4778d70d0",
  "result": {
    "markdown": "---\ntitle: \"The Local Food System in Missoula, Montana\"\nsubtitle: \"A Network Analysis\"\nauthor: \"Claire Battaglia\"\ndescription: \"\"\ndate: \"05/20/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\n# editor: visual\ncategories: \n  - Claire Battaglia\n  - final project\n  - local food systems\n  - network analysis\n---\n\n\n\n\n## Background\n\nInterest in locally produced food has grown significantly over the years, as evidenced by the expansion of local food systems in regions across the United States. Yet while some have become incredibly robust---weathering closures during COVID with ease and even capitalizing on the opportunities presented by the disruption to the conventional food system---others have faltered and stalled. Why? What makes a food system successful and resilient?\n\nNetwork analysis offers a unique opportunity to understand food systems *as networks*, allowing us to identify network features that are determinants of food system success and resilience.\n\nIdentifying these features requires the analysis of many, many local food systems as networks, which is beyond the scope of this project. This analysis, then, will serve as a first step by developing a framework for analysis that can be replicated with other food systems in the future.\n\n## Research Question & Hypotheses\n\nWhat are the network determinants of success and resilience for local food systems?\n\nH₁: How a network is formed is a determinant of success/resilience.\n\nH₂: Network size is a determinant of success/resilience.\n\nH₃: The category of entity (i.e. producer, processor, distributor, retailer) with the highest degree centralization is a determinant of success/resilience.\n\nH₄: The category of entity (i.e. producer, processor, distributor, retailer) with the highest betweenness centralization is a determinant of success/resilience.\n\nTesting these hypotheses will not be possible until I have analyzed data from enough networks to build a model in which these features are the predictor variables and food system success and resilience are the outcome variables. For this project, then, I will explore the aforementioned measures and test the following hypotheses pertaining to network formation:\n\nH₁: The degree centralization is different than what we would expect if this network were formed by chance.\n\nH₂: The betweenness centralization is different than what we would expect if this network were formed by chance.\n\n## Methods & Data\n\n### Data\n\nAll data were collected by me and compiled into a node list and edge list.\n\nA node is any entity along the local food supply chain: producer, processor, distributor, retailer.\n\nA tie represents that goods are flowing between two entities. It is a binary classification and does not indicate the type or volume of goods flowing.\n\nI used the [Abundant Montana Local Food Guide](https://abundantmontana.com/), Google Maps, websites of known entities, and field identification and verification to compile both the node and edge list.\n\n### Hypothesis Testing\n\nI will perform a CUG-test to test my hypotheses about network formation.\n\n## Network Structure & Statistics\n\nI'll begin by reading in my data and transforming it into a network object.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# read in data\nnodes <- read.csv(\"food_system_network - nodelist.csv\", header = T, as.is = T)\nlinks <- read.csv(\"food_system_network - edgelist.csv\", header = T, as.is = T)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# preview\nhead(nodes, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 node node_attribute node_attribute_subtype   color\n1 Bison and Bee Honey       producer     specialty products #714466\n2 Clark Fork Organics       producer        general produce #714466\n3    County Rail Farm       producer        general produce #714466\n4         Deluge Farm       producer        general produce #714466\n5        Dixon Melons       producer        general produce #714466\n```\n:::\n\n```{.r .cell-code}\nhead(links, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 from                                  to\n1 Bison and Bee Honey Western Montana Growers Cooperative\n2   Charlie's Produce                     Good Food Store\n3   Charlie's Produce                    Natural Grocer's\n4 Clark Fork Organics Western Montana Growers Cooperative\n5 Clark Fork Organics             Missoula Farmers Market\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# create network object - igraph\nnet <- graph_from_data_frame(d = links, vertices = nodes, directed = T)\n\n# check\nclass(net)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"igraph\"\n```\n:::\n\n```{.r .cell-code}\nprint(net)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nIGRAPH 42d8915 DN-- 53 64 -- \n+ attr: name (v/c), node_attribute (v/c), node_attribute_subtype (v/c),\n| color (v/c)\n+ edges from 42d8915 (vertex names):\n[1] Bison and Bee Honey->Western Montana Growers Cooperative\n[2] Charlie's Produce  ->Good Food Store                    \n[3] Charlie's Produce  ->Natural Grocer's                   \n[4] Clark Fork Organics->Western Montana Growers Cooperative\n[5] Clark Fork Organics->Missoula Farmers Market            \n[6] Clark Fork Organics->Good Food Store                    \n[7] County Rail Farm   ->Clark Fork Market                  \n+ ... omitted several edges\n```\n:::\n:::\n\n\nThis network is *directed*, *named*, and contains 53 nodes and 64 ties. It is unweighted, meaning that each tie represents that goods are flowing but does not convey any other information, such as the type or volume of goods.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# calc density\ngraph.density(net)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.02322206\n```\n:::\n:::\n\n\nThe density of this network appears to be extremely low, although until I have data from other food system networks I can't know whether it is low for *this type of network.*\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# dyad census\nigraph::dyad.census(net)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$mut\n[1] 0\n\n$asym\n[1] 64\n\n$null\n[1] 1314\n```\n:::\n\n```{.r .cell-code}\n# triad census\nigraph::triad.census(net)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 21081  1433     0    24   739   142     0     0     7     0     0     0\n[13]     0     0     0     0\n```\n:::\n:::\n\n\nThere are 0 mutual ties. That is, there are no node pairs who exchange goods with one another—all 64 ties are asymmetrical. There are 1,314 null ties, meaning that for those node pairs there is no flow of goods at all. This is not surprising, as most producers do not sell their products to other producers but to distributors or retailers. And while distributors and retailers purchase from producers, they do not typically sell any products to them.\n\nI have included the censuses as a point of comparison between food system networks as I continue this project but, given the nature of ties between nodes in a food supply chain, dyads and triads might not be as useful in evaluating supply chain networks as they are in evaluating other types of networks.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# get number of components\nigraph::components(net)$no\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 8\n```\n:::\n\n```{.r .cell-code}\n# get size of components\nigraph::components(net)$csize\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 46  1  1  1  1  1  1  1\n```\n:::\n:::\n\n\nThis network has 8 components, one of which contains 46 nodes and 7 isolates.\n\n## Centrality\n\nThe measure of status that I am interested in is degree centrality (both in/out, as this is a directed network). Degree centrality---the number of nodes to which the focal node is connected---is important in the context of a food system because entities with high degree centrality likely have significant influence within the system. In price setting, for example. In comparing local food systems to one another, degree distribution will likely be relevant, as well as which type of entity has the highest degree centrality.\n\nThe measure of power that I am interested in is betweenness centrality. This measure is extremely important to consider when thinking about resilience because entities with high betweenness centrality are likely critical to the system's ability to withstand shock. As with degree centrality, the distribution and type of entity with the highest betweenness centrality will likely be important when comparing local food systems.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create dataframe of node degrees and betweenness\nnet_nodes <- data.frame(name = V(net)$name, degree = degree(net)) %>%\n  mutate(indegree = degree(net, mode = \"in\", loops = FALSE),\n          outdegree = degree(net, mode = \"out\", loops = FALSE),\n          between = betweenness(net))\n\nprint(net_nodes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                                                           name\nBison and Bee Honey                                         Bison and Bee Honey\nClark Fork Organics                                         Clark Fork Organics\nCounty Rail Farm                                               County Rail Farm\nDeluge Farm                                                         Deluge Farm\nDixon Melons                                                       Dixon Melons\nDude's Organic Farm                                         Dude's Organic Farm\nElk Creek Colony                                               Elk Creek Colony\nFive Fox Farm                                                     Five Fox Farm\nFlathead Lake Cheese Co.                               Flathead Lake Cheese Co.\nFoothill Farm                                                     Foothill Farm\nForbidden Fruit Orchard                                 Forbidden Fruit Orchard\nFourth Wave Farm                                               Fourth Wave Farm\nFresh Roots Farm                                               Fresh Roots Farm\nGinger Roots Farm                                             Ginger Roots Farm\nGlacier Tilth Farm                                           Glacier Tilth Farm\nGood Steward Farm                                             Good Steward Farm\nGreen Blade Farm                                               Green Blade Farm\nHarlequin Organic Produce                             Harlequin Organic Produce\nHilltop Haven                                                     Hilltop Haven\nHome Acres Orchard                                           Home Acres Orchard\nLifeline Farm                                                     Lifeline Farm\nLifeline Produce                                               Lifeline Produce\nLowdown Farm                                                       Lowdown Farm\nMission Mountain Organic Eggs                     Mission Mountain Organic Eggs\nMoss Farm                                                             Moss Farm\nMother Fungi                                                       Mother Fungi\nMountain Spring Farm                                       Mountain Spring Farm\nParadise Gardens                                               Paradise Gardens\nPloughshare Farm                                               Ploughshare Farm\nRamrock Orchard                                                 Ramrock Orchard\nSophie's Farm                                                     Sophie's Farm\nSpencer's Valley View Farm                           Spencer's Valley View Farm\nSweet Root Farm                                                 Sweet Root Farm\nThe Orchard at Flathead Lake                       The Orchard at Flathead Lake\nTimeless Seeds, Inc.                                       Timeless Seeds, Inc.\nWild Plum Farm                                                   Wild Plum Farm\nWustner Brothers Honey                                   Wustner Brothers Honey\nAlbertsons                                                           Albertsons\nCharlie's Produce                                             Charlie's Produce\nClark Fork Market                                             Clark Fork Market\nCostco                                                                   Costco\nGood Food Store                                                 Good Food Store\nMission Mountain Food Enterprise Center Mission Mountain Food Enterprise Center\nMissoula Farmers Market                                 Missoula Farmers Market\nNatural Grocer's                                               Natural Grocer's\nOrange Street Food Farm                                 Orange Street Food Farm\nPattee Creek Market                                         Pattee Creek Market\nRoasauers                                                             Roasauers\nTarget                                                                   Target\nWalmart Supercenter                                         Walmart Supercenter\nWestern Montana Growers Cooperative         Western Montana Growers Cooperative\nWinCo                                                                     WinCo\nYoke's Fresh Market                                         Yoke's Fresh Market\n                                        degree indegree outdegree between\nBison and Bee Honey                          1        0         1     0.0\nClark Fork Organics                          3        0         3     0.0\nCounty Rail Farm                             2        0         2     0.0\nDeluge Farm                                  1        0         1     0.0\nDixon Melons                                 3        0         3     0.0\nDude's Organic Farm                          1        0         1     0.0\nElk Creek Colony                             1        0         1     0.0\nFive Fox Farm                                1        0         1     0.0\nFlathead Lake Cheese Co.                     3        0         3     0.0\nFoothill Farm                                1        0         1     0.0\nForbidden Fruit Orchard                      2        0         2     0.0\nFourth Wave Farm                             1        0         1     0.0\nFresh Roots Farm                             1        0         1     0.0\nGinger Roots Farm                            1        0         1     0.0\nGlacier Tilth Farm                           1        0         1     0.0\nGood Steward Farm                            1        0         1     0.0\nGreen Blade Farm                             1        0         1     0.0\nHarlequin Organic Produce                    2        0         2     0.0\nHilltop Haven                                1        0         1     0.0\nHome Acres Orchard                           2        0         2     0.0\nLifeline Farm                                2        0         2     0.0\nLifeline Produce                             3        0         3     0.0\nLowdown Farm                                 1        0         1     0.0\nMission Mountain Organic Eggs                2        0         2     0.0\nMoss Farm                                    1        0         1     0.0\nMother Fungi                                 2        0         2     0.0\nMountain Spring Farm                         1        0         1     0.0\nParadise Gardens                             2        0         2     0.0\nPloughshare Farm                             2        0         2     0.0\nRamrock Orchard                              1        0         1     0.0\nSophie's Farm                                2        0         2     0.0\nSpencer's Valley View Farm                   2        0         2     0.0\nSweet Root Farm                              1        0         1     0.0\nThe Orchard at Flathead Lake                 1        0         1     0.0\nTimeless Seeds, Inc.                         2        0         2     0.0\nWild Plum Farm                               1        0         1     0.0\nWustner Brothers Honey                       1        0         1     0.0\nAlbertsons                                   0        0         0     0.0\nCharlie's Produce                            2        0         2     0.0\nClark Fork Market                            4        4         0     0.0\nCostco                                       0        0         0     0.0\nGood Food Store                             10       10         0     0.0\nMission Mountain Food Enterprise Center      2        1         1     0.5\nMissoula Farmers Market                      8        8         0     0.0\nNatural Grocer's                             2        2         0     0.0\nOrange Street Food Farm                      1        1         0     0.0\nPattee Creek Market                          1        1         0     0.0\nRoasauers                                    0        0         0     0.0\nTarget                                       0        0         0     0.0\nWalmart Supercenter                          0        0         0     0.0\nWestern Montana Growers Cooperative         41       37         4   140.5\nWinCo                                        0        0         0     0.0\nYoke's Fresh Market                          0        0         0     0.0\n```\n:::\n\n```{.r .cell-code}\n# get summary\nsummary(net_nodes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     name               degree          indegree        outdegree    \n Length:53          Min.   : 0.000   Min.   : 0.000   Min.   :0.000  \n Class :character   1st Qu.: 1.000   1st Qu.: 0.000   1st Qu.:1.000  \n Mode  :character   Median : 1.000   Median : 0.000   Median :1.000  \n                    Mean   : 2.415   Mean   : 1.208   Mean   :1.208  \n                    3rd Qu.: 2.000   3rd Qu.: 0.000   3rd Qu.:2.000  \n                    Max.   :41.000   Max.   :37.000   Max.   :4.000  \n    between      \n Min.   :  0.00  \n 1st Qu.:  0.00  \n Median :  0.00  \n Mean   :  2.66  \n 3rd Qu.:  0.00  \n Max.   :140.50  \n```\n:::\n\n```{.r .cell-code}\n#png(filename = \"distributions.png\") # save as png\npar(mfrow = c(1,3))\n# plot in-deg dist\nhist(net_nodes$indegree, col = \"#714466\", main = \"In-degree Distribution\", xlab = \"Number of entities from which goods are received\")\n\n# plot out-deg dist\nhist(net_nodes$outdegree, col = \"#714466\", main = \"Out-degree Distribution\", xlab = \"Number of entities to which goods are sent\")\n\n# plot betweenness\nhist(net_nodes$between, col = \"#714466\", main = \"Betweenness Distribution\", xlab = \"Betweenness\")\n```\n\n::: {.cell-output-display}\n![](ClaireBattaglia_FinalProject_files/figure-html/centrality-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1,1))\n#dev.off()\n```\n:::\n\n\nWe can see that using both degree centrality and betweenness centrality, the Western Montana Growers Cooperative is the most important individual entity in the network. Moreover, we can also see that the network is extremely uneven in that there is only one entity with high degree and high betweenness centrality.\n\n## Network Visualization\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create plot\n#png(filename = \"network.png\") # save as png\nplot(net, vertex.shape = \"circle\", vertex.size = 7, vertex.label.cex = .5, vertex.label.color = \"black\", edge.arrow.size = .25, rescale = TRUE, asp = 0)\n```\n\n::: {.cell-output-display}\n![](ClaireBattaglia_FinalProject_files/figure-html/network plot-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#dev.off()\n```\n:::\n\n\nWe can see in the above plot that the Western Montana Growers Cooperative (in blue) is, indeed, the node with the highest degree centrality and the highest betweenness centrality. We can also easily identify the isolates, all of which are large food retailers. It's important to note that they are only isolates in the *local* food setting.\n\n## Community Detection\n\nI'll use several methods of detecting communities within a network, beginning with the fast and greedy method, and then compare them.\n\n### Fast and Greedy\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# fast and greedy\nnet_fg <- cluster_fast_greedy(as.undirected(net))\n\n# get groups\nigraph::groups(net_fg)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$`1`\n [1] \"Home Acres Orchard\"                     \n [2] \"Lifeline Farm\"                          \n [3] \"Mission Mountain Organic Eggs\"          \n [4] \"Mother Fungi\"                           \n [5] \"Spencer's Valley View Farm\"             \n [6] \"Timeless Seeds, Inc.\"                   \n [7] \"Charlie's Produce\"                      \n [8] \"Good Food Store\"                        \n [9] \"Mission Mountain Food Enterprise Center\"\n[10] \"Natural Grocer's\"                       \n\n$`2`\n [1] \"Bison and Bee Honey\"                 \"Deluge Farm\"                        \n [3] \"Dude's Organic Farm\"                 \"Elk Creek Colony\"                   \n [5] \"Five Fox Farm\"                       \"Foothill Farm\"                      \n [7] \"Fourth Wave Farm\"                    \"Fresh Roots Farm\"                   \n [9] \"Ginger Roots Farm\"                   \"Glacier Tilth Farm\"                 \n[11] \"Good Steward Farm\"                   \"Green Blade Farm\"                   \n[13] \"Hilltop Haven\"                       \"Lowdown Farm\"                       \n[15] \"Moss Farm\"                           \"Mountain Spring Farm\"               \n[17] \"Ramrock Orchard\"                     \"Sweet Root Farm\"                    \n[19] \"The Orchard at Flathead Lake\"        \"Wild Plum Farm\"                     \n[21] \"Wustner Brothers Honey\"              \"Orange Street Food Farm\"            \n[23] \"Pattee Creek Market\"                 \"Western Montana Growers Cooperative\"\n\n$`3`\n[1] \"Clark Fork Organics\"     \"Forbidden Fruit Orchard\"\n[3] \"Lifeline Produce\"        \"Paradise Gardens\"       \n[5] \"Ploughshare Farm\"        \"Sophie's Farm\"          \n[7] \"Missoula Farmers Market\"\n\n$`4`\n[1] \"County Rail Farm\"          \"Dixon Melons\"             \n[3] \"Flathead Lake Cheese Co.\"  \"Harlequin Organic Produce\"\n[5] \"Clark Fork Market\"        \n\n$`5`\n[1] \"Albertsons\"\n\n$`6`\n[1] \"Costco\"\n\n$`7`\n[1] \"Roasauers\"\n\n$`8`\n[1] \"Target\"\n\n$`9`\n[1] \"Walmart Supercenter\"\n\n$`10`\n[1] \"WinCo\"\n\n$`11`\n[1] \"Yoke's Fresh Market\"\n```\n:::\n\n```{.r .cell-code}\n# plot fast and greedy\n#png(filename = \"fg_comms.png\") # save as png\nplot(net_fg, net, vertex.shape = \"circle\", vertex.size = 7, vertex.label.cex = .5, vertex.label.color = \"black\", edge.arrow.size = .25, rescale = TRUE, asp = 0, sub = \"Fast and Greedy Method\")\n```\n\n::: {.cell-output-display}\n![](ClaireBattaglia_FinalProject_files/figure-html/fast and greedy-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#dev.off()\n```\n:::\n\n\nThese groups do actually make sense and can be broadly categorized as follows:\n\n-   Group 1: The Good Food Store and producers that sell directly to it\n-   Group 2: The Western Montana Growers Cooperative, producers that sell *only* to it, and retailers that buy *only* from it (i.e. do not buy from producers directly)\n-   Group 3: Missoula Farmers' Market and producers that participate (even if they also sell to other entities)\n-   Group 4: Clark Fork Market and producers that participate (even if they also sell to other entities)\n-   Groups 5-11: Those individual retailers who do not purchase local food\n\n### Walktrap\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# walktrap\nnet_wt <- walktrap.community(net, steps = 4)\n\n# get groups\nigraph::groups(net_wt)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$`1`\n [1] \"County Rail Farm\"          \"Dixon Melons\"             \n [3] \"Flathead Lake Cheese Co.\"  \"Forbidden Fruit Orchard\"  \n [5] \"Harlequin Organic Produce\" \"Paradise Gardens\"         \n [7] \"Ploughshare Farm\"          \"Sophie's Farm\"            \n [9] \"Clark Fork Market\"         \"Missoula Farmers Market\"  \n\n$`2`\n [1] \"Bison and Bee Honey\"                 \"Clark Fork Organics\"                \n [3] \"Deluge Farm\"                         \"Dude's Organic Farm\"                \n [5] \"Elk Creek Colony\"                    \"Five Fox Farm\"                      \n [7] \"Foothill Farm\"                       \"Fourth Wave Farm\"                   \n [9] \"Fresh Roots Farm\"                    \"Ginger Roots Farm\"                  \n[11] \"Glacier Tilth Farm\"                  \"Good Steward Farm\"                  \n[13] \"Green Blade Farm\"                    \"Hilltop Haven\"                      \n[15] \"Home Acres Orchard\"                  \"Lifeline Farm\"                      \n[17] \"Lifeline Produce\"                    \"Lowdown Farm\"                       \n[19] \"Mission Mountain Organic Eggs\"       \"Moss Farm\"                          \n[21] \"Mother Fungi\"                        \"Mountain Spring Farm\"               \n[23] \"Ramrock Orchard\"                     \"Spencer's Valley View Farm\"         \n[25] \"Sweet Root Farm\"                     \"The Orchard at Flathead Lake\"       \n[27] \"Wild Plum Farm\"                      \"Wustner Brothers Honey\"             \n[29] \"Good Food Store\"                     \"Orange Street Food Farm\"            \n[31] \"Pattee Creek Market\"                 \"Western Montana Growers Cooperative\"\n\n$`3`\n[1] \"Charlie's Produce\" \"Natural Grocer's\" \n\n$`4`\n[1] \"Timeless Seeds, Inc.\"                   \n[2] \"Mission Mountain Food Enterprise Center\"\n\n$`5`\n[1] \"Albertsons\"\n\n$`6`\n[1] \"Costco\"\n\n$`7`\n[1] \"Roasauers\"\n\n$`8`\n[1] \"Target\"\n\n$`9`\n[1] \"Walmart Supercenter\"\n\n$`10`\n[1] \"WinCo\"\n\n$`11`\n[1] \"Yoke's Fresh Market\"\n```\n:::\n\n```{.r .cell-code}\n# plot walktrap\nplot(net_wt, net, vertex.shape = \"circle\", vertex.size = 7, vertex.label.cex = .5, vertex.label.color = \"black\", edge.arrow.size = .25, rescale = TRUE, asp = 0, main = \"Communities Within the Local Food System\", sub = \"Walktrap Method\")\n```\n\n::: {.cell-output-display}\n![](ClaireBattaglia_FinalProject_files/figure-html/walktrap-1.png){width=672}\n:::\n:::\n\n\nAfter tuning the `steps` parameter, this is the best grouping the walktrap method could produce. These communities make less sense than the those identified by the first method. Some communities that the fast and greedy method identified as unique have been collapsed into a single community in a way that does not make sense to me.\n\n### Leading Label Propagation\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# leading label\nnet_ll <- label.propagation.community(net)\n\n# get groups\nigraph::groups(net_ll)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$`1`\n[1] \"Bison and Bee Honey\"\n\n$`2`\n[1] \"Clark Fork Organics\"     \"Missoula Farmers Market\"\n\n$`3`\n[1] \"County Rail Farm\"\n\n$`4`\n[1] \"Deluge Farm\"\n\n$`5`\n[1] \"Dixon Melons\"\n\n$`6`\n[1] \"Dude's Organic Farm\"\n\n$`7`\n[1] \"Elk Creek Colony\"\n\n$`8`\n[1] \"Five Fox Farm\"\n\n$`9`\n[1] \"Flathead Lake Cheese Co.\"\n\n$`10`\n[1] \"Foothill Farm\"\n\n$`11`\n[1] \"Forbidden Fruit Orchard\"\n\n$`12`\n[1] \"Fourth Wave Farm\"\n\n$`13`\n[1] \"Fresh Roots Farm\"\n\n$`14`\n[1] \"Ginger Roots Farm\"\n\n$`15`\n[1] \"Glacier Tilth Farm\"\n\n$`16`\n[1] \"Good Steward Farm\"\n\n$`17`\n[1] \"Green Blade Farm\"\n\n$`18`\n[1] \"Harlequin Organic Produce\" \"Clark Fork Market\"        \n\n$`19`\n[1] \"Hilltop Haven\"\n\n$`20`\n[1] \"Home Acres Orchard\"\n\n$`21`\n[1] \"Lifeline Farm\"\n\n$`22`\n[1] \"Lifeline Produce\" \"Good Food Store\" \n\n$`23`\n[1] \"Lowdown Farm\"\n\n$`24`\n[1] \"Mission Mountain Organic Eggs\"\n\n$`25`\n[1] \"Moss Farm\"\n\n$`26`\n[1] \"Mother Fungi\"\n\n$`27`\n[1] \"Mountain Spring Farm\"\n\n$`28`\n[1] \"Paradise Gardens\"\n\n$`29`\n[1] \"Ploughshare Farm\"\n\n$`30`\n[1] \"Ramrock Orchard\"\n\n$`31`\n[1] \"Sophie's Farm\"\n\n$`32`\n[1] \"Spencer's Valley View Farm\"\n\n$`33`\n[1] \"Sweet Root Farm\"\n\n$`34`\n[1] \"The Orchard at Flathead Lake\"\n\n$`35`\n[1] \"Timeless Seeds, Inc.\"                   \n[2] \"Mission Mountain Food Enterprise Center\"\n\n$`36`\n[1] \"Wild Plum Farm\"\n\n$`37`\n[1] \"Wustner Brothers Honey\"              \"Orange Street Food Farm\"            \n[3] \"Pattee Creek Market\"                 \"Western Montana Growers Cooperative\"\n\n$`38`\n[1] \"Albertsons\"\n\n$`39`\n[1] \"Charlie's Produce\" \"Natural Grocer's\" \n\n$`40`\n[1] \"Costco\"\n\n$`41`\n[1] \"Roasauers\"\n\n$`42`\n[1] \"Target\"\n\n$`43`\n[1] \"Walmart Supercenter\"\n\n$`44`\n[1] \"WinCo\"\n\n$`45`\n[1] \"Yoke's Fresh Market\"\n```\n:::\n\n```{.r .cell-code}\n# plot leading label\nplot(net_ll, net, vertex.shape = \"circle\", vertex.size = 7, vertex.label.cex = .5, vertex.label.color = \"black\", edge.arrow.size = .25, rescale = TRUE, asp = 0, main = \"Communities Within the Local Food System\", sub = \"Leading Label Propagation Method\")\n```\n\n::: {.cell-output-display}\n![](ClaireBattaglia_FinalProject_files/figure-html/leading label-1.png){width=672}\n:::\n:::\n\n\nLeading label propagation has identified 45 distinct communities, which does not fit with how I know these entities interact.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# compare modularity scores\nmods <- c(fastgreedy = modularity(net_fg), walktrap = modularity(net_wt), llabel = modularity(net_ll))\n\nprint(mods)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nfastgreedy   walktrap     llabel \n0.31689453 0.22998047 0.06054688 \n```\n:::\n:::\n\n\nThe modularity scores confirm what examination of the groupings indicate---that the fast and greedy method has done the best job of identifying communities within the network.\n\n## Hypothesis Testing\n\nThe two hypotheses I will test are:\n\nH₁: The degree centralization is different than what we would expect if this network were formed by chance. I will condition on both size (the number of nodes) and edges (the number of ties).\n\nH₂: The betweenness centralization is different than what we would expect if this network were formed by chance. I will condition on both size (the number of nodes) and edges (the number of ties).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# coerce network object\nnet_stat <- intergraph::asNetwork(net)\n\n# check\nclass(net_stat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"network\"\n```\n:::\n\n```{.r .cell-code}\nprint(net_stat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n Network attributes:\n  vertices = 53 \n  directed = TRUE \n  hyper = FALSE \n  loops = FALSE \n  multiple = FALSE \n  bipartite = FALSE \n  total edges= 64 \n    missing edges= 0 \n    non-missing edges= 64 \n\n Vertex attribute names: \n    color node_attribute node_attribute_subtype vertex.names \n\nNo edge attributes\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# cug test - cond on size\ncug_d_size <- cug.test(net_stat,\n                       FUN = centralization,\n                       FUN.arg = list(FUN = \"degree\", mode = \"all\"), \n                       mode = \"digraph\", \n                       cmode = \"size\")\n\n# cug test - cond on edges\ncug_d_edges <- cug.test(net_stat,\n                       FUN = centralization,\n                       FUN.arg = list(FUN = \"degree\", mode = \"all\"), \n                       mode = \"digraph\", \n                       cmode = \"edges\")\n\nprint(cug_d_size)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nUnivariate Conditional Uniform Graph Test\n\nConditioning Method: size \nGraph Type: digraph \nDiagonal Used: FALSE \nReplications: 1000 \n\nObserved Value: 0.3855581 \nPr(X>=Obs): 0 \nPr(X<=Obs): 1 \n```\n:::\n\n```{.r .cell-code}\nprint(cug_d_edges)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nUnivariate Conditional Uniform Graph Test\n\nConditioning Method: edges \nGraph Type: digraph \nDiagonal Used: FALSE \nReplications: 1000 \n\nObserved Value: 0.3855581 \nPr(X>=Obs): 0 \nPr(X<=Obs): 1 \n```\n:::\n\n```{.r .cell-code}\n# combine outputs\ncug_d <- c(cug_d_size$obs.stat,\n           cug_d_edges$obs.stat)\n\npct_g_d <- c(cug_d_size$pgteobs,\n             cug_d_edges$pgteobs)\n\npct_l_d <- c(cug_d_size$plteobs,\n             cug_d_edges$plteobs)\n\ndegree <- cbind(cug_d,\n                     pct_g_d, \n                     pct_l_d)\n\nrownames(degree) <- c(\"Size\", \"Edges\")\n\nround(degree, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      cug_d pct_g_d pct_l_d\nSize   0.39       0       1\nEdges  0.39       0       1\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# plot\n#png(filename = \"CUG_degree.png\")\npar(mfrow = c(1,2))\nplot(cug_d_size, col = \"#ebb83b\", main = \"Degree \\nConditioned on Size\" )\nplot(cug_d_edges, col = \"#ebb83b\", main = \"Degree \\nConditioned on Edges\" )\n```\n\n::: {.cell-output-display}\n![](ClaireBattaglia_FinalProject_files/figure-html/cug degree plots-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow=c(1,1))\n#dev.off\n```\n:::\n\n\nWe can see from the above table and plots that the observed degree centralization is very uncommon for a network of this size and with this number of ties. That is, it was likely not formed by chance.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# cug test - cond on size\ncug_b_size <- cug.test(net_stat,\n                       FUN = centralization,\n                       FUN.arg = list(FUN = \"betweenness\"), \n                       mode = \"digraph\", \n                       cmode = \"size\")\n\n# cug test - cond on edges\ncug_b_edges <- cug.test(net_stat,\n                        FUN = centralization,\n                        FUN.arg = list(FUN = \"betweenness\"), \n                        mode = \"digraph\", \n                        cmode = \"edges\")\n\nprint(cug_b_size)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nUnivariate Conditional Uniform Graph Test\n\nConditioning Method: size \nGraph Type: digraph \nDiagonal Used: FALSE \nReplications: 1000 \n\nObserved Value: 0.05297526 \nPr(X>=Obs): 0 \nPr(X<=Obs): 1 \n```\n:::\n\n```{.r .cell-code}\nprint(cug_b_edges)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nUnivariate Conditional Uniform Graph Test\n\nConditioning Method: edges \nGraph Type: digraph \nDiagonal Used: FALSE \nReplications: 1000 \n\nObserved Value: 0.05297526 \nPr(X>=Obs): 0.48 \nPr(X<=Obs): 0.52 \n```\n:::\n\n```{.r .cell-code}\n# combine outputs\ncug_b <- c(cug_b_size$obs.stat,\n           cug_b_edges$obs.stat)\n\npct_g <- c(cug_b_size$pgteobs,\n           cug_b_edges$pgteobs)\n\npct_l <- c(cug_b_size$plteobs,\n           cug_b_edges$plteobs)\n\nbetweenness <- cbind(cug_b,\n                     pct_g, \n                     pct_l)\n\nrownames(betweenness) <- c(\"Size\", \"Edges\")\n\nround(betweenness, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      cug_b pct_g pct_l\nSize   0.05  0.00  1.00\nEdges  0.05  0.48  0.52\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# plot\n#png(filename = \"CUG_betweenness.png\")\npar(mfrow = c(1,2))\nplot(cug_b_size, col = \"#ebb83b\", main = \"Betweenness \\nConditioned on Size\" )\nplot(cug_b_edges, col = \"#ebb83b\", main = \"Betweenness \\nConditioned on Edges\" )\n```\n\n::: {.cell-output-display}\n![](ClaireBattaglia_FinalProject_files/figure-html/cug betweenness plots-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow=c(1,1))\n#dev.off\n```\n:::\n\n\nWe can see from the second table and set of plots that the observed betweenness centralization is very uncommon for a network of this size but not uncommon for a network with this number of ties.\n\n## Discussion\n\nWe can see from the above exploration that this network is star shaped, meaning that it is likely highly efficient and potentially less resilient. A single node—the Western Montana Growers Cooperative—has the highest degree centrality and the highest betweenness centrality and likely has significant control over the flow of goods (and other content not represented in this network, like information). Thinking about local food system formation, success, and resilience, it may turn out that having one such node is essential. While I haven't operationalized \"success\" and \"resilience\" yet, the local food system in Missoula is generally considered to be fairly robust and, in fact, I coached several nascent local food distributors in other communities who were looking to replicate the success of the Western Montana Growers Cooperative during the COVID-19 pandemic.\n\nI am really interested to see what will surface after I have collected data to analyze other local food systems. That will allow me to determine baselines measurements to compare food systems to. Once I have a dataset in which each local food system (i.e. a network) is its own case and these network features are the variables, I will then operationalize \"success\" and \"resilience\" and be able to see which features predict success and resilience. This is critical because the current literature on local food system development tends to be qualitative, leading to a paucity of actionable recommendations to communities looking to create a robust local food system. This project will ultimately contribute to this body of research by providing clear, actionable recommendations that—importantly!—are driven by data.\n\n\n\n\n\n\n\n\n\n\n",
    "supporting": [
      "ClaireBattaglia_FinalProject_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}