{
  "hash": "6a35876990d4967a3fa1c88b44a3e80f",
  "result": {
    "markdown": "---\ntitle: \"Week 1 Challenge Solutions\"\nauthor: \"Oriol Vall√®s Codina\"\neditor: visual\nformat:\n  html:\n    df-print: paged\n    toc: true\n    code-fold: false\n    code-copy: true\n    code-tools: true\n    css: styles.css\ncategories:\n  - challenge_1\n  - solution\n---\n\n\nBefore starting, the necessary packages should be loaded:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(igraph)\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE,\n                      message=FALSE)\n```\n:::\n\n\n### Marriages in Game of Thrones\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngot.marriages <- read_csv('_data/got/got_marriages.csv')\n\nhead(got.marriages)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"From\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"To\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Type\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Notes\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Generation\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"Targaryen\",\"2\":\"Stark\",\"3\":\"Married\",\"4\":\"R+L=J\",\"5\":\"Current\"},{\"1\":\"Baratheon\",\"2\":\"Martell\",\"3\":\"Engaged\",\"4\":\"died\",\"5\":\"Current\"},{\"1\":\"Baratheon\",\"2\":\"Stark\",\"3\":\"Engaged\",\"4\":\"broken\",\"5\":\"Current\"},{\"1\":\"Martell\",\"2\":\"Essos\",\"3\":\"Married\",\"4\":\"NA\",\"5\":\"Current\"},{\"1\":\"Martell\",\"2\":\"Reach\",\"3\":\"Affair\",\"4\":\"NA\",\"5\":\"Current\"},{\"1\":\"Martell\",\"2\":\"Essos\",\"3\":\"Affair\",\"4\":\"NA\",\"5\":\"Current\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nThe first two columns indicate the list of edges in the network. The network is symmetric and unweighted, but with 3 types of links (married, engaged, or affair):\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(got.marriages$Type)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n Affair Engaged Married \n     36       2     217 \n```\n:::\n:::\n\n\nFinally, a graph can be created using the `igraph` package\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng.got.marriages <- graph_from_data_frame(got.marriages)\n```\n:::\n\n\nand plotted:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(g.got.marriages, edge.arrow.size = 0)\n```\n\n::: {.cell-output-display}\n![](Week1_Challenge_Solutions_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nWe could also color the edges depending on the type of link by creating another column as a factor and changing its levels to color names:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngot.marriages$Type.Color <- as.factor(got.marriages$Type)\n\nlevels(got.marriages$Type.Color)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Affair\"  \"Engaged\" \"Married\"\n```\n:::\n\n```{.r .cell-code}\nlevels(got.marriages$Type.Color) <- c('gray', 'blue', 'green')\n\nE(g.got.marriages)$color <- got.marriages$Type.Color\n\nplot(g.got.marriages, edge.arrow.size = 0)\n```\n\n::: {.cell-output-display}\n![](Week1_Challenge_Solutions_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### Fish Encounters\n\n`fish_encounters` dataset is directly loaded with `tidyverse` or `tidyr`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(fish_encounters)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"fish\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"station\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"seen\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"4842\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4842\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4842\",\"2\":\"Lisbon\",\"3\":\"1\"},{\"1\":\"4842\",\"2\":\"Rstr\",\"3\":\"1\"},{\"1\":\"4842\",\"2\":\"Base_TD\",\"3\":\"1\"},{\"1\":\"4842\",\"2\":\"BCE\",\"3\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nThe graph can be created using:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng.fish <- graph_from_data_frame(fish_encounters)\n\nV(g.fish)$name\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"4842\"    \"4843\"    \"4844\"    \"4845\"    \"4847\"    \"4848\"    \"4849\"   \n [8] \"4850\"    \"4851\"    \"4854\"    \"4855\"    \"4857\"    \"4858\"    \"4859\"   \n[15] \"4861\"    \"4862\"    \"4863\"    \"4864\"    \"4865\"    \"Release\" \"I80_1\"  \n[22] \"Lisbon\"  \"Rstr\"    \"Base_TD\" \"BCE\"     \"BCW\"     \"BCE2\"    \"BCW2\"   \n[29] \"MAE\"     \"MAW\"    \n```\n:::\n:::\n\n\nWe can color the stations by selecting the nodes with names that cannot be converted into numbers:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nV(g.fish)$color[is.na(as.numeric(V(g.fish)$name))] <- 'lightblue'\n\nplot(g.fish, edge.arrow.size = .5)\n```\n\n::: {.cell-output-display}\n![](Week1_Challenge_Solutions_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n### Likes and Dislikes in Game of Thrones\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngot.likes <- read.csv('_data/got/got_like_dislike.csv')\n\nhead(got.likes)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Current.house\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Former.house\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Name\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Lysa.Arryn\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Petyr.Baelish\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Joffrey.Baratheon\"],\"name\":[6],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Margaery.Tyrell\"],\"name\":[7],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Renly.Baratheon\"],\"name\":[8],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Robert.Baratheon\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Stannis.Baratheon\"],\"name\":[10],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Brienne.of.Tarth\"],\"name\":[11],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Bronn\"],\"name\":[12],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Gregor.Clegane\"],\"name\":[13],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Sandor.Clegane\"],\"name\":[14],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Xaro.Xhoan.Daxos\"],\"name\":[15],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Gendry\"],\"name\":[16],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Balon.Greyjoy\"],\"name\":[17],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Theon.Greyjoy\"],\"name\":[18],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Jaqen.H.ghar\"],\"name\":[19],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Hodor\"],\"name\":[20],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Khal.Drogo\"],\"name\":[21],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Cersei.Lannister\"],\"name\":[22],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Jaime.Lannister\"],\"name\":[23],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Lancel.Lannister\"],\"name\":[24],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Tyrion.Lannister\"],\"name\":[25],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Tywin.Lannister\"],\"name\":[26],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Maester.Luwin\"],\"name\":[27],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Melisandre\"],\"name\":[28],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Jeor.Mormont\"],\"name\":[29],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Jorah.Mormont\"],\"name\":[30],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Osha\"],\"name\":[31],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Podrick.Payne\"],\"name\":[32],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Pyat.Pree\"],\"name\":[33],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Grand.Maester.Pycelle\"],\"name\":[34],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Ros\"],\"name\":[35],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Davos.Seaworth\"],\"name\":[36],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Shae\"],\"name\":[37],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Jon.Snow\"],\"name\":[38],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Arya.Stark\"],\"name\":[39],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Bran.Stark\"],\"name\":[40],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Catelyn.Stark\"],\"name\":[41],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Robb.Stark\"],\"name\":[42],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Sansa.Stark\"],\"name\":[43],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Daenerys.Targaryen\"],\"name\":[44],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Viserys.Targaryen\"],\"name\":[45],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Samwell.Tarly\"],\"name\":[46],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Loras.Tyrell\"],\"name\":[47],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Varys\"],\"name\":[48],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Eddard.Stark\"],\"name\":[49],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Arryn\",\"2\":\"Tully\",\"3\":\"Lysa Arryn\",\"4\":\"NA\",\"5\":\"3\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"1\",\"10\":\"0\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"-1\",\"18\":\"-1\",\"19\":\"0\",\"20\":\"2\",\"21\":\"0\",\"22\":\"-1\",\"23\":\"-1\",\"24\":\"-1\",\"25\":\"-1\",\"26\":\"-1\",\"27\":\"1\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"0\",\"33\":\"0\",\"34\":\"0\",\"35\":\"0\",\"36\":\"0\",\"37\":\"0\",\"38\":\"1\",\"39\":\"2\",\"40\":\"2\",\"41\":\"3\",\"42\":\"2\",\"43\":\"2\",\"44\":\"0\",\"45\":\"0\",\"46\":\"0\",\"47\":\"0\",\"48\":\"0\",\"49\":\"3\",\"_rn_\":\"1\"},{\"1\":\"Baelish\",\"2\":\"\",\"3\":\"Petyr Baelish\",\"4\":\"3\",\"5\":\"NA\",\"6\":\"-1\",\"7\":\"1\",\"8\":\"-2\",\"9\":\"1\",\"10\":\"-1\",\"11\":\"0\",\"12\":\"-1\",\"13\":\"-1\",\"14\":\"-1\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"-2\",\"23\":\"-2\",\"24\":\"0\",\"25\":\"-1\",\"26\":\"-2\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"32\":\"-1\",\"33\":\"0\",\"34\":\"-1\",\"35\":\"-2\",\"36\":\"0\",\"37\":\"-1\",\"38\":\"0\",\"39\":\"1\",\"40\":\"1\",\"41\":\"5\",\"42\":\"0\",\"43\":\"3\",\"44\":\"-1\",\"45\":\"0\",\"46\":\"0\",\"47\":\"1\",\"48\":\"-1\",\"49\":\"-3\",\"_rn_\":\"2\"},{\"1\":\"Lannister\",\"2\":\"Baratheon\",\"3\":\"Joffrey Baratheon\",\"4\":\"0\",\"5\":\"-1\",\"6\":\"NA\",\"7\":\"4\",\"8\":\"-3\",\"9\":\"2\",\"10\":\"-5\",\"11\":\"-3\",\"12\":\"-1\",\"13\":\"3\",\"14\":\"4\",\"15\":\"0\",\"16\":\"-5\",\"17\":\"-2\",\"18\":\"-3\",\"19\":\"0\",\"20\":\"-1\",\"21\":\"-3\",\"22\":\"5\",\"23\":\"4\",\"24\":\"1\",\"25\":\"-2\",\"26\":\"3\",\"27\":\"-1\",\"28\":\"-4\",\"29\":\"0\",\"30\":\"-3\",\"31\":\"-2\",\"32\":\"-1\",\"33\":\"0\",\"34\":\"-1\",\"35\":\"-5\",\"36\":\"-2\",\"37\":\"-1\",\"38\":\"-1\",\"39\":\"-2\",\"40\":\"-2\",\"41\":\"-3\",\"42\":\"-5\",\"43\":\"0\",\"44\":\"-5\",\"45\":\"-3\",\"46\":\"0\",\"47\":\"2\",\"48\":\"-1\",\"49\":\"-5\",\"_rn_\":\"3\"},{\"1\":\"Tyrell\",\"2\":\"Baratheon\",\"3\":\"Margaery Tyrell\",\"4\":\"0\",\"5\":\"1\",\"6\":\"3\",\"7\":\"NA\",\"8\":\"5\",\"9\":\"0\",\"10\":\"-5\",\"11\":\"-4\",\"12\":\"0\",\"13\":\"0\",\"14\":\"1\",\"15\":\"0\",\"16\":\"-5\",\"17\":\"-1\",\"18\":\"-2\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"2\",\"23\":\"1\",\"24\":\"0\",\"25\":\"-1\",\"26\":\"3\",\"27\":\"0\",\"28\":\"-4\",\"29\":\"0\",\"30\":\"-2\",\"31\":\"0\",\"32\":\"0\",\"33\":\"0\",\"34\":\"0\",\"35\":\"0\",\"36\":\"-2\",\"37\":\"-1\",\"38\":\"0\",\"39\":\"-1\",\"40\":\"-1\",\"41\":\"-2\",\"42\":\"-5\",\"43\":\"0\",\"44\":\"-5\",\"45\":\"-3\",\"46\":\"0\",\"47\":\"5\",\"48\":\"0\",\"49\":\"0\",\"_rn_\":\"4\"},{\"1\":\"Baratheon\",\"2\":\"\",\"3\":\"Renly Baratheon\",\"4\":\"0\",\"5\":\"-2\",\"6\":\"-5\",\"7\":\"5\",\"8\":\"NA\",\"9\":\"3\",\"10\":\"-5\",\"11\":\"2\",\"12\":\"-1\",\"13\":\"-2\",\"14\":\"-2\",\"15\":\"0\",\"16\":\"-4\",\"17\":\"0\",\"18\":\"-3\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"-4\",\"23\":\"-3\",\"24\":\"-1\",\"25\":\"-2\",\"26\":\"-5\",\"27\":\"1\",\"28\":\"-5\",\"29\":\"0\",\"30\":\"-2\",\"31\":\"0\",\"32\":\"-1\",\"33\":\"0\",\"34\":\"-1\",\"35\":\"0\",\"36\":\"-3\",\"37\":\"-1\",\"38\":\"0\",\"39\":\"2\",\"40\":\"2\",\"41\":\"3\",\"42\":\"2\",\"43\":\"2\",\"44\":\"-5\",\"45\":\"-3\",\"46\":\"0\",\"47\":\"5\",\"48\":\"-1\",\"49\":\"1\",\"_rn_\":\"5\"},{\"1\":\"Baratheon\",\"2\":\"\",\"3\":\"Robert Baratheon\",\"4\":\"2\",\"5\":\"1\",\"6\":\"4\",\"7\":\"0\",\"8\":\"3\",\"9\":\"NA\",\"10\":\"2\",\"11\":\"0\",\"12\":\"0\",\"13\":\"-1\",\"14\":\"0\",\"15\":\"0\",\"16\":\"4\",\"17\":\"-1\",\"18\":\"4\",\"19\":\"0\",\"20\":\"1\",\"21\":\"-4\",\"22\":\"-2\",\"23\":\"-1\",\"24\":\"0\",\"25\":\"1\",\"26\":\"-1\",\"27\":\"2\",\"28\":\"0\",\"29\":\"0\",\"30\":\"-3\",\"31\":\"-2\",\"32\":\"0\",\"33\":\"0\",\"34\":\"1\",\"35\":\"2\",\"36\":\"0\",\"37\":\"0\",\"38\":\"2\",\"39\":\"4\",\"40\":\"4\",\"41\":\"5\",\"42\":\"4\",\"43\":\"4\",\"44\":\"-5\",\"45\":\"-4\",\"46\":\"0\",\"47\":\"0\",\"48\":\"-2\",\"49\":\"5\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nAlthough the data is given in the form of an adjacency matrix, the object is a data frame that needs to be coerced into a matrix. The network is asymmetric and weighted, where negative weights indicate dislike.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng.likes <- graph_from_adjacency_matrix(as.matrix(got.likes[ , - c(1 : 3)]), mode = 'directed', weighted = TRUE)\n```\n:::\n\n\nCharacters in Game of Thrones seem to dislike each other much more than like each other...\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(E(g.likes)$weight)\n```\n\n::: {.cell-output-display}\n![](Week1_Challenge_Solutions_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\nE(g.likes)$color <- colorRampPalette(c(\"red\", \"green\"))(11)[E(g.likes)$weight + 6]\n\nplot(g.likes, edge.arrow.size = 0.5)\n```\n\n::: {.cell-output-display}\n![](Week1_Challenge_Solutions_files/figure-html/unnamed-chunk-12-2.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Week1_Challenge_Solutions_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}