<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jerin Jacob">
<meta name="dcterms.date" content="2023-02-22">

<title>Final Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<meta name="twitter:title" content="Final Project">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://dacss.github.io/Social_Networks_Spring_2023/posts/final_project_jerinjacob_files/figure-html/unnamed-chunk-23-1.png">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:site" content="@UMassDACSS">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/UMass White Wordmark Horiz.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://dacss.github.io/Social_Networks_Spring_2023/" rel="" target="">
 <span class="menu-text">Spring 2023 Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">Contributors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss" rel="" target="">
 <span class="menu-text">DACSS</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://dacss.github.io/Social_Networks_Spring_2023/" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#research-question" id="toc-research-question" class="nav-link" data-scroll-target="#research-question">Research Question</a></li>
  <li><a href="#creating-network" id="toc-creating-network" class="nav-link" data-scroll-target="#creating-network">Creating Network</a>
  <ul class="collapse">
  <li><a href="#creating-the-network" id="toc-creating-the-network" class="nav-link" data-scroll-target="#creating-the-network">Creating the network</a></li>
  </ul></li>
  <li><a href="#describing-the-network-data" id="toc-describing-the-network-data" class="nav-link" data-scroll-target="#describing-the-network-data">Describing the Network Data</a>
  <ul class="collapse">
  <li><a href="#dyad-triad-census" id="toc-dyad-triad-census" class="nav-link" data-scroll-target="#dyad-triad-census">Dyad &amp; Triad Census</a></li>
  <li><a href="#transitivity-global-clustering" id="toc-transitivity-global-clustering" class="nav-link" data-scroll-target="#transitivity-global-clustering">Transitivity/ Global Clustering</a></li>
  <li><a href="#local-transitivity-clustering" id="toc-local-transitivity-clustering" class="nav-link" data-scroll-target="#local-transitivity-clustering">Local Transitivity / Clustering</a></li>
  <li><a href="#path-length-and-geodesic" id="toc-path-length-and-geodesic" class="nav-link" data-scroll-target="#path-length-and-geodesic">Path Length and Geodesic</a></li>
  </ul></li>
  <li><a href="#component-structure-and-membership" id="toc-component-structure-and-membership" class="nav-link" data-scroll-target="#component-structure-and-membership">Component Structure and Membership</a></li>
  <li><a href="#density-of-network" id="toc-density-of-network" class="nav-link" data-scroll-target="#density-of-network">Density of Network</a>
  <ul class="collapse">
  <li><a href="#creating-a-dataframe-with-the-vertex-degree-values" id="toc-creating-a-dataframe-with-the-vertex-degree-values" class="nav-link" data-scroll-target="#creating-a-dataframe-with-the-vertex-degree-values">Creating a Dataframe with the Vertex Degree values</a></li>
  <li><a href="#in-degree-and-out-degree" id="toc-in-degree-and-out-degree" class="nav-link" data-scroll-target="#in-degree-and-out-degree">In degree and out degree</a></li>
  <li><a href="#summary-statistics-of-network-degree" id="toc-summary-statistics-of-network-degree" class="nav-link" data-scroll-target="#summary-statistics-of-network-degree">Summary statistics of Network Degree</a></li>
  <li><a href="#network-degree-distribution" id="toc-network-degree-distribution" class="nav-link" data-scroll-target="#network-degree-distribution">Network Degree Distribution</a></li>
  <li><a href="#network-degree-centralization" id="toc-network-degree-centralization" class="nav-link" data-scroll-target="#network-degree-centralization">Network Degree Centralization</a></li>
  </ul></li>
  <li><a href="#eigen-vector" id="toc-eigen-vector" class="nav-link" data-scroll-target="#eigen-vector">Eigen Vector</a>
  <ul class="collapse">
  <li><a href="#adding-eigen-vector-to-node-level-measures-dataframe" id="toc-adding-eigen-vector-to-node-level-measures-dataframe" class="nav-link" data-scroll-target="#adding-eigen-vector-to-node-level-measures-dataframe">Adding Eigen Vector to node level measures dataframe</a></li>
  <li><a href="#bonacich-power-centrality-to-the-dataframe" id="toc-bonacich-power-centrality-to-the-dataframe" class="nav-link" data-scroll-target="#bonacich-power-centrality-to-the-dataframe">Bonacich Power Centrality to the dataframe</a></li>
  <li><a href="#derived-and-reflected-centrality" id="toc-derived-and-reflected-centrality" class="nav-link" data-scroll-target="#derived-and-reflected-centrality">Derived and Reflected Centrality</a></li>
  <li><a href="#centrality-score-distribution" id="toc-centrality-score-distribution" class="nav-link" data-scroll-target="#centrality-score-distribution">Centrality Score Distribution</a></li>
  <li><a href="#centrality-measure-correlations" id="toc-centrality-measure-correlations" class="nav-link" data-scroll-target="#centrality-measure-correlations">Centrality Measure Correlations</a></li>
  <li><a href="#closeness-centrality" id="toc-closeness-centrality" class="nav-link" data-scroll-target="#closeness-centrality">Closeness Centrality</a></li>
  <li><a href="#betweenness-centrality" id="toc-betweenness-centrality" class="nav-link" data-scroll-target="#betweenness-centrality">Betweenness Centrality</a></li>
  <li><a href="#network-constraint" id="toc-network-constraint" class="nav-link" data-scroll-target="#network-constraint">Network Constraint</a></li>
  <li><a href="#centrality-measure-correlations-1" id="toc-centrality-measure-correlations-1" class="nav-link" data-scroll-target="#centrality-measure-correlations-1">Centrality Measure Correlations</a></li>
  </ul></li>
  <li><a href="#most-and-least-influential-industries-and-their-contribution-to-the-waste-output" id="toc-most-and-least-influential-industries-and-their-contribution-to-the-waste-output" class="nav-link" data-scroll-target="#most-and-least-influential-industries-and-their-contribution-to-the-waste-output">Most and Least influential industries and their contribution to the waste output</a>
  <ul class="collapse">
  <li><a href="#waste-output-from-most-significant-industries" id="toc-waste-output-from-most-significant-industries" class="nav-link" data-scroll-target="#waste-output-from-most-significant-industries">Waste output from most significant industries</a></li>
  <li><a href="#waste-output-from-industries-with-high-redundancy" id="toc-waste-output-from-industries-with-high-redundancy" class="nav-link" data-scroll-target="#waste-output-from-industries-with-high-redundancy">Waste output from industries with high redundancy</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#limitation" id="toc-limitation" class="nav-link" data-scroll-target="#limitation">Limitation</a></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference">Reference:</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Final Project</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">final_project</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jerin Jacob </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 22, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>We are living in a world that produces a huge volume of waste everyday. It is estimated that by 2050, the global waste produced will be more than 3.4 billion tons every year. Certain industries produce large volume of waste while some other industries are considered to be cleaner than others. The world has already moved towards recycling as a part of reducing waste dumped in overall. Waste materials produced by certain industries can be used as raw material for certain other industries. This project is an attempt to study the input-output data of materials between industries and the categories of wastes each industries produce. The dataset is from the ‘Waste Input Output Analysis’ by Nakamura, S. and Kondo, Yasushi. It is a data from Japan and therefore the economic flow is given in 1 million Japanese yen. The analysis will help us to find which all industries serve how many other industries with the goods they produce and compare it with the waste emission by each of those industires.</p>
</section>
<section id="research-question" class="level1">
<h1>Research Question</h1>
<p>How the most influencial industries in terms of their interaction to other industries contribute to the wastes produced?</p>
<p>Reading the Data</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>data_2011 <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"_data/Project_data/WIO_2011.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"WIOdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...1`</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_2011)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 103
  ...1      `Crop cultivation` Livestock Agricultural service…¹ Forestry Fishery
  &lt;chr&gt;                  &lt;dbl&gt;     &lt;dbl&gt;                  &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1 Crop cul…             183568    305684                   7436     2481       0
2 Livestock              47771    238628                  14235       11       0
3 Agricult…             337249    176157                      0       20       0
4 Forestry                1321         0                      0    86929     216
5 Fishery                    0         0                      0        0   54905
6 Metallic…                  0         0                      0        0       0
# ℹ abbreviated name: ¹​`Agricultural services`
# ℹ 97 more variables: `Metallic ores` &lt;dbl&gt;, `Coal mining etc.` &lt;dbl&gt;,
#   `Non-metallic ores` &lt;dbl&gt;, Foods &lt;dbl&gt;, Beverage &lt;dbl&gt;,
#   `Feeds &amp; organic fertilizer` &lt;dbl&gt;, Tobacco &lt;dbl&gt;,
#   `Textile products` &lt;dbl&gt;, `Wearing apparel etc.` &lt;dbl&gt;,
#   `Lumber and wood products` &lt;dbl&gt;, `Furniture &amp; fixtures` &lt;dbl&gt;,
#   `Pulp &amp; paper` &lt;dbl&gt;, `Paper products` &lt;dbl&gt;, `Printing etc.` &lt;dbl&gt;, …</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data_2011</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data_2011)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 294 103</code></pre>
</div>
</div>
<p>The dataset has 294 rows and 103 columns. We are interested in only the output flow between industries and the waste flow from industries to different waste management processes. Therefore, we can trim the data as a subset which is in the form we want.<br>
## Cleaning Data</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> data_2011[<span class="dv">1</span><span class="sc">:</span><span class="dv">81</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">92</span>]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 92
  ...1      `Crop cultivation` Livestock Agricultural service…¹ Forestry Fishery
  &lt;chr&gt;                  &lt;dbl&gt;     &lt;dbl&gt;                  &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1 Crop cul…             183568    305684                   7436     2481       0
2 Livestock              47771    238628                  14235       11       0
3 Agricult…             337249    176157                      0       20       0
4 Forestry                1321         0                      0    86929     216
5 Fishery                    0         0                      0        0   54905
6 Metallic…                  0         0                      0        0       0
# ℹ abbreviated name: ¹​`Agricultural services`
# ℹ 86 more variables: `Metallic ores` &lt;dbl&gt;, `Coal mining etc.` &lt;dbl&gt;,
#   `Non-metallic ores` &lt;dbl&gt;, Foods &lt;dbl&gt;, Beverage &lt;dbl&gt;,
#   `Feeds &amp; organic fertilizer` &lt;dbl&gt;, Tobacco &lt;dbl&gt;,
#   `Textile products` &lt;dbl&gt;, `Wearing apparel etc.` &lt;dbl&gt;,
#   `Lumber and wood products` &lt;dbl&gt;, `Furniture &amp; fixtures` &lt;dbl&gt;,
#   `Pulp &amp; paper` &lt;dbl&gt;, `Paper products` &lt;dbl&gt;, `Printing etc.` &lt;dbl&gt;, …</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>industry_io <span class="ot">&lt;-</span> data_2011[<span class="dv">1</span><span class="sc">:</span><span class="dv">81</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">82</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>waste_io <span class="ot">&lt;-</span> data_2011[<span class="dv">1</span><span class="sc">:</span><span class="dv">81</span>, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">83</span><span class="sc">:</span><span class="dv">92</span>)]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(waste_io)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
  ...1    Incineration Dehydration Concentration Shredding Filtration Composting
  &lt;chr&gt;          &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
1 Crop c…            0           0             0         0          0          0
2 Livest…            0           0             0         0          0          0
3 Agricu…            0           0             0         0          0          0
4 Forest…            0           0             0         0          0          0
5 Fishery            0           0             0         0          0          0
6 Metall…            0           0             0         0          0          0
# ℹ 4 more variables: `Feed conversion` &lt;dbl&gt;, Gasification &lt;dbl&gt;,
#   `Refuse derived fuel` &lt;dbl&gt;, Landfill &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="creating-network" class="level1">
<h1>Creating Network</h1>
<p>After cleaning the dataset, next step is to create network data out of it.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#df &lt;- industry_io</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the data to long format</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(df, <span class="at">id.vars =</span> <span class="st">"...1"</span>, <span class="at">variable.name =</span> <span class="st">"to"</span>, <span class="at">value.name =</span> <span class="st">"weight"</span>, <span class="at">variable.factor =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the "Industries" column to "From"</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_long)[<span class="fu">colnames</span>(df_long) <span class="sc">==</span> <span class="st">"...1"</span>] <span class="ot">&lt;-</span> <span class="st">"from"</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop rows with weight 0</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df_long[df_long<span class="sc">$</span>weight <span class="sc">!=</span> <span class="dv">0</span>, ]</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df_long <span class="sc">|&gt;</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">waste_process =</span> <span class="fu">ifelse</span>(to <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Incineration"</span>, <span class="st">"Dehydration"</span>, <span class="st">"Concentration"</span>, <span class="st">"Shredding"</span>, <span class="st">"Filtration"</span>, <span class="st">"Composting"</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Feed conversion"</span>, <span class="st">"Gasification"</span>, <span class="st">"Refuse derived fuel"</span>, <span class="st">"Landfill"</span>), <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                         from               to weight waste_process
1            Crop cultivation Crop cultivation 183568             0
2                   Livestock Crop cultivation  47771             0
3       Agricultural services Crop cultivation 337249             0
4                    Forestry Crop cultivation   1321             0
11 Feeds &amp; organic fertilizer Crop cultivation  46056             0
13           Textile products Crop cultivation    829             0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4167    4</code></pre>
</div>
</div>
<p>There are negative values in the ‘weight’ column. When the value is negative in directed network, it could be probably because the transaction was done in the reverse direction. So, assuming likewise, we can swap the from and to where weight is negative and then get the absolute values for weight so that we don’t want to deal with anymore negative values!</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   4167 obs. of  4 variables:
 $ from         : chr  "Crop cultivation" "Livestock" "Agricultural services" "Forestry" ...
 $ to           : Factor w/ 91 levels "Crop cultivation",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ weight       : num  183568 47771 337249 1321 46056 ...
 $ waste_process: num  0 0 0 0 0 0 0 0 0 0 ...</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df_long<span class="sc">$</span>to <span class="ot">&lt;-</span> <span class="fu">as.character</span>(df_long<span class="sc">$</span>to)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_from =</span> <span class="fu">ifelse</span>(weight <span class="sc">&lt;</span> <span class="dv">0</span>, to, from),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">new_to =</span> <span class="fu">ifelse</span>(weight <span class="sc">&lt;</span> <span class="dv">0</span>, from, to)) <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(from, to)) <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight =</span> <span class="fu">abs</span>(weight)) <span class="sc">%&gt;%</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> new_from, <span class="at">to =</span> new_to)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df_long[, <span class="fu">c</span>(<span class="st">"from"</span>, <span class="st">"to"</span>, <span class="st">"weight"</span>, <span class="st">"waste_process"</span>)]</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>df_long <span class="sc">|&gt;</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(waste_process <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                      from           to      weight waste_process
1         Coal mining etc. Incineration   16.705982             1
2         Textile products Incineration   44.167870             1
3     Wearing apparel etc. Incineration 2035.383591             1
4 Lumber and wood products Incineration    2.975038             1
5     Furniture &amp; fixtures Incineration 2438.157947             1
6             Pulp &amp; paper Incineration  192.004366             1</code></pre>
</div>
</div>
<section id="creating-the-network" class="level2">
<h2 class="anchored" data-anchor-id="creating-the-network">Creating the network</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>g_df <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(df_long)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the weighted vertex attribute values from the dataframe</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#vertex_attributes &lt;- df[, 82:92]</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(g_df)<span class="sc">$</span>weight <span class="ot">&lt;-</span> df_long<span class="sc">$</span>weight</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#E(g_df)$waste_process &lt;- df_long$waste_process</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>process_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Incineration"</span>, <span class="st">"Dehydration"</span>, <span class="st">"Concentration"</span>, <span class="st">"Shredding"</span>, <span class="st">"Filtration"</span>, <span class="st">"Composting"</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Feed conversion"</span>, <span class="st">"Gasification"</span>, <span class="st">"Refuse derived fuel"</span>, <span class="st">"Landfill"</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty vector to store the attribute values</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>vertex_attribute <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"industry"</span>, <span class="fu">vcount</span>(g_df))</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the vertices with names in the list and assign attribute value of "waste processing"</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>matching_vertices <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(g_df)<span class="sc">$</span>name <span class="sc">%in%</span> process_names)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>vertex_attribute[matching_vertices] <span class="ot">&lt;-</span> <span class="st">"waste processing"</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the vertex attribute to the graph</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_df)<span class="sc">$</span>process <span class="ot">&lt;-</span> vertex_attribute</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co">#V(g_df)$process</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>(df_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "from"          "to"            "waste_process" "weight"       </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(g_df)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="describing-the-network-data" class="level1">
<h1>Describing the Network Data</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vcount</span>(g_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 90</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ecount</span>(g_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4167</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is_bipartite</span>(g_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is_directed</span>(g_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is_weighted</span>(g_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>The network has 90 vertices and 4167 edges.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">E</span>(g_df)<span class="sc">$</span>weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
       0      467     5410   110218    36673 11899111 </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vertex_attr_names</span>(g_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "name"    "process"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">edge_attr_names</span>(g_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "weight"        "waste_process"</code></pre>
</div>
</div>
<section id="dyad-triad-census" class="level2">
<h2 class="anchored" data-anchor-id="dyad-triad-census">Dyad &amp; Triad Census</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">dyad.census</span>(g_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$mut
[1] 1064

$asym
[1] 1951

$null
[1] 990</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">triad_census</span>(g_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  7680 10472  2204 21177  1242  2515   663 11570 11335   188  1561  2147
[13] 21579  2396 12177  8574</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(igraph<span class="sc">::</span><span class="fu">triad_census</span>(g_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 117480</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">90</span><span class="sc">*</span><span class="dv">89</span><span class="sc">*</span><span class="dv">88</span>)<span class="sc">/</span>(<span class="dv">3</span><span class="sc">*</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 117480</code></pre>
</div>
</div>
</section>
<section id="transitivity-global-clustering" class="level2">
<h2 class="anchored" data-anchor-id="transitivity-global-clustering">Transitivity/ Global Clustering</h2>
<p>Let us look at the clustering pattern in a global level of network</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">transitivity</span>(g_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.818957</code></pre>
</div>
</div>
<p>The network has a high level of transitivity. It means, when two nodes are connected to a neighbouring node, it is highly likely that all of them are connected to each other.</p>
</section>
<section id="local-transitivity-clustering" class="level2">
<h2 class="anchored" data-anchor-id="local-transitivity-clustering">Local Transitivity / Clustering</h2>
<p>Now let us look at the Local transitivity. Since the number of vertices are fairly high, we will look on the average clustering coefficient rather than local clustering coefficient.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">transitivity</span>(g_df, <span class="at">type =</span> <span class="st">"average"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8658444</code></pre>
</div>
</div>
<p>The average clustering coefficient of 0.8658 suggests that the network is highly clustered. This means that the network has tightly connected sub groups/clusters.</p>
</section>
<section id="path-length-and-geodesic" class="level2">
<h2 class="anchored" data-anchor-id="path-length-and-geodesic">Path Length and Geodesic</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">average.path.length</span>(g_df, <span class="at">directed =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.457572</code></pre>
</div>
</div>
<p>The average path length of the network is 7.45.</p>
</section>
</section>
<section id="component-structure-and-membership" class="level1">
<h1>Component Structure and Membership</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(igraph<span class="sc">::</span><span class="fu">components</span>(g_df)) <span class="co"># Elements of components</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "membership" "csize"      "no"        </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">components</span>(g_df)<span class="sc">$</span>no</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">components</span>(g_df)<span class="sc">$</span>csize</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 90</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#igraph::components(g_df)$membership</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The component structure shows that there is only one big component with 90 members. In other words, there is no isolates in this network.</p>
</section>
<section id="density-of-network" class="level1">
<h1>Density of Network</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">graph.density</span>(g_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5202247</code></pre>
</div>
</div>
<p>The network has a 0.5202 density which means 0.5202 proportion of all possible ties are present in this network.</p>
<section id="creating-a-dataframe-with-the-vertex-degree-values" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-dataframe-with-the-vertex-degree-values">Creating a Dataframe with the Vertex Degree values</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>df_degree <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> <span class="fu">V</span>(g_df)<span class="sc">$</span>name, <span class="at">degree =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(g_df))</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_degree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                 name degree
Crop cultivation                     Crop cultivation     75
Livestock                                   Livestock     53
Agricultural services           Agricultural services     48
Forestry                                     Forestry     73
Feeds &amp; organic fertilizer Feeds &amp; organic fertilizer     54
Textile products                     Textile products    121</code></pre>
</div>
</div>
</section>
<section id="in-degree-and-out-degree" class="level2">
<h2 class="anchored" data-anchor-id="in-degree-and-out-degree">In degree and out degree</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>df_degree <span class="ot">&lt;-</span> df_degree <span class="sc">|&gt;</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">indegree =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(g_df, <span class="at">mode =</span> <span class="st">"in"</span>), </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">outdegree =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(g_df, <span class="at">mode =</span> <span class="st">"out"</span>))</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>df_degree <span class="sc">|&gt;</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(outdegree)) <span class="sc">|&gt;</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                     name degree indegree
Commerce                                         Commerce    135       43
Miscellaneous metal products Miscellaneous metal products    145       54
Misc. manufacturing products Misc. manufacturing products    152       61
Wearing apparel etc.                 Wearing apparel etc.    132       42
Final chemical products           Final chemical products    144       54
                             outdegree
Commerce                            92
Miscellaneous metal products        91
Misc. manufacturing products        91
Wearing apparel etc.                90
Final chemical products             90</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>df_degree <span class="sc">|&gt;</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(indegree)) <span class="sc">|&gt;</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                     name degree indegree
Pig iron &amp; crude steel             Pig iron &amp; crude steel     76       66
Public administration               Public administration     66       65
Misc. manufacturing products Misc. manufacturing products    152       61
Transport &amp; post service         Transport &amp; post service    151       61
Personal services                       Personal services    150       61
                             outdegree
Pig iron &amp; crude steel              10
Public administration                1
Misc. manufacturing products        91
Transport &amp; post service            90
Personal services                   89</code></pre>
</div>
</div>
</section>
<section id="summary-statistics-of-network-degree" class="level2">
<h2 class="anchored" data-anchor-id="summary-statistics-of-network-degree">Summary statistics of Network Degree</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df_degree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     name               degree          indegree       outdegree    
 Length:90          Min.   : 38.00   Min.   :17.00   Min.   : 0.00  
 Class :character   1st Qu.: 57.75   1st Qu.:39.25   1st Qu.:10.25  
 Mode  :character   Median : 89.00   Median :48.00   Median :41.00  
                    Mean   : 92.60   Mean   :46.30   Mean   :46.30  
                    3rd Qu.:126.75   3rd Qu.:52.00   3rd Qu.:86.00  
                    Max.   :152.00   Max.   :66.00   Max.   :92.00  </code></pre>
</div>
</div>
</section>
<section id="network-degree-distribution" class="level2">
<h2 class="anchored" data-anchor-id="network-degree-distribution">Network Degree Distribution</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>df_degree <span class="sc">%&gt;%</span> melt <span class="sc">%&gt;%</span> <span class="fu">filter</span>(variable <span class="sc">!=</span> <span class="st">'output'</span> <span class="sc">&amp;</span> variable <span class="sc">!=</span> <span class="st">'eigen.centrality'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> variable, <span class="at">color =</span> variable)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">alpha =</span> .<span class="dv">2</span>, <span class="at">bw =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Degree Distribution'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Using name as id variables</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attributes are not identical across measure variables; they will be
dropped</code></pre>
</div>
<div class="cell-output-display">
<p><img src="final_project_jerinjacob_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The distribution of degrees shows that the indegree values are more at a level of 50.</p>
</section>
<section id="network-degree-centralization" class="level2">
<h2 class="anchored" data-anchor-id="network-degree-centralization">Network Degree Centralization</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">centr_degree</span>(g_df, <span class="at">mode =</span> <span class="st">"in"</span>)<span class="sc">$</span>centralization</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2213483</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">centr_degree</span>(g_df, <span class="at">mode =</span> <span class="st">"out"</span>)<span class="sc">$</span>centralization</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5134831</code></pre>
</div>
</div>
</section>
</section>
<section id="eigen-vector" class="level1">
<h1>Eigen Vector</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>temp_eigen <span class="ot">&lt;-</span> <span class="fu">centr_eigen</span>(g_df, <span class="at">directed =</span> T)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp_eigen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "vector"          "value"           "options"         "centralization" 
[5] "theoretical_max"</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(temp_eigen<span class="sc">$</span>vector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 90</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>temp_eigen<span class="sc">$</span>vector</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.5953827 0.5120362 0.6280237 0.6805738 0.5954991 0.6824618 0.6057831
 [8] 0.8187135 0.7071076 0.6528368 0.6034703 0.6478165 0.7163664 0.7881786
[15] 0.5418807 0.7574951 0.6661287 0.6401862 0.6576396 0.7781058 0.6086314
[22] 0.7930444 0.7667579 0.7641407 0.7718081 0.8899521 0.7727183 0.5146864
[29] 0.5145222 0.6882062 0.6419725 0.5519556 0.5175506 0.9087712 0.7717444
[36] 0.7442549 0.5454263 0.8646528 0.9102065 0.2697866 0.7511301 0.7086050
[43] 0.6025945 0.6784769 0.6992363 0.7370351 0.7233416 0.7887455 0.7168331
[50] 0.6934170 0.7050182 0.7535558 0.8082977 0.8390455 0.6841809 0.7379447
[57] 0.7483575 0.7978797 0.7380666 0.5369580 0.5485777 0.5782104 0.4740734
[64] 0.5273760 0.6535068 0.5117106 0.5468021 1.0000000 0.7119895 0.7187400
[71] 0.7131842 0.7267811 0.7680584 0.7145214 0.6885328 0.8205471 0.8157092
[78] 0.7580999 0.9623841 0.6121869 0.8306890 0.5704533 0.5704533 0.5594488
[85] 0.5594488 0.5594488 0.5594488 0.5594488 0.5594488 0.5704533</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>temp_eigen<span class="sc">$</span>centralization</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3226412</code></pre>
</div>
</div>
<section id="adding-eigen-vector-to-node-level-measures-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="adding-eigen-vector-to-node-level-measures-dataframe">Adding Eigen Vector to node level measures dataframe</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>eigen <span class="ot">&lt;-</span> <span class="fu">centr_eigen</span>(g_df, <span class="at">directed =</span> T)<span class="sc">$</span>vector</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="co">#df_degree</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(df_degree, <span class="fu">desc</span>(eigen)) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                     name degree indegree
Pig iron &amp; crude steel             Pig iron &amp; crude steel     76       66
Public administration               Public administration     66       65
Personal services                       Personal services    150       61
Transport &amp; post service         Transport &amp; post service    151       61
Misc. manufacturing products Misc. manufacturing products    152       61
                             outdegree     eigen
Pig iron &amp; crude steel              10 1.0000000
Public administration                1 0.9623841
Personal services                   89 0.9102065
Transport &amp; post service            90 0.9087712
Misc. manufacturing products        91 0.8899521</code></pre>
</div>
</div>
</section>
<section id="bonacich-power-centrality-to-the-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="bonacich-power-centrality-to-the-dataframe">Bonacich Power Centrality to the dataframe</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>bonpow <span class="ot">&lt;-</span> <span class="fu">power_centrality</span>(g_df)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>df_degree <span class="sc">|&gt;</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(bonpow)) <span class="sc">|&gt;</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                     name degree indegree
Petrochemical basic products Petrochemical basic products     64       33
Medical service etc.                 Medical service etc.     82       54
Textile products                         Textile products    121       48
Non-ferrous metal products     Non-ferrous metal products    124       50
Glass &amp; glass products             Glass &amp; glass products    116       48
                             outdegree     eigen   bonpow
Petrochemical basic products        31 0.4740734 1.980978
Medical service etc.                28 0.7887455 1.940789
Textile products                    73 0.6824618 1.842212
Non-ferrous metal products          74 0.7380666 1.829821
Glass &amp; glass products              68 0.6934170 1.790583</code></pre>
</div>
</div>
</section>
<section id="derived-and-reflected-centrality" class="level2">
<h2 class="anchored" data-anchor-id="derived-and-reflected-centrality">Derived and Reflected Centrality</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>matrix_df_degree <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(g_df, <span class="at">attr =</span> <span class="st">"weight"</span>))</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Square the adjacency matrix</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>matrix_df_degree_sq <span class="ot">&lt;-</span> <span class="fu">t</span>(matrix_df_degree) <span class="sc">%*%</span> matrix_df_degree</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the proportion of reflected centrality</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>rc <span class="ot">&lt;-</span> <span class="fu">diag</span>(matrix_df_degree_sq)<span class="sc">/</span><span class="fu">rowSums</span>(matrix_df_degree_sq)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values with 0</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>rc <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.nan</span>(df_degree<span class="sc">$</span>rc), <span class="dv">0</span>, df_degree<span class="sc">$</span>rc)</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate received eigen value centrality</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>eigen.rc <span class="ot">&lt;-</span> df_degree<span class="sc">$</span>eigen <span class="sc">*</span> df_degree<span class="sc">$</span>rc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the proportion of derived centrality</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>dc <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">diag</span>(matrix_df_degree_sq)<span class="sc">/</span><span class="fu">rowSums</span>(matrix_df_degree_sq)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values with 0</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>dc <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.nan</span>(df_degree<span class="sc">$</span>dc), <span class="dv">0</span>, df_degree<span class="sc">$</span>dc)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate derived eigen value centrality</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>eigen.dc <span class="ot">&lt;-</span> df_degree<span class="sc">$</span>eigen <span class="sc">*</span> df_degree<span class="sc">$</span>dc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="centrality-score-distribution" class="level2">
<h2 class="anchored" data-anchor-id="centrality-score-distribution">Centrality Score Distribution</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>df_degree <span class="sc">|&gt;</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">|&gt;</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>() <span class="sc">|&gt;</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value)) <span class="sc">+</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>key, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attributes are not identical across measure variables; they will be
dropped</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="final_project_jerinjacob_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="centrality-measure-correlations" class="level2">
<h2 class="anchored" data-anchor-id="centrality-measure-correlations">Centrality Measure Correlations</h2>
</section>
<section id="closeness-centrality" class="level2">
<h2 class="anchored" data-anchor-id="closeness-centrality">Closeness Centrality</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>close <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">closeness</span>(g_df)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>df_degree <span class="sc">|&gt;</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(close)) <span class="sc">|&gt;</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                           name degree indegree
Misc. electronic components         Misc. electronic components    115       51
Household electronics equipment Household electronics equipment    137       52
Forestry                                               Forestry     73       46
Medical service etc.                       Medical service etc.     82       54
Glass &amp; glass products                   Glass &amp; glass products    116       48
                                outdegree     eigen     bonpow          rc
Misc. electronic components            64 0.7483575 -0.9292872 0.058312827
Household electronics equipment        85 0.7718081  0.2486351 0.036339969
Forestry                               27 0.6805738 -1.0649043 0.002618866
Medical service etc.                   28 0.7887455  1.9407891 0.187127156
Glass &amp; glass products                 68 0.6934170  1.7905830 0.004020029
                                   eigen.rc        dc  eigen.dc        close
Misc. electronic components     0.043638842 0.9416872 0.7047187 0.0004294927
Household electronics equipment 0.028047484 0.9636600 0.7437607 0.0003648980
Forestry                        0.001782331 0.9973811 0.6787915 0.0003220622
Medical service etc.            0.147595704 0.8128728 0.6411498 0.0003208223
Glass &amp; glass products          0.002787557 0.9959800 0.6906294 0.0003087959</code></pre>
</div>
</div>
</section>
<section id="betweenness-centrality" class="level2">
<h2 class="anchored" data-anchor-id="betweenness-centrality">Betweenness Centrality</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>between <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">betweenness</span>(g_df)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>df_degree <span class="sc">|&gt;</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(between)) <span class="sc">|&gt;</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                     name degree indegree
Glass &amp; glass products             Glass &amp; glass products    116       48
Pottery, china &amp; earthenware Pottery, china &amp; earthenware     99       45
Forestry                                         Forestry     73       46
Chemical fertilizer                   Chemical fertilizer     86       45
Metallic ores                               Metallic ores     45       36
                             outdegree     eigen     bonpow           rc
Glass &amp; glass products              68 0.6934170  1.7905830 4.020029e-03
Pottery, china &amp; earthenware        54 0.6576396  0.9827723 1.447672e-03
Forestry                            27 0.6805738 -1.0649043 2.618866e-03
Chemical fertilizer                 41 0.6478165 -2.7943767 2.322144e-03
Metallic ores                        9 0.5468021 -0.7909125 6.729973e-05
                                 eigen.rc        dc  eigen.dc        close
Glass &amp; glass products       2.787557e-03 0.9959800 0.6906294 0.0003087959
Pottery, china &amp; earthenware 9.520466e-04 0.9985523 0.6566876 0.0003059049
Forestry                     1.782331e-03 0.9973811 0.6787915 0.0003220622
Chemical fertilizer          1.504323e-03 0.9976779 0.6463122 0.0003035391
Metallic ores                3.679964e-05 0.9999327 0.5467653 0.0001723726
                              between
Glass &amp; glass products       2424.500
Pottery, china &amp; earthenware 2018.000
Forestry                     1897.667
Chemical fertilizer          1823.000
Metallic ores                1097.500</code></pre>
</div>
</div>
<p>We can calculate the network level score of betweenness centralization</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">centr_betw</span>(g_df)<span class="sc">$</span>centralization</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02636484</code></pre>
</div>
</div>
</section>
<section id="network-constraint" class="level2">
<h2 class="anchored" data-anchor-id="network-constraint">Network Constraint</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>constraint <span class="ot">&lt;-</span> <span class="fu">constraint</span>(g_df)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>df_degree <span class="sc">|&gt;</span> <span class="fu">arrange</span>(constraint) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                     name
Misc. ceramic, stone &amp; clay products Misc. ceramic, stone &amp; clay products
Glass &amp; glass products                             Glass &amp; glass products
Industrial inorganic chemicals             Industrial inorganic chemicals
Miscellaneous metal products                 Miscellaneous metal products
Plastic products                                         Plastic products
                                     degree indegree outdegree     eigen
Misc. ceramic, stone &amp; clay products    129       54        75 0.7781058
Glass &amp; glass products                  116       48        68 0.6934170
Industrial inorganic chemicals          133       49        84 0.7163664
Miscellaneous metal products            145       54        91 0.7930444
Plastic products                        138       52        86 0.7574951
                                         bonpow          rc    eigen.rc
Misc. ceramic, stone &amp; clay products -2.2143080 0.003338320 0.002597566
Glass &amp; glass products                1.7905830 0.004020029 0.002787557
Industrial inorganic chemicals       -1.0782885 0.011994287 0.008592304
Miscellaneous metal products         -0.1973909 0.034581989 0.027425052
Plastic products                     -0.3806956 0.102300442 0.077492086
                                            dc  eigen.dc        close between
Misc. ceramic, stone &amp; clay products 0.9966617 0.7755083 0.0001890447   284.0
Glass &amp; glass products               0.9959800 0.6906294 0.0003087959  2424.5
Industrial inorganic chemicals       0.9880057 0.7077741 0.0001681996   108.0
Miscellaneous metal products         0.9654180 0.7656193 0.0002504898    85.0
Plastic products                     0.8976996 0.6800030 0.0001914863    11.5
                                     constraint
Misc. ceramic, stone &amp; clay products  0.1079631
Glass &amp; glass products                0.1139342
Industrial inorganic chemicals        0.1153943
Miscellaneous metal products          0.1241241
Plastic products                      0.1291672</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>df_degree <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(constraint)) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                 name degree indegree outdegree
Feeds &amp; organic fertilizer Feeds &amp; organic fertilizer     54       41        13
Metallic ores                           Metallic ores     45       36         9
Medicaments                               Medicaments     74       48        26
Livestock                                   Livestock     53       35        18
Coal mining etc.                     Coal mining etc.     89       36        53
                               eigen     bonpow           rc     eigen.rc
Feeds &amp; organic fertilizer 0.5954991 -2.5409675 2.244451e-02 1.336568e-02
Metallic ores              0.5468021 -0.7909125 6.729973e-05 3.679964e-05
Medicaments                0.6992363 -0.2167730 3.451293e-02 2.413270e-02
Livestock                  0.5120362 -0.8037581 5.637439e-02 2.886573e-02
Coal mining etc.           0.5369580  0.7873295 3.621458e-04 1.944571e-04
                                  dc  eigen.dc        close between constraint
Feeds &amp; organic fertilizer 0.9775555 0.5821334 2.312144e-04  1031.0  0.5746577
Metallic ores              0.9999327 0.5467653 1.723726e-04  1097.5  0.5452584
Medicaments                0.9654871 0.6751036 5.124449e-05    55.0  0.4914972
Livestock                  0.9436256 0.4831705 2.963850e-04   508.5  0.4913486
Coal mining etc.           0.9996379 0.5367635 1.916560e-04   131.5  0.4890750</code></pre>
</div>
</div>
<p>Feeds &amp; organic fertilizer, Metallic ores and Medicaments are the most reduntant industries while Misc. ceramic, stone &amp; clay products, Glass &amp; glass products and Industrial inorganic chemicals industries are the least reduntant ones.</p>
</section>
<section id="centrality-measure-correlations-1" class="level2">
<h2 class="anchored" data-anchor-id="centrality-measure-correlations-1">Centrality Measure Correlations</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>corrplot <span class="sc">::</span> <span class="fu">corrplot</span>(<span class="fu">cor</span>(df_degree[ , <span class="sc">-</span><span class="dv">1</span>]), <span class="at">title =</span> <span class="st">'Correlation Plot'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="final_project_jerinjacob_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">&lt;-</span> kableExtra <span class="sc">::</span> <span class="fu">kable</span>(<span class="fu">apply</span>(df_degree[ , <span class="sc">-</span><span class="dv">1</span>], <span class="dv">2</span>, <span class="cf">function</span> (x) df_degree<span class="sc">$</span>name[<span class="fu">order</span>(x, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)][<span class="dv">1</span> <span class="sc">:</span> <span class="dv">10</span>]))</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>table1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">degree</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">indegree</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">outdegree</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">eigen</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">bonpow</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">rc</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">eigen.rc</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">dc</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">eigen.dc</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">close</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">between</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">constraint</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Misc. manufacturing products</td>
<td style="text-align: left;">Pig iron &amp; crude steel</td>
<td style="text-align: left;">Commerce</td>
<td style="text-align: left;">Pig iron &amp; crude steel</td>
<td style="text-align: left;">Petrochemical basic products</td>
<td style="text-align: left;">Petroleum refinery products</td>
<td style="text-align: left;">Pig iron &amp; crude steel</td>
<td style="text-align: left;">Feed conversion</td>
<td style="text-align: left;">Public administration</td>
<td style="text-align: left;">Misc. electronic components</td>
<td style="text-align: left;">Glass &amp; glass products</td>
<td style="text-align: left;">Feeds &amp; organic fertilizer</td>
</tr>
<tr class="even">
<td style="text-align: left;">Transport &amp; post service</td>
<td style="text-align: left;">Public administration</td>
<td style="text-align: left;">Miscellaneous metal products</td>
<td style="text-align: left;">Public administration</td>
<td style="text-align: left;">Medical service etc.</td>
<td style="text-align: left;">Steel products</td>
<td style="text-align: left;">Petroleum refinery products</td>
<td style="text-align: left;">Gasification</td>
<td style="text-align: left;">Misc. manufacturing products</td>
<td style="text-align: left;">Household electronics equipment</td>
<td style="text-align: left;">Pottery, china &amp; earthenware</td>
<td style="text-align: left;">Metallic ores</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Personal services</td>
<td style="text-align: left;">Misc. manufacturing products</td>
<td style="text-align: left;">Misc. manufacturing products</td>
<td style="text-align: left;">Personal services</td>
<td style="text-align: left;">Textile products</td>
<td style="text-align: left;">Motor vehicle parts &amp; accessories</td>
<td style="text-align: left;">Motor vehicle parts &amp; accessories</td>
<td style="text-align: left;">Composting</td>
<td style="text-align: left;">Lumber and wood products</td>
<td style="text-align: left;">Forestry</td>
<td style="text-align: left;">Forestry</td>
<td style="text-align: left;">Medicaments</td>
</tr>
<tr class="even">
<td style="text-align: left;">Business services</td>
<td style="text-align: left;">Transport &amp; post service</td>
<td style="text-align: left;">Wearing apparel etc.</td>
<td style="text-align: left;">Transport &amp; post service</td>
<td style="text-align: left;">Non-ferrous metal products</td>
<td style="text-align: left;">Pig iron &amp; crude steel</td>
<td style="text-align: left;">Steel products</td>
<td style="text-align: left;">Refuse derived fuel</td>
<td style="text-align: left;">Personal services</td>
<td style="text-align: left;">Medical service etc.</td>
<td style="text-align: left;">Chemical fertilizer</td>
<td style="text-align: left;">Livestock</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Miscellaneous metal products</td>
<td style="text-align: left;">Personal services</td>
<td style="text-align: left;">Final chemical products</td>
<td style="text-align: left;">Misc. manufacturing products</td>
<td style="text-align: left;">Glass &amp; glass products</td>
<td style="text-align: left;">Passenger motor cars</td>
<td style="text-align: left;">Passenger motor cars</td>
<td style="text-align: left;">Filtration</td>
<td style="text-align: left;">Public construction</td>
<td style="text-align: left;">Glass &amp; glass products</td>
<td style="text-align: left;">Metallic ores</td>
<td style="text-align: left;">Coal mining etc.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Final chemical products</td>
<td style="text-align: left;">Business services</td>
<td style="text-align: left;">Petroleum refinery products</td>
<td style="text-align: left;">Business services</td>
<td style="text-align: left;">General-purpose machinery</td>
<td style="text-align: left;">Medical service etc.</td>
<td style="text-align: left;">Medical service etc.</td>
<td style="text-align: left;">Metallic ores</td>
<td style="text-align: left;">Misc. transportation equipment &amp; repair</td>
<td style="text-align: left;">Steel products</td>
<td style="text-align: left;">Coal products</td>
<td style="text-align: left;">Miscellaneous cars</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Repair of construction</td>
<td style="text-align: left;">Production machinery</td>
<td style="text-align: left;">Electricity</td>
<td style="text-align: left;">Production machinery</td>
<td style="text-align: left;">Cement &amp; cement products</td>
<td style="text-align: left;">Foods</td>
<td style="text-align: left;">Foods</td>
<td style="text-align: left;">Coal mining etc.</td>
<td style="text-align: left;">Production machinery</td>
<td style="text-align: left;">Pottery, china &amp; earthenware</td>
<td style="text-align: left;">Feeds &amp; organic fertilizer</td>
<td style="text-align: left;">Passenger motor cars</td>
</tr>
<tr class="even">
<td style="text-align: left;">Communications &amp; broadcasting</td>
<td style="text-align: left;">Lumber and wood products</td>
<td style="text-align: left;">Transport &amp; post service</td>
<td style="text-align: left;">Building construction</td>
<td style="text-align: left;">Synthetic fibers</td>
<td style="text-align: left;">Non-ferrous metal products</td>
<td style="text-align: left;">Non-ferrous metal products</td>
<td style="text-align: left;">Concentration</td>
<td style="text-align: left;">Building construction</td>
<td style="text-align: left;">Chemical fertilizer</td>
<td style="text-align: left;">Lumber and wood products</td>
<td style="text-align: left;">Petrochemical basic products</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Activities not elsewhere classified</td>
<td style="text-align: left;">Building construction</td>
<td style="text-align: left;">Printing etc.</td>
<td style="text-align: left;">Misc. transportation equipment &amp; repair</td>
<td style="text-align: left;">Pottery, china &amp; earthenware</td>
<td style="text-align: left;">Real estate services</td>
<td style="text-align: left;">Transport &amp; post service</td>
<td style="text-align: left;">Agricultural services</td>
<td style="text-align: left;">Transport &amp; post service</td>
<td style="text-align: left;">Non-ferrous metal products</td>
<td style="text-align: left;">Textile products</td>
<td style="text-align: left;">Fishery</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lumber and wood products</td>
<td style="text-align: left;">General-purpose machinery</td>
<td style="text-align: left;">Repair of construction</td>
<td style="text-align: left;">Lumber and wood products</td>
<td style="text-align: left;">Metal products for construction</td>
<td style="text-align: left;">Communications &amp; broadcasting</td>
<td style="text-align: left;">Communications &amp; broadcasting</td>
<td style="text-align: left;">Pottery, china &amp; earthenware</td>
<td style="text-align: left;">Ships &amp; repair of ships</td>
<td style="text-align: left;">Rubber products</td>
<td style="text-align: left;">Pig iron &amp; crude steel</td>
<td style="text-align: left;">Pig iron &amp; crude steel</td>
</tr>
</tbody>
</table>


</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>industry_io.node <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">apply</span>(df_degree[ , <span class="sc">-</span><span class="dv">1</span>], <span class="dv">2</span>, <span class="cf">function</span> (x) df_degree<span class="sc">$</span>name[<span class="fu">order</span>(x, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)][<span class="dv">1</span> <span class="sc">:</span> <span class="dv">10</span>]))</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>industry_io.node</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                degree                     indegree
1         Misc. manufacturing products       Pig iron &amp; crude steel
2             Transport &amp; post service        Public administration
3                    Personal services Misc. manufacturing products
4                    Business services     Transport &amp; post service
5         Miscellaneous metal products            Personal services
6              Final chemical products            Business services
7               Repair of construction         Production machinery
8        Communications &amp; broadcasting     Lumber and wood products
9  Activities not elsewhere classified        Building construction
10            Lumber and wood products    General-purpose machinery
                      outdegree                                    eigen
1                      Commerce                   Pig iron &amp; crude steel
2  Miscellaneous metal products                    Public administration
3  Misc. manufacturing products                        Personal services
4          Wearing apparel etc.                 Transport &amp; post service
5       Final chemical products             Misc. manufacturing products
6   Petroleum refinery products                        Business services
7                   Electricity                     Production machinery
8      Transport &amp; post service                    Building construction
9                 Printing etc. Misc. transportation equipment  &amp; repair
10       Repair of construction                 Lumber and wood products
                            bonpow                                rc
1     Petrochemical basic products       Petroleum refinery products
2             Medical service etc.                    Steel products
3                 Textile products Motor vehicle parts &amp; accessories
4       Non-ferrous metal products            Pig iron &amp; crude steel
5           Glass &amp; glass products              Passenger motor cars
6        General-purpose machinery              Medical service etc.
7         Cement &amp; cement products                             Foods
8                 Synthetic fibers        Non-ferrous metal products
9     Pottery, china &amp; earthenware              Real estate services
10 Metal products for construction     Communications &amp; broadcasting
                            eigen.rc                           dc
1             Pig iron &amp; crude steel              Feed conversion
2        Petroleum refinery products                 Gasification
3  Motor vehicle parts &amp; accessories                   Composting
4                     Steel products          Refuse derived fuel
5               Passenger motor cars                   Filtration
6               Medical service etc.                Metallic ores
7                              Foods             Coal mining etc.
8         Non-ferrous metal products                Concentration
9           Transport &amp; post service        Agricultural services
10     Communications &amp; broadcasting Pottery, china &amp; earthenware
                                   eigen.dc                           close
1                     Public administration     Misc. electronic components
2              Misc. manufacturing products Household electronics equipment
3                  Lumber and wood products                        Forestry
4                         Personal services            Medical service etc.
5                       Public construction          Glass &amp; glass products
6  Misc. transportation equipment  &amp; repair                  Steel products
7                      Production machinery    Pottery, china &amp; earthenware
8                     Building construction             Chemical fertilizer
9                  Transport &amp; post service      Non-ferrous metal products
10                  Ships &amp; repair of ships                 Rubber products
                        between                   constraint
1        Glass &amp; glass products   Feeds &amp; organic fertilizer
2  Pottery, china &amp; earthenware                Metallic ores
3                      Forestry                  Medicaments
4           Chemical fertilizer                    Livestock
5                 Metallic ores             Coal mining etc.
6                 Coal products           Miscellaneous cars
7    Feeds &amp; organic fertilizer         Passenger motor cars
8      Lumber and wood products Petrochemical basic products
9              Textile products                      Fishery
10       Pig iron &amp; crude steel       Pig iron &amp; crude steel</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>df_degree_io <span class="ot">&lt;-</span> df_degree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>These are the industries having the highest of centrality measures for the industries network. The nodes having higher indegrees have more inwards directed edges while outdegree gives an idea about how the outwards connections are for the node. Eigen vector, Bonacich value, Eigen Reflected Centrality, Eigen Derived Centrality are various measures of centrality of nodes. These measures suggests how influential the nodes are. Betweenness is a measure of the position of nodes in terms of closeness to other influential nodes. Constraint tells us about the level of redundancy of a node in the network to create connections with other neighbouring nodes.</p>
</section>
</section>
<section id="most-and-least-influential-industries-and-their-contribution-to-the-waste-output" class="level1">
<h1>Most and Least influential industries and their contribution to the waste output</h1>
<p>Eventhough the different measures of centrality talks about the significance and influence of nodes, we are taking into consideration, Bonacich power and Constraint here to compare the waste output.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>df_bonpow <span class="ot">&lt;-</span> df_degree <span class="sc">|&gt;</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(bonpow)) <span class="sc">|&gt;</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>df_constraint <span class="ot">&lt;-</span> df_degree <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(constraint)) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>industry_waste <span class="ot">&lt;-</span> data_2011 <span class="sc">|&gt;</span> <span class="fu">select</span>(</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>...<span class="dv">1</span>, <span class="dv">83</span><span class="sc">:</span><span class="dv">92</span>)</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>industry_waste</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 294 × 11
   ...1   Incineration Dehydration Concentration Shredding Filtration Composting
   &lt;chr&gt;         &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1 Crop …          0           0            0          0        0         0     
 2 Lives…          0           0            0          0        0         0     
 3 Agric…          0           0            0          0        0         0     
 4 Fores…          0           0            0          0        0         0     
 5 Fishe…          0           0            0          0        0         0     
 6 Metal…          0           0            0          0        0         0     
 7 Coal …         16.7        39.7          3.98      12.2      0.253     0.0431
 8 Non-m…          0           0            0          0        0         0     
 9 Foods           0           0            0          0        0         0     
10 Bever…          0           0            0          0        0         0     
# ℹ 284 more rows
# ℹ 4 more variables: `Feed conversion` &lt;dbl&gt;, Gasification &lt;dbl&gt;,
#   `Refuse derived fuel` &lt;dbl&gt;, Landfill &lt;dbl&gt;</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>filtered_data1 <span class="ot">&lt;-</span> industry_waste[industry_waste<span class="sc">$</span>...<span class="dv">1</span> <span class="sc">%in%</span> df_bonpow<span class="sc">$</span>name, ]</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>filtered_data2 <span class="ot">&lt;-</span> industry_waste[industry_waste<span class="sc">$</span>...<span class="dv">1</span> <span class="sc">%in%</span> df_constraint<span class="sc">$</span>name, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>combined_df_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(combined_df, <span class="at">id.vars =</span> <span class="st">"...1"</span>, <span class="at">variable.name =</span> <span class="st">"to"</span>, <span class="at">value.name =</span> <span class="st">"weight"</span>, <span class="at">variable.factor =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'combined_df' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the "Industries" column to "From"</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(combined_df_long)[<span class="fu">colnames</span>(combined_df_long) <span class="sc">==</span> <span class="st">"...1"</span>] <span class="ot">&lt;-</span> <span class="st">"from"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error: object 'combined_df_long' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>combined_df_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'combined_df_long' not found</code></pre>
</div>
</div>
<section id="waste-output-from-most-significant-industries" class="level2">
<h2 class="anchored" data-anchor-id="waste-output-from-most-significant-industries">Waste output from most significant industries</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>filter1_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(filtered_data1, <span class="at">id.vars =</span> <span class="st">"...1"</span>, <span class="at">variable.name =</span> <span class="st">"to"</span>, <span class="at">value.name =</span> <span class="st">"weight"</span>, <span class="at">variable.factor =</span> <span class="cn">FALSE</span>)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the "Industries" column to "From"</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(filter1_long)[<span class="fu">colnames</span>(filter1_long) <span class="sc">==</span> <span class="st">"...1"</span>] <span class="ot">&lt;-</span> <span class="st">"from"</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="co">#filter1_long</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a heatmap plot</span></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filter1_long, <span class="fu">aes</span>(<span class="at">x =</span> from, <span class="at">y =</span> to, <span class="at">fill =</span> <span class="fu">log</span>(weight))) <span class="sc">+</span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"yellow"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span>  <span class="co"># Change the color pattern</span></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"To"</span>, <span class="at">title =</span> <span class="st">"Heatmap of Weight"</span>) <span class="sc">+</span></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotate x-axis labels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="final_project_jerinjacob_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="waste-output-from-industries-with-high-redundancy" class="level2">
<h2 class="anchored" data-anchor-id="waste-output-from-industries-with-high-redundancy">Waste output from industries with high redundancy</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>filter2_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(filtered_data2, <span class="at">id.vars =</span> <span class="st">"...1"</span>, <span class="at">variable.name =</span> <span class="st">"to"</span>, <span class="at">value.name =</span> <span class="st">"weight"</span>, <span class="at">variable.factor =</span> <span class="cn">FALSE</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the "Industries" column to "From"</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(filter2_long)[<span class="fu">colnames</span>(filter2_long) <span class="sc">==</span> <span class="st">"...1"</span>] <span class="ot">&lt;-</span> <span class="st">"from"</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="co">#filter2_long</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a heatmap plot</span></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filter2_long, <span class="fu">aes</span>(<span class="at">x =</span> from, <span class="at">y =</span> to, <span class="at">fill =</span> <span class="fu">log</span>(weight))) <span class="sc">+</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"yellow"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span>  <span class="co"># Change the color pattern</span></span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"To"</span>, <span class="at">title =</span> <span class="st">"Heatmap of Weight"</span>) <span class="sc">+</span></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotate x-axis labels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="final_project_jerinjacob_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>The results show how much wastes go to each of the waste processing methods from the industries having most centrality measures and the most redundancy measures.</p>
</section>
<section id="limitation" class="level1">
<h1>Limitation</h1>
<p>The dataset is an older data. It is from Japan. Taking these things into consideration, we cannot make a solid conclusion about the waste outputs from industries in other parts of the world today. Also, we can compare the weight outputs from industries having each of the centrality score high and low. This would make the analysis even harder. So this study has been concluded with the available results.</p>
</section>
<section id="reference" class="level1">
<h1>Reference:</h1>
<ol type="1">
<li>Nakamura, S. (2020). Tracking the Product Origins of Waste for Treatment Using the WIO Data Developed by the Japanese Ministry of the Environment. Env. Sci. Technol. https://doi.org/10.1021/acs.est.0c06015</li>
</ol>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/Social_Networks_Spring_2023" data-repo-id="R_kgDOI9d_OA" data-category="Announcements" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb119" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Final Project"</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Jerin Jacob"</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> ""</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "02/22/2023"</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a><span class="co"># editor: visual</span></span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> </span></span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - final_project</span></span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   output:</span></span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a><span class="co"># pdf_document: default</span></span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb119-26"><a href="#cb119-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statnet)</span>
<span id="cb119-27"><a href="#cb119-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb119-28"><a href="#cb119-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(network)</span>
<span id="cb119-29"><a href="#cb119-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb119-30"><a href="#cb119-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrr)</span>
<span id="cb119-31"><a href="#cb119-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb119-32"><a href="#cb119-32" aria-hidden="true" tabindex="-1"></a><span class="co">#library(googlesheets4)</span></span>
<span id="cb119-33"><a href="#cb119-33" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-34"><a href="#cb119-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-35"><a href="#cb119-35" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb119-36"><a href="#cb119-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-37"><a href="#cb119-37" aria-hidden="true" tabindex="-1"></a>We are living in a world that produces a huge volume of waste everyday. It is estimated that by 2050, the global waste produced will be more than 3.4 billion tons every year. Certain industries produce large volume of waste while some other industries are considered to be cleaner than others. The world has already moved towards recycling as a part of reducing waste dumped in overall. Waste materials produced by certain industries can be used as raw material for certain other industries.</span>
<span id="cb119-38"><a href="#cb119-38" aria-hidden="true" tabindex="-1"></a>This project is an attempt to study the input-output data of materials between industries and the categories of wastes each industries produce. The dataset is from the 'Waste Input Output Analysis' by Nakamura, S. and Kondo, Yasushi. It is a data from Japan and therefore the economic flow is given in 1 million Japanese yen. The analysis will help us to find which all industries serve how many other industries with the goods they produce and compare it with the waste emission by each of those industires. </span>
<span id="cb119-39"><a href="#cb119-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-40"><a href="#cb119-40" aria-hidden="true" tabindex="-1"></a><span class="fu"># Research Question</span></span>
<span id="cb119-41"><a href="#cb119-41" aria-hidden="true" tabindex="-1"></a>How the most influencial industries in terms of their interaction to other industries contribute to the wastes produced?</span>
<span id="cb119-42"><a href="#cb119-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-43"><a href="#cb119-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-44"><a href="#cb119-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-45"><a href="#cb119-45" aria-hidden="true" tabindex="-1"></a>Reading the Data</span>
<span id="cb119-48"><a href="#cb119-48" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-49"><a href="#cb119-49" aria-hidden="true" tabindex="-1"></a>data_2011 <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"_data/Project_data/WIO_2011.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"WIOdata"</span>)</span>
<span id="cb119-50"><a href="#cb119-50" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_2011)</span>
<span id="cb119-51"><a href="#cb119-51" aria-hidden="true" tabindex="-1"></a><span class="co">#data_2011</span></span>
<span id="cb119-52"><a href="#cb119-52" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data_2011)</span>
<span id="cb119-53"><a href="#cb119-53" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-54"><a href="#cb119-54" aria-hidden="true" tabindex="-1"></a>The dataset has 294 rows and 103 columns. We are interested in only the output flow between industries and the waste flow from industries to different waste management processes. Therefore, we can trim the data as a subset which is in the form we want.  </span>
<span id="cb119-55"><a href="#cb119-55" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cleaning Data</span></span>
<span id="cb119-58"><a href="#cb119-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-59"><a href="#cb119-59" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> data_2011[<span class="dv">1</span><span class="sc">:</span><span class="dv">81</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">92</span>]</span>
<span id="cb119-60"><a href="#cb119-60" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span>
<span id="cb119-61"><a href="#cb119-61" aria-hidden="true" tabindex="-1"></a>industry_io <span class="ot">&lt;-</span> data_2011[<span class="dv">1</span><span class="sc">:</span><span class="dv">81</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">82</span>]</span>
<span id="cb119-62"><a href="#cb119-62" aria-hidden="true" tabindex="-1"></a>waste_io <span class="ot">&lt;-</span> data_2011[<span class="dv">1</span><span class="sc">:</span><span class="dv">81</span>, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">83</span><span class="sc">:</span><span class="dv">92</span>)]</span>
<span id="cb119-63"><a href="#cb119-63" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(waste_io)</span>
<span id="cb119-64"><a href="#cb119-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-65"><a href="#cb119-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-66"><a href="#cb119-66" aria-hidden="true" tabindex="-1"></a><span class="fu"># Creating Network</span></span>
<span id="cb119-67"><a href="#cb119-67" aria-hidden="true" tabindex="-1"></a>After cleaning the dataset, next step is to create network data out of it. </span>
<span id="cb119-70"><a href="#cb119-70" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-71"><a href="#cb119-71" aria-hidden="true" tabindex="-1"></a><span class="co">#df &lt;- industry_io</span></span>
<span id="cb119-72"><a href="#cb119-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the data to long format</span></span>
<span id="cb119-73"><a href="#cb119-73" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(df, <span class="at">id.vars =</span> <span class="st">"...1"</span>, <span class="at">variable.name =</span> <span class="st">"to"</span>, <span class="at">value.name =</span> <span class="st">"weight"</span>, <span class="at">variable.factor =</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-74"><a href="#cb119-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-75"><a href="#cb119-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the "Industries" column to "From"</span></span>
<span id="cb119-76"><a href="#cb119-76" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_long)[<span class="fu">colnames</span>(df_long) <span class="sc">==</span> <span class="st">"...1"</span>] <span class="ot">&lt;-</span> <span class="st">"from"</span></span>
<span id="cb119-77"><a href="#cb119-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-78"><a href="#cb119-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop rows with weight 0</span></span>
<span id="cb119-79"><a href="#cb119-79" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df_long[df_long<span class="sc">$</span>weight <span class="sc">!=</span> <span class="dv">0</span>, ]</span>
<span id="cb119-80"><a href="#cb119-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-81"><a href="#cb119-81" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df_long <span class="sc">|&gt;</span></span>
<span id="cb119-82"><a href="#cb119-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">waste_process =</span> <span class="fu">ifelse</span>(to <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Incineration"</span>, <span class="st">"Dehydration"</span>, <span class="st">"Concentration"</span>, <span class="st">"Shredding"</span>, <span class="st">"Filtration"</span>, <span class="st">"Composting"</span>,</span>
<span id="cb119-83"><a href="#cb119-83" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Feed conversion"</span>, <span class="st">"Gasification"</span>, <span class="st">"Refuse derived fuel"</span>, <span class="st">"Landfill"</span>), <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb119-84"><a href="#cb119-84" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_long)</span>
<span id="cb119-85"><a href="#cb119-85" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df_long)</span>
<span id="cb119-86"><a href="#cb119-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-87"><a href="#cb119-87" aria-hidden="true" tabindex="-1"></a>There are negative values in the 'weight' column. When the value is negative in directed network, it could be probably because the transaction was done in the reverse direction. So, assuming likewise, we can swap the from and to where weight is negative and then get the absolute values for weight so that we don't want to deal with anymore negative values! </span>
<span id="cb119-90"><a href="#cb119-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-91"><a href="#cb119-91" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df_long)</span>
<span id="cb119-92"><a href="#cb119-92" aria-hidden="true" tabindex="-1"></a>df_long<span class="sc">$</span>to <span class="ot">&lt;-</span> <span class="fu">as.character</span>(df_long<span class="sc">$</span>to)</span>
<span id="cb119-93"><a href="#cb119-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-94"><a href="#cb119-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-95"><a href="#cb119-95" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb119-96"><a href="#cb119-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_from =</span> <span class="fu">ifelse</span>(weight <span class="sc">&lt;</span> <span class="dv">0</span>, to, from),</span>
<span id="cb119-97"><a href="#cb119-97" aria-hidden="true" tabindex="-1"></a>         <span class="at">new_to =</span> <span class="fu">ifelse</span>(weight <span class="sc">&lt;</span> <span class="dv">0</span>, from, to)) <span class="sc">%&gt;%</span></span>
<span id="cb119-98"><a href="#cb119-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(from, to)) <span class="sc">%&gt;%</span></span>
<span id="cb119-99"><a href="#cb119-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight =</span> <span class="fu">abs</span>(weight)) <span class="sc">%&gt;%</span></span>
<span id="cb119-100"><a href="#cb119-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> new_from, <span class="at">to =</span> new_to)</span>
<span id="cb119-101"><a href="#cb119-101" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df_long[, <span class="fu">c</span>(<span class="st">"from"</span>, <span class="st">"to"</span>, <span class="st">"weight"</span>, <span class="st">"waste_process"</span>)]</span>
<span id="cb119-102"><a href="#cb119-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-103"><a href="#cb119-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-104"><a href="#cb119-104" aria-hidden="true" tabindex="-1"></a>df_long <span class="sc">|&gt;</span></span>
<span id="cb119-105"><a href="#cb119-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(waste_process <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb119-106"><a href="#cb119-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb119-107"><a href="#cb119-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-108"><a href="#cb119-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-109"><a href="#cb119-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-110"><a href="#cb119-110" aria-hidden="true" tabindex="-1"></a><span class="fu">## Creating the network</span></span>
<span id="cb119-113"><a href="#cb119-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-114"><a href="#cb119-114" aria-hidden="true" tabindex="-1"></a>g_df <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(df_long)</span>
<span id="cb119-115"><a href="#cb119-115" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the weighted vertex attribute values from the dataframe</span></span>
<span id="cb119-116"><a href="#cb119-116" aria-hidden="true" tabindex="-1"></a><span class="co">#vertex_attributes &lt;- df[, 82:92]</span></span>
<span id="cb119-117"><a href="#cb119-117" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(g_df)<span class="sc">$</span>weight <span class="ot">&lt;-</span> df_long<span class="sc">$</span>weight</span>
<span id="cb119-118"><a href="#cb119-118" aria-hidden="true" tabindex="-1"></a><span class="co">#E(g_df)$waste_process &lt;- df_long$waste_process</span></span>
<span id="cb119-119"><a href="#cb119-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-120"><a href="#cb119-120" aria-hidden="true" tabindex="-1"></a>process_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Incineration"</span>, <span class="st">"Dehydration"</span>, <span class="st">"Concentration"</span>, <span class="st">"Shredding"</span>, <span class="st">"Filtration"</span>, <span class="st">"Composting"</span>,</span>
<span id="cb119-121"><a href="#cb119-121" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Feed conversion"</span>, <span class="st">"Gasification"</span>, <span class="st">"Refuse derived fuel"</span>, <span class="st">"Landfill"</span>)</span>
<span id="cb119-122"><a href="#cb119-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-123"><a href="#cb119-123" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty vector to store the attribute values</span></span>
<span id="cb119-124"><a href="#cb119-124" aria-hidden="true" tabindex="-1"></a>vertex_attribute <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"industry"</span>, <span class="fu">vcount</span>(g_df))</span>
<span id="cb119-125"><a href="#cb119-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-126"><a href="#cb119-126" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the vertices with names in the list and assign attribute value of "waste processing"</span></span>
<span id="cb119-127"><a href="#cb119-127" aria-hidden="true" tabindex="-1"></a>matching_vertices <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(g_df)<span class="sc">$</span>name <span class="sc">%in%</span> process_names)</span>
<span id="cb119-128"><a href="#cb119-128" aria-hidden="true" tabindex="-1"></a>vertex_attribute[matching_vertices] <span class="ot">&lt;-</span> <span class="st">"waste processing"</span></span>
<span id="cb119-129"><a href="#cb119-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-130"><a href="#cb119-130" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the vertex attribute to the graph</span></span>
<span id="cb119-131"><a href="#cb119-131" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g_df)<span class="sc">$</span>process <span class="ot">&lt;-</span> vertex_attribute</span>
<span id="cb119-132"><a href="#cb119-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-133"><a href="#cb119-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-134"><a href="#cb119-134" aria-hidden="true" tabindex="-1"></a><span class="co">#V(g_df)$process</span></span>
<span id="cb119-135"><a href="#cb119-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-136"><a href="#cb119-136" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>(df_long)</span>
<span id="cb119-137"><a href="#cb119-137" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(g_df)</span></span>
<span id="cb119-138"><a href="#cb119-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-139"><a href="#cb119-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-140"><a href="#cb119-140" aria-hidden="true" tabindex="-1"></a><span class="fu"># Describing the Network Data</span></span>
<span id="cb119-143"><a href="#cb119-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-144"><a href="#cb119-144" aria-hidden="true" tabindex="-1"></a><span class="fu">vcount</span>(g_df)</span>
<span id="cb119-145"><a href="#cb119-145" aria-hidden="true" tabindex="-1"></a><span class="fu">ecount</span>(g_df)</span>
<span id="cb119-146"><a href="#cb119-146" aria-hidden="true" tabindex="-1"></a><span class="fu">is_bipartite</span>(g_df)</span>
<span id="cb119-147"><a href="#cb119-147" aria-hidden="true" tabindex="-1"></a><span class="fu">is_directed</span>(g_df)</span>
<span id="cb119-148"><a href="#cb119-148" aria-hidden="true" tabindex="-1"></a><span class="fu">is_weighted</span>(g_df)</span>
<span id="cb119-149"><a href="#cb119-149" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-150"><a href="#cb119-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-151"><a href="#cb119-151" aria-hidden="true" tabindex="-1"></a>The network has 90 vertices and 4167 edges.</span>
<span id="cb119-152"><a href="#cb119-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-155"><a href="#cb119-155" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-156"><a href="#cb119-156" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">E</span>(g_df)<span class="sc">$</span>weight)</span>
<span id="cb119-157"><a href="#cb119-157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-158"><a href="#cb119-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-161"><a href="#cb119-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-162"><a href="#cb119-162" aria-hidden="true" tabindex="-1"></a><span class="fu">vertex_attr_names</span>(g_df)</span>
<span id="cb119-163"><a href="#cb119-163" aria-hidden="true" tabindex="-1"></a><span class="fu">edge_attr_names</span>(g_df)</span>
<span id="cb119-164"><a href="#cb119-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-165"><a href="#cb119-165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-166"><a href="#cb119-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-167"><a href="#cb119-167" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dyad &amp; Triad Census</span></span>
<span id="cb119-168"><a href="#cb119-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-171"><a href="#cb119-171" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-172"><a href="#cb119-172" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">dyad.census</span>(g_df)</span>
<span id="cb119-173"><a href="#cb119-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-174"><a href="#cb119-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-175"><a href="#cb119-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-178"><a href="#cb119-178" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-179"><a href="#cb119-179" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">triad_census</span>(g_df)</span>
<span id="cb119-180"><a href="#cb119-180" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(igraph<span class="sc">::</span><span class="fu">triad_census</span>(g_df))</span>
<span id="cb119-181"><a href="#cb119-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-182"><a href="#cb119-182" aria-hidden="true" tabindex="-1"></a>(<span class="dv">90</span><span class="sc">*</span><span class="dv">89</span><span class="sc">*</span><span class="dv">88</span>)<span class="sc">/</span>(<span class="dv">3</span><span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb119-183"><a href="#cb119-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-184"><a href="#cb119-184" aria-hidden="true" tabindex="-1"></a><span class="fu">## Transitivity/ Global Clustering</span></span>
<span id="cb119-185"><a href="#cb119-185" aria-hidden="true" tabindex="-1"></a>Let us look at the clustering pattern in a global level of network</span>
<span id="cb119-188"><a href="#cb119-188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-189"><a href="#cb119-189" aria-hidden="true" tabindex="-1"></a><span class="fu">transitivity</span>(g_df)</span>
<span id="cb119-190"><a href="#cb119-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-191"><a href="#cb119-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-192"><a href="#cb119-192" aria-hidden="true" tabindex="-1"></a>The network has a high level of transitivity. It means, when two nodes are connected to a neighbouring node, it is highly likely that all of them are connected to each other. </span>
<span id="cb119-193"><a href="#cb119-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-194"><a href="#cb119-194" aria-hidden="true" tabindex="-1"></a><span class="fu">## Local Transitivity / Clustering</span></span>
<span id="cb119-195"><a href="#cb119-195" aria-hidden="true" tabindex="-1"></a>Now let us look at the Local transitivity. Since the number of vertices are fairly high, we will look on the average clustering coefficient rather than local clustering coefficient.</span>
<span id="cb119-198"><a href="#cb119-198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-199"><a href="#cb119-199" aria-hidden="true" tabindex="-1"></a><span class="fu">transitivity</span>(g_df, <span class="at">type =</span> <span class="st">"average"</span>)</span>
<span id="cb119-200"><a href="#cb119-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-201"><a href="#cb119-201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-202"><a href="#cb119-202" aria-hidden="true" tabindex="-1"></a>The average clustering coefficient of 0.8658 suggests that the network is highly clustered. This means that the network has tightly connected sub groups/clusters. </span>
<span id="cb119-203"><a href="#cb119-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-204"><a href="#cb119-204" aria-hidden="true" tabindex="-1"></a><span class="fu">## Path Length and Geodesic</span></span>
<span id="cb119-205"><a href="#cb119-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-208"><a href="#cb119-208" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-209"><a href="#cb119-209" aria-hidden="true" tabindex="-1"></a><span class="fu">average.path.length</span>(g_df, <span class="at">directed =</span> F)</span>
<span id="cb119-210"><a href="#cb119-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-211"><a href="#cb119-211" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-212"><a href="#cb119-212" aria-hidden="true" tabindex="-1"></a>The average path length of the network is 7.45. </span>
<span id="cb119-213"><a href="#cb119-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-214"><a href="#cb119-214" aria-hidden="true" tabindex="-1"></a><span class="fu"># Component Structure and Membership</span></span>
<span id="cb119-215"><a href="#cb119-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-218"><a href="#cb119-218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-219"><a href="#cb119-219" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(igraph<span class="sc">::</span><span class="fu">components</span>(g_df)) <span class="co"># Elements of components</span></span>
<span id="cb119-220"><a href="#cb119-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-221"><a href="#cb119-221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-222"><a href="#cb119-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-225"><a href="#cb119-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-226"><a href="#cb119-226" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">components</span>(g_df)<span class="sc">$</span>no</span>
<span id="cb119-227"><a href="#cb119-227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-228"><a href="#cb119-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-231"><a href="#cb119-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-232"><a href="#cb119-232" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">components</span>(g_df)<span class="sc">$</span>csize</span>
<span id="cb119-233"><a href="#cb119-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-234"><a href="#cb119-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-235"><a href="#cb119-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-238"><a href="#cb119-238" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-239"><a href="#cb119-239" aria-hidden="true" tabindex="-1"></a><span class="co">#igraph::components(g_df)$membership</span></span>
<span id="cb119-240"><a href="#cb119-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-241"><a href="#cb119-241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-242"><a href="#cb119-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-243"><a href="#cb119-243" aria-hidden="true" tabindex="-1"></a>The component structure shows that there is only one big component with 90 members. In other words, there is no isolates in this network.</span>
<span id="cb119-244"><a href="#cb119-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-245"><a href="#cb119-245" aria-hidden="true" tabindex="-1"></a><span class="fu"># Density of Network</span></span>
<span id="cb119-246"><a href="#cb119-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-249"><a href="#cb119-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-250"><a href="#cb119-250" aria-hidden="true" tabindex="-1"></a><span class="fu">graph.density</span>(g_df)</span>
<span id="cb119-251"><a href="#cb119-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-252"><a href="#cb119-252" aria-hidden="true" tabindex="-1"></a>The network has a 0.5202 density which means 0.5202 proportion of all possible ties are present in this network. </span>
<span id="cb119-253"><a href="#cb119-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-254"><a href="#cb119-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-255"><a href="#cb119-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-256"><a href="#cb119-256" aria-hidden="true" tabindex="-1"></a><span class="fu">## Creating a Dataframe with the Vertex Degree values</span></span>
<span id="cb119-257"><a href="#cb119-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-260"><a href="#cb119-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-261"><a href="#cb119-261" aria-hidden="true" tabindex="-1"></a>df_degree <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> <span class="fu">V</span>(g_df)<span class="sc">$</span>name, <span class="at">degree =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(g_df))</span>
<span id="cb119-262"><a href="#cb119-262" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_degree)</span>
<span id="cb119-263"><a href="#cb119-263" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-264"><a href="#cb119-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-265"><a href="#cb119-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-266"><a href="#cb119-266" aria-hidden="true" tabindex="-1"></a><span class="fu">## In degree and out degree</span></span>
<span id="cb119-269"><a href="#cb119-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-270"><a href="#cb119-270" aria-hidden="true" tabindex="-1"></a>df_degree <span class="ot">&lt;-</span> df_degree <span class="sc">|&gt;</span></span>
<span id="cb119-271"><a href="#cb119-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">indegree =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(g_df, <span class="at">mode =</span> <span class="st">"in"</span>), </span>
<span id="cb119-272"><a href="#cb119-272" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb119-273"><a href="#cb119-273" aria-hidden="true" tabindex="-1"></a>         <span class="at">outdegree =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(g_df, <span class="at">mode =</span> <span class="st">"out"</span>))</span>
<span id="cb119-274"><a href="#cb119-274" aria-hidden="true" tabindex="-1"></a>df_degree <span class="sc">|&gt;</span></span>
<span id="cb119-275"><a href="#cb119-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(outdegree)) <span class="sc">|&gt;</span></span>
<span id="cb119-276"><a href="#cb119-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb119-277"><a href="#cb119-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-278"><a href="#cb119-278" aria-hidden="true" tabindex="-1"></a>df_degree <span class="sc">|&gt;</span></span>
<span id="cb119-279"><a href="#cb119-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(indegree)) <span class="sc">|&gt;</span></span>
<span id="cb119-280"><a href="#cb119-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb119-281"><a href="#cb119-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-282"><a href="#cb119-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-283"><a href="#cb119-283" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary statistics of Network Degree</span></span>
<span id="cb119-286"><a href="#cb119-286" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-287"><a href="#cb119-287" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df_degree)</span>
<span id="cb119-288"><a href="#cb119-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-289"><a href="#cb119-289" aria-hidden="true" tabindex="-1"></a><span class="fu">## Network Degree Distribution</span></span>
<span id="cb119-290"><a href="#cb119-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-293"><a href="#cb119-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-294"><a href="#cb119-294" aria-hidden="true" tabindex="-1"></a>df_degree <span class="sc">%&gt;%</span> melt <span class="sc">%&gt;%</span> <span class="fu">filter</span>(variable <span class="sc">!=</span> <span class="st">'output'</span> <span class="sc">&amp;</span> variable <span class="sc">!=</span> <span class="st">'eigen.centrality'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb119-295"><a href="#cb119-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> variable, <span class="at">color =</span> variable)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">alpha =</span> .<span class="dv">2</span>, <span class="at">bw =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb119-296"><a href="#cb119-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Degree Distribution'</span>)</span>
<span id="cb119-297"><a href="#cb119-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-298"><a href="#cb119-298" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-299"><a href="#cb119-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-300"><a href="#cb119-300" aria-hidden="true" tabindex="-1"></a>The distribution of degrees shows that the indegree values are more at a level of 50.</span>
<span id="cb119-301"><a href="#cb119-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-302"><a href="#cb119-302" aria-hidden="true" tabindex="-1"></a><span class="fu">## Network Degree Centralization</span></span>
<span id="cb119-303"><a href="#cb119-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-306"><a href="#cb119-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-307"><a href="#cb119-307" aria-hidden="true" tabindex="-1"></a><span class="fu">centr_degree</span>(g_df, <span class="at">mode =</span> <span class="st">"in"</span>)<span class="sc">$</span>centralization</span>
<span id="cb119-308"><a href="#cb119-308" aria-hidden="true" tabindex="-1"></a><span class="fu">centr_degree</span>(g_df, <span class="at">mode =</span> <span class="st">"out"</span>)<span class="sc">$</span>centralization</span>
<span id="cb119-309"><a href="#cb119-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-310"><a href="#cb119-310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-311"><a href="#cb119-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-312"><a href="#cb119-312" aria-hidden="true" tabindex="-1"></a><span class="fu"># Eigen Vector</span></span>
<span id="cb119-313"><a href="#cb119-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-316"><a href="#cb119-316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-317"><a href="#cb119-317" aria-hidden="true" tabindex="-1"></a>temp_eigen <span class="ot">&lt;-</span> <span class="fu">centr_eigen</span>(g_df, <span class="at">directed =</span> T)</span>
<span id="cb119-318"><a href="#cb119-318" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp_eigen)</span>
<span id="cb119-319"><a href="#cb119-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-320"><a href="#cb119-320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-321"><a href="#cb119-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-324"><a href="#cb119-324" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-325"><a href="#cb119-325" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(temp_eigen<span class="sc">$</span>vector)</span>
<span id="cb119-326"><a href="#cb119-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-327"><a href="#cb119-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-328"><a href="#cb119-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-331"><a href="#cb119-331" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-332"><a href="#cb119-332" aria-hidden="true" tabindex="-1"></a>temp_eigen<span class="sc">$</span>vector</span>
<span id="cb119-333"><a href="#cb119-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-334"><a href="#cb119-334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-335"><a href="#cb119-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-338"><a href="#cb119-338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-339"><a href="#cb119-339" aria-hidden="true" tabindex="-1"></a>temp_eigen<span class="sc">$</span>centralization</span>
<span id="cb119-340"><a href="#cb119-340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-341"><a href="#cb119-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-342"><a href="#cb119-342" aria-hidden="true" tabindex="-1"></a><span class="fu">## Adding Eigen Vector to node level measures dataframe</span></span>
<span id="cb119-343"><a href="#cb119-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-346"><a href="#cb119-346" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-347"><a href="#cb119-347" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>eigen <span class="ot">&lt;-</span> <span class="fu">centr_eigen</span>(g_df, <span class="at">directed =</span> T)<span class="sc">$</span>vector</span>
<span id="cb119-348"><a href="#cb119-348" aria-hidden="true" tabindex="-1"></a><span class="co">#df_degree</span></span>
<span id="cb119-349"><a href="#cb119-349" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(df_degree, <span class="fu">desc</span>(eigen)) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb119-350"><a href="#cb119-350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-351"><a href="#cb119-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-352"><a href="#cb119-352" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bonacich Power Centrality to the dataframe</span></span>
<span id="cb119-353"><a href="#cb119-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-356"><a href="#cb119-356" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-357"><a href="#cb119-357" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>bonpow <span class="ot">&lt;-</span> <span class="fu">power_centrality</span>(g_df)</span>
<span id="cb119-358"><a href="#cb119-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-359"><a href="#cb119-359" aria-hidden="true" tabindex="-1"></a>df_degree <span class="sc">|&gt;</span></span>
<span id="cb119-360"><a href="#cb119-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(bonpow)) <span class="sc">|&gt;</span></span>
<span id="cb119-361"><a href="#cb119-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb119-362"><a href="#cb119-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-363"><a href="#cb119-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-364"><a href="#cb119-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-365"><a href="#cb119-365" aria-hidden="true" tabindex="-1"></a><span class="fu">## Derived and Reflected Centrality</span></span>
<span id="cb119-366"><a href="#cb119-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-369"><a href="#cb119-369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-370"><a href="#cb119-370" aria-hidden="true" tabindex="-1"></a>matrix_df_degree <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(g_df, <span class="at">attr =</span> <span class="st">"weight"</span>))</span>
<span id="cb119-371"><a href="#cb119-371" aria-hidden="true" tabindex="-1"></a><span class="co"># Square the adjacency matrix</span></span>
<span id="cb119-372"><a href="#cb119-372" aria-hidden="true" tabindex="-1"></a>matrix_df_degree_sq <span class="ot">&lt;-</span> <span class="fu">t</span>(matrix_df_degree) <span class="sc">%*%</span> matrix_df_degree</span>
<span id="cb119-373"><a href="#cb119-373" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the proportion of reflected centrality</span></span>
<span id="cb119-374"><a href="#cb119-374" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>rc <span class="ot">&lt;-</span> <span class="fu">diag</span>(matrix_df_degree_sq)<span class="sc">/</span><span class="fu">rowSums</span>(matrix_df_degree_sq)</span>
<span id="cb119-375"><a href="#cb119-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-376"><a href="#cb119-376" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values with 0</span></span>
<span id="cb119-377"><a href="#cb119-377" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>rc <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.nan</span>(df_degree<span class="sc">$</span>rc), <span class="dv">0</span>, df_degree<span class="sc">$</span>rc)</span>
<span id="cb119-378"><a href="#cb119-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-379"><a href="#cb119-379" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate received eigen value centrality</span></span>
<span id="cb119-380"><a href="#cb119-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-381"><a href="#cb119-381" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>eigen.rc <span class="ot">&lt;-</span> df_degree<span class="sc">$</span>eigen <span class="sc">*</span> df_degree<span class="sc">$</span>rc</span>
<span id="cb119-382"><a href="#cb119-382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-383"><a href="#cb119-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-386"><a href="#cb119-386" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-387"><a href="#cb119-387" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the proportion of derived centrality</span></span>
<span id="cb119-388"><a href="#cb119-388" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>dc <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">diag</span>(matrix_df_degree_sq)<span class="sc">/</span><span class="fu">rowSums</span>(matrix_df_degree_sq)</span>
<span id="cb119-389"><a href="#cb119-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-390"><a href="#cb119-390" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values with 0</span></span>
<span id="cb119-391"><a href="#cb119-391" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>dc <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.nan</span>(df_degree<span class="sc">$</span>dc), <span class="dv">0</span>, df_degree<span class="sc">$</span>dc)</span>
<span id="cb119-392"><a href="#cb119-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-393"><a href="#cb119-393" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate derived eigen value centrality</span></span>
<span id="cb119-394"><a href="#cb119-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-395"><a href="#cb119-395" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>eigen.dc <span class="ot">&lt;-</span> df_degree<span class="sc">$</span>eigen <span class="sc">*</span> df_degree<span class="sc">$</span>dc</span>
<span id="cb119-396"><a href="#cb119-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-397"><a href="#cb119-397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-398"><a href="#cb119-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-399"><a href="#cb119-399" aria-hidden="true" tabindex="-1"></a><span class="fu">## Centrality Score Distribution</span></span>
<span id="cb119-400"><a href="#cb119-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-403"><a href="#cb119-403" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-404"><a href="#cb119-404" aria-hidden="true" tabindex="-1"></a>df_degree <span class="sc">|&gt;</span></span>
<span id="cb119-405"><a href="#cb119-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">|&gt;</span></span>
<span id="cb119-406"><a href="#cb119-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>() <span class="sc">|&gt;</span></span>
<span id="cb119-407"><a href="#cb119-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value)) <span class="sc">+</span></span>
<span id="cb119-408"><a href="#cb119-408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb119-409"><a href="#cb119-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>key, <span class="at">scales =</span> <span class="st">"free"</span>)</span>
<span id="cb119-410"><a href="#cb119-410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-411"><a href="#cb119-411" aria-hidden="true" tabindex="-1"></a><span class="fu">## Centrality Measure Correlations</span></span>
<span id="cb119-412"><a href="#cb119-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-413"><a href="#cb119-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-414"><a href="#cb119-414" aria-hidden="true" tabindex="-1"></a><span class="fu">## Closeness Centrality</span></span>
<span id="cb119-417"><a href="#cb119-417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-418"><a href="#cb119-418" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>close <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">closeness</span>(g_df)</span>
<span id="cb119-419"><a href="#cb119-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-420"><a href="#cb119-420" aria-hidden="true" tabindex="-1"></a>df_degree <span class="sc">|&gt;</span></span>
<span id="cb119-421"><a href="#cb119-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(close)) <span class="sc">|&gt;</span></span>
<span id="cb119-422"><a href="#cb119-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb119-423"><a href="#cb119-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-424"><a href="#cb119-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-425"><a href="#cb119-425" aria-hidden="true" tabindex="-1"></a><span class="fu">## Betweenness Centrality</span></span>
<span id="cb119-428"><a href="#cb119-428" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-429"><a href="#cb119-429" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>between <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">betweenness</span>(g_df)</span>
<span id="cb119-430"><a href="#cb119-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-431"><a href="#cb119-431" aria-hidden="true" tabindex="-1"></a>df_degree <span class="sc">|&gt;</span></span>
<span id="cb119-432"><a href="#cb119-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(between)) <span class="sc">|&gt;</span></span>
<span id="cb119-433"><a href="#cb119-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb119-434"><a href="#cb119-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-435"><a href="#cb119-435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-436"><a href="#cb119-436" aria-hidden="true" tabindex="-1"></a>We can calculate the network level score of betweenness centralization</span>
<span id="cb119-439"><a href="#cb119-439" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-440"><a href="#cb119-440" aria-hidden="true" tabindex="-1"></a><span class="fu">centr_betw</span>(g_df)<span class="sc">$</span>centralization</span>
<span id="cb119-441"><a href="#cb119-441" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-442"><a href="#cb119-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-443"><a href="#cb119-443" aria-hidden="true" tabindex="-1"></a><span class="fu">## Network Constraint</span></span>
<span id="cb119-446"><a href="#cb119-446" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-447"><a href="#cb119-447" aria-hidden="true" tabindex="-1"></a>df_degree<span class="sc">$</span>constraint <span class="ot">&lt;-</span> <span class="fu">constraint</span>(g_df)</span>
<span id="cb119-448"><a href="#cb119-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-449"><a href="#cb119-449" aria-hidden="true" tabindex="-1"></a>df_degree <span class="sc">|&gt;</span> <span class="fu">arrange</span>(constraint) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb119-450"><a href="#cb119-450" aria-hidden="true" tabindex="-1"></a>df_degree <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(constraint)) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb119-451"><a href="#cb119-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-452"><a href="#cb119-452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-453"><a href="#cb119-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-454"><a href="#cb119-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-455"><a href="#cb119-455" aria-hidden="true" tabindex="-1"></a>Feeds &amp; organic fertilizer, Metallic ores and Medicaments are the most reduntant industries while Misc. ceramic, stone &amp; clay products, Glass &amp; glass products and Industrial inorganic chemicals industries are the least reduntant ones.</span>
<span id="cb119-456"><a href="#cb119-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-457"><a href="#cb119-457" aria-hidden="true" tabindex="-1"></a><span class="fu">## Centrality Measure Correlations</span></span>
<span id="cb119-458"><a href="#cb119-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-461"><a href="#cb119-461" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-462"><a href="#cb119-462" aria-hidden="true" tabindex="-1"></a>corrplot <span class="sc">::</span> <span class="fu">corrplot</span>(<span class="fu">cor</span>(df_degree[ , <span class="sc">-</span><span class="dv">1</span>]), <span class="at">title =</span> <span class="st">'Correlation Plot'</span>)</span>
<span id="cb119-463"><a href="#cb119-463" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-464"><a href="#cb119-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-467"><a href="#cb119-467" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-468"><a href="#cb119-468" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">&lt;-</span> kableExtra <span class="sc">::</span> <span class="fu">kable</span>(<span class="fu">apply</span>(df_degree[ , <span class="sc">-</span><span class="dv">1</span>], <span class="dv">2</span>, <span class="cf">function</span> (x) df_degree<span class="sc">$</span>name[<span class="fu">order</span>(x, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)][<span class="dv">1</span> <span class="sc">:</span> <span class="dv">10</span>]))</span>
<span id="cb119-469"><a href="#cb119-469" aria-hidden="true" tabindex="-1"></a>table1</span>
<span id="cb119-470"><a href="#cb119-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-471"><a href="#cb119-471" aria-hidden="true" tabindex="-1"></a>industry_io.node <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">apply</span>(df_degree[ , <span class="sc">-</span><span class="dv">1</span>], <span class="dv">2</span>, <span class="cf">function</span> (x) df_degree<span class="sc">$</span>name[<span class="fu">order</span>(x, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)][<span class="dv">1</span> <span class="sc">:</span> <span class="dv">10</span>]))</span>
<span id="cb119-472"><a href="#cb119-472" aria-hidden="true" tabindex="-1"></a>industry_io.node</span>
<span id="cb119-473"><a href="#cb119-473" aria-hidden="true" tabindex="-1"></a>df_degree_io <span class="ot">&lt;-</span> df_degree</span>
<span id="cb119-474"><a href="#cb119-474" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-475"><a href="#cb119-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-476"><a href="#cb119-476" aria-hidden="true" tabindex="-1"></a>These are the industries having the highest of centrality measures for the industries network. The nodes having higher indegrees have more inwards directed edges while outdegree gives an idea about how the outwards connections are for the node. Eigen vector, Bonacich value, Eigen Reflected Centrality, Eigen Derived Centrality are various measures of centrality of nodes. These measures suggests how influential the nodes are. Betweenness is a measure of the position of nodes in terms of closeness to other influential nodes. Constraint tells us about the level of redundancy of a node in the network to create connections with other neighbouring nodes.</span>
<span id="cb119-477"><a href="#cb119-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-478"><a href="#cb119-478" aria-hidden="true" tabindex="-1"></a><span class="fu"># Most and Least influential industries and their contribution to the waste output</span></span>
<span id="cb119-479"><a href="#cb119-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-480"><a href="#cb119-480" aria-hidden="true" tabindex="-1"></a>Eventhough the different measures of centrality talks about the significance and influence of nodes, we are taking into consideration, Bonacich power and Constraint here to compare the waste output.</span>
<span id="cb119-481"><a href="#cb119-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-482"><a href="#cb119-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-485"><a href="#cb119-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-486"><a href="#cb119-486" aria-hidden="true" tabindex="-1"></a>df_bonpow <span class="ot">&lt;-</span> df_degree <span class="sc">|&gt;</span></span>
<span id="cb119-487"><a href="#cb119-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(bonpow)) <span class="sc">|&gt;</span></span>
<span id="cb119-488"><a href="#cb119-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb119-489"><a href="#cb119-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-490"><a href="#cb119-490" aria-hidden="true" tabindex="-1"></a>df_constraint <span class="ot">&lt;-</span> df_degree <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(constraint)) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb119-491"><a href="#cb119-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-492"><a href="#cb119-492" aria-hidden="true" tabindex="-1"></a>industry_waste <span class="ot">&lt;-</span> data_2011 <span class="sc">|&gt;</span> <span class="fu">select</span>(</span>
<span id="cb119-493"><a href="#cb119-493" aria-hidden="true" tabindex="-1"></a>...<span class="dv">1</span>, <span class="dv">83</span><span class="sc">:</span><span class="dv">92</span>)</span>
<span id="cb119-494"><a href="#cb119-494" aria-hidden="true" tabindex="-1"></a>industry_waste</span>
<span id="cb119-495"><a href="#cb119-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-496"><a href="#cb119-496" aria-hidden="true" tabindex="-1"></a>filtered_data1 <span class="ot">&lt;-</span> industry_waste[industry_waste<span class="sc">$</span>...<span class="dv">1</span> <span class="sc">%in%</span> df_bonpow<span class="sc">$</span>name, ]</span>
<span id="cb119-497"><a href="#cb119-497" aria-hidden="true" tabindex="-1"></a>filtered_data2 <span class="ot">&lt;-</span> industry_waste[industry_waste<span class="sc">$</span>...<span class="dv">1</span> <span class="sc">%in%</span> df_constraint<span class="sc">$</span>name, ]</span>
<span id="cb119-498"><a href="#cb119-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-499"><a href="#cb119-499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-502"><a href="#cb119-502" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-503"><a href="#cb119-503" aria-hidden="true" tabindex="-1"></a>combined_df_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(combined_df, <span class="at">id.vars =</span> <span class="st">"...1"</span>, <span class="at">variable.name =</span> <span class="st">"to"</span>, <span class="at">value.name =</span> <span class="st">"weight"</span>, <span class="at">variable.factor =</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-504"><a href="#cb119-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-505"><a href="#cb119-505" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the "Industries" column to "From"</span></span>
<span id="cb119-506"><a href="#cb119-506" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(combined_df_long)[<span class="fu">colnames</span>(combined_df_long) <span class="sc">==</span> <span class="st">"...1"</span>] <span class="ot">&lt;-</span> <span class="st">"from"</span></span>
<span id="cb119-507"><a href="#cb119-507" aria-hidden="true" tabindex="-1"></a>combined_df_long</span>
<span id="cb119-508"><a href="#cb119-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-509"><a href="#cb119-509" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-510"><a href="#cb119-510" aria-hidden="true" tabindex="-1"></a><span class="fu">## Waste output from most significant industries</span></span>
<span id="cb119-513"><a href="#cb119-513" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-514"><a href="#cb119-514" aria-hidden="true" tabindex="-1"></a>filter1_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(filtered_data1, <span class="at">id.vars =</span> <span class="st">"...1"</span>, <span class="at">variable.name =</span> <span class="st">"to"</span>, <span class="at">value.name =</span> <span class="st">"weight"</span>, <span class="at">variable.factor =</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-515"><a href="#cb119-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-516"><a href="#cb119-516" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the "Industries" column to "From"</span></span>
<span id="cb119-517"><a href="#cb119-517" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(filter1_long)[<span class="fu">colnames</span>(filter1_long) <span class="sc">==</span> <span class="st">"...1"</span>] <span class="ot">&lt;-</span> <span class="st">"from"</span></span>
<span id="cb119-518"><a href="#cb119-518" aria-hidden="true" tabindex="-1"></a><span class="co">#filter1_long</span></span>
<span id="cb119-519"><a href="#cb119-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-520"><a href="#cb119-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-521"><a href="#cb119-521" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a heatmap plot</span></span>
<span id="cb119-522"><a href="#cb119-522" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filter1_long, <span class="fu">aes</span>(<span class="at">x =</span> from, <span class="at">y =</span> to, <span class="at">fill =</span> <span class="fu">log</span>(weight))) <span class="sc">+</span></span>
<span id="cb119-523"><a href="#cb119-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb119-524"><a href="#cb119-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"yellow"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span>  <span class="co"># Change the color pattern</span></span>
<span id="cb119-525"><a href="#cb119-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"To"</span>, <span class="at">title =</span> <span class="st">"Heatmap of Weight"</span>) <span class="sc">+</span></span>
<span id="cb119-526"><a href="#cb119-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb119-527"><a href="#cb119-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotate x-axis labels</span></span>
<span id="cb119-528"><a href="#cb119-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-529"><a href="#cb119-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-530"><a href="#cb119-530" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-531"><a href="#cb119-531" aria-hidden="true" tabindex="-1"></a><span class="fu">## Waste output from industries with high redundancy</span></span>
<span id="cb119-534"><a href="#cb119-534" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb119-535"><a href="#cb119-535" aria-hidden="true" tabindex="-1"></a>filter2_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(filtered_data2, <span class="at">id.vars =</span> <span class="st">"...1"</span>, <span class="at">variable.name =</span> <span class="st">"to"</span>, <span class="at">value.name =</span> <span class="st">"weight"</span>, <span class="at">variable.factor =</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-536"><a href="#cb119-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-537"><a href="#cb119-537" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the "Industries" column to "From"</span></span>
<span id="cb119-538"><a href="#cb119-538" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(filter2_long)[<span class="fu">colnames</span>(filter2_long) <span class="sc">==</span> <span class="st">"...1"</span>] <span class="ot">&lt;-</span> <span class="st">"from"</span></span>
<span id="cb119-539"><a href="#cb119-539" aria-hidden="true" tabindex="-1"></a><span class="co">#filter2_long</span></span>
<span id="cb119-540"><a href="#cb119-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-541"><a href="#cb119-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-542"><a href="#cb119-542" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a heatmap plot</span></span>
<span id="cb119-543"><a href="#cb119-543" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filter2_long, <span class="fu">aes</span>(<span class="at">x =</span> from, <span class="at">y =</span> to, <span class="at">fill =</span> <span class="fu">log</span>(weight))) <span class="sc">+</span></span>
<span id="cb119-544"><a href="#cb119-544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb119-545"><a href="#cb119-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"yellow"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span>  <span class="co"># Change the color pattern</span></span>
<span id="cb119-546"><a href="#cb119-546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"To"</span>, <span class="at">title =</span> <span class="st">"Heatmap of Weight"</span>) <span class="sc">+</span></span>
<span id="cb119-547"><a href="#cb119-547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb119-548"><a href="#cb119-548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotate x-axis labels</span></span>
<span id="cb119-549"><a href="#cb119-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-550"><a href="#cb119-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-551"><a href="#cb119-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-552"><a href="#cb119-552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb119-553"><a href="#cb119-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-554"><a href="#cb119-554" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusion</span></span>
<span id="cb119-555"><a href="#cb119-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-556"><a href="#cb119-556" aria-hidden="true" tabindex="-1"></a>The results show how much wastes go to each of the waste processing methods from the industries having most centrality measures and the most redundancy measures.</span>
<span id="cb119-557"><a href="#cb119-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-558"><a href="#cb119-558" aria-hidden="true" tabindex="-1"></a><span class="fu"># Limitation</span></span>
<span id="cb119-559"><a href="#cb119-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-560"><a href="#cb119-560" aria-hidden="true" tabindex="-1"></a>The dataset is an older data. It is from Japan. Taking these things into consideration, we cannot make a solid conclusion about the waste outputs from industries in other parts of the world today. Also, we can compare the weight outputs from industries having each of the centrality score high and low. This would make the analysis even harder. So this study has been concluded with the available results.</span>
<span id="cb119-561"><a href="#cb119-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-562"><a href="#cb119-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-563"><a href="#cb119-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-564"><a href="#cb119-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-565"><a href="#cb119-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-566"><a href="#cb119-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-567"><a href="#cb119-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-568"><a href="#cb119-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-569"><a href="#cb119-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-570"><a href="#cb119-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-571"><a href="#cb119-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-572"><a href="#cb119-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-573"><a href="#cb119-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-574"><a href="#cb119-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-575"><a href="#cb119-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-576"><a href="#cb119-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-577"><a href="#cb119-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-578"><a href="#cb119-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-579"><a href="#cb119-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-580"><a href="#cb119-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-581"><a href="#cb119-581" aria-hidden="true" tabindex="-1"></a><span class="fu"># Reference:</span></span>
<span id="cb119-582"><a href="#cb119-582" aria-hidden="true" tabindex="-1"></a>1) Nakamura, S. (2020). Tracking the Product Origins of Waste for Treatment Using the WIO Data Developed by the Japanese Ministry of the Environment. Env. Sci. Technol. https://doi.org/10.1021/acs.est.0c06015</span>
<span id="cb119-583"><a href="#cb119-583" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>