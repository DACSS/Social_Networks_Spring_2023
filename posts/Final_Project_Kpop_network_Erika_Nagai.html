<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Erika Nagai">
<meta name="dcterms.date" content="2023-05-20">

<title>Final Project Kpop Collaboration Network</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<meta name="twitter:title" content="Final Project Kpop Collaboration Network">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://dacss.github.io/Social_Networks_Spring_2023/posts/Final_Project_Kpop_network_Erika_Nagai_files/figure-html/unnamed-chunk-19-1.png">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:site" content="@UMassDACSS">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/UMass White Wordmark Horiz.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://dacss.github.io/Social_Networks_Spring_2023/" rel="" target="">
 <span class="menu-text">Spring 2023 Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">Contributors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss" rel="" target="">
 <span class="menu-text">DACSS</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://dacss.github.io/Social_Networks_Spring_2023/" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#literature-review-and-hypothesis" id="toc-literature-review-and-hypothesis" class="nav-link" data-scroll-target="#literature-review-and-hypothesis">Literature review and hypothesis</a></li>
  <li><a href="#methods-of-studies" id="toc-methods-of-studies" class="nav-link" data-scroll-target="#methods-of-studies">Methods of studies</a></li>
  <li><a href="#read-in-describe-data" id="toc-read-in-describe-data" class="nav-link" data-scroll-target="#read-in-describe-data">Read in &amp; Describe data</a></li>
  <li><a href="#describe-clean-the-data" id="toc-describe-clean-the-data" class="nav-link" data-scroll-target="#describe-clean-the-data">Describe &amp; Clean the data</a>
  <ul class="collapse">
  <li><a href="#collab_songs-dataframe" id="toc-collab_songs-dataframe" class="nav-link" data-scroll-target="#collab_songs-dataframe"><code>collab_songs</code> dataframe</a></li>
  <li><a href="#artists" id="toc-artists" class="nav-link" data-scroll-target="#artists">Artists</a></li>
  <li><a href="#song_detail-song_detail.csv" id="toc-song_detail-song_detail.csv" class="nav-link" data-scroll-target="#song_detail-song_detail.csv">song_detail (song_detail.csv)</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#how-many-k-pop-collaboration-songs-are-released-by-year" id="toc-how-many-k-pop-collaboration-songs-are-released-by-year" class="nav-link" data-scroll-target="#how-many-k-pop-collaboration-songs-are-released-by-year">How many K-pop collaboration songs are released by year?</a></li>
  <li><a href="#is-the-popularity-of-k-pop-collaboration-songs-increasing" id="toc-is-the-popularity-of-k-pop-collaboration-songs-increasing" class="nav-link" data-scroll-target="#is-the-popularity-of-k-pop-collaboration-songs-increasing">Is the popularity of K-pop collaboration songs increasing?</a></li>
  <li><a href="#the-popularity-of-k-pop-artists" id="toc-the-popularity-of-k-pop-artists" class="nav-link" data-scroll-target="#the-popularity-of-k-pop-artists">The popularity of K-pop artists</a></li>
  </ul></li>
  <li><a href="#data-processing" id="toc-data-processing" class="nav-link" data-scroll-target="#data-processing">Data Processing</a>
  <ul class="collapse">
  <li><a href="#convert-the-data-in-an-edgelist-format" id="toc-convert-the-data-in-an-edgelist-format" class="nav-link" data-scroll-target="#convert-the-data-in-an-edgelist-format">Convert the data in an edgelist format</a></li>
  </ul></li>
  <li><a href="#total-overview-of-k-pop-collaboration-network" id="toc-total-overview-of-k-pop-collaboration-network" class="nav-link" data-scroll-target="#total-overview-of-k-pop-collaboration-network">(Total) Overview of K-pop collaboration network</a></li>
  <li><a href="#network-overview" id="toc-network-overview" class="nav-link" data-scroll-target="#network-overview">Network overview</a>
  <ul class="collapse">
  <li><a href="#nodes-and-edges" id="toc-nodes-and-edges" class="nav-link" data-scroll-target="#nodes-and-edges">Nodes and Edges</a></li>
  <li><a href="#density-and-transitivity" id="toc-density-and-transitivity" class="nav-link" data-scroll-target="#density-and-transitivity">Density and transitivity</a></li>
  <li><a href="#degree" id="toc-degree" class="nav-link" data-scroll-target="#degree">Degree</a></li>
  <li><a href="#dyad-census" id="toc-dyad-census" class="nav-link" data-scroll-target="#dyad-census">Dyad Census</a></li>
  <li><a href="#triad-census" id="toc-triad-census" class="nav-link" data-scroll-target="#triad-census">Triad Census</a></li>
  <li><a href="#transitivity" id="toc-transitivity" class="nav-link" data-scroll-target="#transitivity">Transitivity</a></li>
  <li><a href="#component-structure" id="toc-component-structure" class="nav-link" data-scroll-target="#component-structure">Component Structure</a></li>
  </ul></li>
  <li><a href="#closer-look" id="toc-closer-look" class="nav-link" data-scroll-target="#closer-look">Closer look</a></li>
  <li><a href="#by-regime" id="toc-by-regime" class="nav-link" data-scroll-target="#by-regime">(By regime)</a>
  <ul class="collapse">
  <li><a href="#overview-how-the-collaboration-patterns-have-changed-over-time" id="toc-overview-how-the-collaboration-patterns-have-changed-over-time" class="nav-link" data-scroll-target="#overview-how-the-collaboration-patterns-have-changed-over-time">Overview: How the collaboration patterns have changed over time?</a></li>
  </ul></li>
  <li><a href="#how-does-the-nature-of-collaboration-change-between-2017-2020-and-2021-" id="toc-how-does-the-nature-of-collaboration-change-between-2017-2020-and-2021-" class="nav-link" data-scroll-target="#how-does-the-nature-of-collaboration-change-between-2017-2020-and-2021-">How does the nature of collaboration change between 2017-2020 and 2021-?</a></li>
  <li><a href="#summary-of-evoluation-of-k-pop-collaborations-for-last-20-years." id="toc-summary-of-evoluation-of-k-pop-collaborations-for-last-20-years." class="nav-link" data-scroll-target="#summary-of-evoluation-of-k-pop-collaborations-for-last-20-years.">Summary of evoluation of K-pop collaborations for last 20 years.</a></li>
  <li><a href="#additional-analysis" id="toc-additional-analysis" class="nav-link" data-scroll-target="#additional-analysis">Additional analysis</a>
  <ul class="collapse">
  <li><a href="#artists-based-analysis-who-are-the-key-artists" id="toc-artists-based-analysis-who-are-the-key-artists" class="nav-link" data-scroll-target="#artists-based-analysis-who-are-the-key-artists">(Artists-based analysis) Who are the key artists?</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  <li><a href="#source" id="toc-source" class="nav-link" data-scroll-target="#source">Source</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Final Project Kpop Collaboration Network</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Erika Nagai </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 20, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>Overview</h1>
<p>The phenomenon of K-pop has recently emerged as a prominent cultural force, gaining significant attention and popularity not only in South Korea and other Asian nations but globally as well, particularly among the younger generation. An interesting aspect of K-pop is that many K-pop artists collaborate with other artists, often those who are not based in South Korea. In this analysis, my objective is to delve into the dynamics of such collaborations within the K-pop industry and beyond, across various musical genres, and to investigate how these collaborative patterns have evolved over time. To achieve this goal, I aim to examine the social network of K-pop collaborations, with a view to gaining a better understanding of the underlying trends and structures shaping this phenomenon.</p>
</section>
<section id="literature-review-and-hypothesis" class="level1">
<h1>Literature review and hypothesis</h1>
<p>During the 1990s, Seo Taiji gained significant popularity in the K-pop industry by pioneering a fusion of hip-hop and euro-pop-inspired songs (Kyung, 2021). Subsequently, from the late 1990s to the mid-2020s, K-pop experienced a surge in popularity in other Asian regions, particularly China and Japan (Kyung, 2021; Shin, 2009). The notable global success of Psy’s “Gangnam Style” in 2012 served as a pivotal moment, propelling K-pop into the U.S. market and instilling hope within the industry for accessing a broader international audience (Kyung, 2021). Based on these historical developments, I hypothesized: H1. K-pop started to collaborate on songs with international artists, particularly those from Western countries, following the impact of “Gangnam Style” in 2012.”</p>
</section>
<section id="methods-of-studies" class="level1">
<h1>Methods of studies</h1>
<p>To analyze the K-pop music landscape, the following steps were taken: First, the name of K-pop artists were gathered by prompting ChatGPT on famous K-pop artists for the last 20 years (specifically, as of 2005, 2010, 2012, 2015, 2018, and 2020) and by extracting all the artists’ name from Spotify official playlists “Top-KPop Artists of 2022,” “Millenium K-Pop,” “Best of 2008: K-Pop”. Then, all the songs who are sung by these artists were gathered using Spotify API and only collaboration songs, which are sung by more than one artist were used for this analysis. This resulted in 1123 songs by 962 artists/groups. (Refer to “Preparation_SpotifyID.ipynb” and “K-Pop Social Network ANalysis.ipynb” for the process of data collection.)</p>
</section>
<section id="read-in-describe-data" class="level1">
<h1>Read in &amp; Describe data</h1>
<p><strong>collab_songs.csv:</strong></p>
<p>This is a list of collaboration songs collected by</p>
<ol type="1">
<li>gathering the name of the top 50 Kpop artists in 2010, 2015, and 2020 by asking ChatGPT</li>
<li>manually collecting their Spotify artist id</li>
<li>collecting all the singles/albums data of the artists by using Spotify API and</li>
<li>removing the songs that are NOT collaborative by filtering out those who have only one artist registered</li>
</ol>
<p><strong>artist.csv:</strong></p>
<p>This is a list of artists performed the collaboration songs collected by</p>
<ol type="1">
<li>extracting the unique artists from the collab_songs.csv</li>
<li>collecting their information (genre and followers) using Spotify API</li>
</ol>
<p><strong>song_detail.csv:</strong></p>
<p>This is a list of songs with detail information prepared by</p>
<ol type="1">
<li>extracting the detailed song information (release year, available market etc) by using Spotify API based on the track id from kpop_collab.csv</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'igraph' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'igraph'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    decompose, spectrum</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:base':

    union</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:igraph':

    as_data_frame, groups, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.2.2</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'tidyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:igraph':

    crossing</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C:/Users/Microsoft/Documents/DACSS/753_Social_Network/Social_Networks_Spring_2023/posts"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>collab_songs <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"_data/Kpop_analysis_ErikaNagai/final_collab_songs.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 1123 Columns: 30
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (30): song_name, kpop_artist_name, song_id, artist_id, artist_1, artist_...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>artists <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"_data/Kpop_analysis_ErikaNagai/final_artists_df.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 962 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): name, id, genre
dbl (2): top_kpop, followers

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>song_detail <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"_data/Kpop_analysis_ErikaNagai/song_detail.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 1123 Columns: 20
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(11): album, artists, available_markets, external_ids, external_urls, h... dbl
(6): ...1, disc_number, duration_ms, popularity, track_number, release... lgl
(2): explicit, is_local date (1): release_date
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...1`</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>song_detail <span class="ot">&lt;-</span> song_detail <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"...1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="describe-clean-the-data" class="level1">
<h1>Describe &amp; Clean the data</h1>
<section id="collab_songs-dataframe" class="level3">
<h3 class="anchored" data-anchor-id="collab_songs-dataframe"><code>collab_songs</code> dataframe</h3>
<p><code>collab_songs</code> is a dataframe where each observation is a collaboration songs by Kpop top artists and other artists.</p>
<p>It has 1123 rows (collaboration songs) and 30 columns.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'skimr' was built under R version 4.2.3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Skim the data</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(collab_songs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">collab_songs</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">1123</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">30</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 22%">
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">song_name</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">140</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1116</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">kpop_artist_name</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">140</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">song_id</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1123</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">artist_id</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">140</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">artist_1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">669</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">artist_id_1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">667</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">artist_2</td>
<td style="text-align: right;">697</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">228</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">artist_id_2</td>
<td style="text-align: right;">698</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">227</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">artist_3</td>
<td style="text-align: right;">990</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">artist_id_3</td>
<td style="text-align: right;">990</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">artist_4</td>
<td style="text-align: right;">1086</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">artist_id_4</td>
<td style="text-align: right;">1086</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">artist_5</td>
<td style="text-align: right;">1103</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">artist_id_5</td>
<td style="text-align: right;">1103</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">artist_6</td>
<td style="text-align: right;">1113</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">artist_id_6</td>
<td style="text-align: right;">1113</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">artist_7</td>
<td style="text-align: right;">1116</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">artist_id_7</td>
<td style="text-align: right;">1116</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">artist_8</td>
<td style="text-align: right;">1120</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">artist_id_8</td>
<td style="text-align: right;">1120</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">artist_9</td>
<td style="text-align: right;">1121</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">artist_id_9</td>
<td style="text-align: right;">1121</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">artist_10</td>
<td style="text-align: right;">1121</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">artist_id_10</td>
<td style="text-align: right;">1121</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">artist_11</td>
<td style="text-align: right;">1122</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">artist_id_11</td>
<td style="text-align: right;">1122</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">artist_12</td>
<td style="text-align: right;">1122</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">artist_id_12</td>
<td style="text-align: right;">1122</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">artist_13</td>
<td style="text-align: right;">1122</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">artist_id_13</td>
<td style="text-align: right;">1122</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(collab_songs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  song_name         kpop_artist_name     song_id           artist_id        
 Length:1123        Length:1123        Length:1123        Length:1123       
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
   artist_1         artist_id_1          artist_2         artist_id_2       
 Length:1123        Length:1123        Length:1123        Length:1123       
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
   artist_3         artist_id_3          artist_4         artist_id_4       
 Length:1123        Length:1123        Length:1123        Length:1123       
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
   artist_5         artist_id_5          artist_6         artist_id_6       
 Length:1123        Length:1123        Length:1123        Length:1123       
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
   artist_7         artist_id_7          artist_8         artist_id_8       
 Length:1123        Length:1123        Length:1123        Length:1123       
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
   artist_9         artist_id_9         artist_10         artist_id_10      
 Length:1123        Length:1123        Length:1123        Length:1123       
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
  artist_11         artist_id_11        artist_12         artist_id_12      
 Length:1123        Length:1123        Length:1123        Length:1123       
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
  artist_13         artist_id_13      
 Length:1123        Length:1123       
 Class :character   Class :character  
 Mode  :character   Mode  :character  </code></pre>
</div>
</div>
<p><code>collab_songs</code> has following columns.</p>
<ul>
<li><p>song_name</p></li>
<li><p>song_id: this can be used as a key when joining with <code>song_detail</code> dataframe</p></li>
<li><p>kpop_artist_name: This is a name of the Kpop top artists.(KPop top artists are from Spotify Top playlists or the answers from Chat GPT)</p></li>
<li><p>artist_id: This is a Spotify Artist id of the Kpop top artists. This can be used as a key when joining with <code>artist</code> dataframe</p></li>
<li><p>artist_[i]: This is a name of the artists that collaborated with Kpop top artists or the Kpop top artists themselves, which means that it might duplicate with <code>kpop_artist_name</code> (i is a number from 1 to 7)</p></li>
<li><p>artist_id_[i]: This is a Spotify Artist ID of the artists that collaborated with Kpop top artists or the Kpop top artists themselves, which means that it might duplicate with <code>artist_id</code> (i is a number from 1 to 7). This can be used as a key when joining with <code>artists</code> dataframe.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>collab_songs <span class="ot">&lt;-</span> collab_songs <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"song_name"</span>, <span class="st">"song_id"</span>, <span class="st">"kpop_artist_name"</span>, <span class="st">"artist_id"</span>, <span class="st">"artist_1"</span>, <span class="st">"artist_id_1"</span>, <span class="st">"artist_2"</span>, <span class="st">"artist_id_2"</span>, <span class="st">"artist_3"</span>, <span class="st">"artist_id_3"</span>, <span class="st">"artist_4"</span>, <span class="st">"artist_id_4"</span>, <span class="st">"artist_5"</span>, <span class="st">"artist_id_5"</span>, <span class="st">"artist_6"</span>, <span class="st">"artist_id_6"</span>, <span class="st">"artist_7"</span>, <span class="st">"artist_id_7"</span>, <span class="st">"artist_8"</span>, <span class="st">"artist_id_8"</span>, <span class="st">"artist_9"</span>, <span class="st">"artist_id_9"</span>, <span class="st">"artist_10"</span>, <span class="st">"artist_id_10"</span>, <span class="st">"artist_11"</span>, <span class="st">"artist_id_11"</span>, <span class="st">"artist_12"</span>, <span class="st">"artist_id_12"</span>, <span class="st">"artist_13"</span>, <span class="st">"artist_id_13"</span>))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>collab_songs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,123 × 30
   song_name     song_id kpop_…¹ artis…² artis…³ artis…⁴ artis…⁵ artis…⁶ artis…⁷
   &lt;chr&gt;         &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
 1 Angel Pt. 1 … 5qyjy0… BTS     3Nrfpe… Jimin   1oSPZh… JVKE    164Uj4… Kodak …
 2 Dreamers [Mu… 1RDvyO… BTS     3Nrfpe… Jung K… 6HaGTQ… BTS     3Nrfpe… FIFA S…
 3 Bad Decision… 0xzI1K… BTS     3Nrfpe… benny … 5CiGnK… BTS     3Nrfpe… Snoop …
 4 Left and Rig… 0mBP9X… BTS     3Nrfpe… Charli… 6VuMaD… Jung K… 6HaGTQ… BTS    
 5 My Universe … 5FvxRv… BTS     3Nrfpe… Coldpl… 4gzpq5… BTS     3Nrfpe… David …
 6 My Universe … 1Dlczm… BTS     3Nrfpe… Coldpl… 4gzpq5… BTS     3Nrfpe… Galant…
 7 My Universe … 6Lgbf4… BTS     3Nrfpe… Coldpl… 4gzpq5… BTS     3Nrfpe… &lt;NA&gt;   
 8 My Universe … 6BeOJP… BTS     3Nrfpe… Coldpl… 4gzpq5… BTS     3Nrfpe… SUGA   
 9 Butter - Meg… 474Vqn… BTS     3Nrfpe… Megan … 181bsR… &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;   
10 Savage Love … 4TgxFM… BTS     3Nrfpe… Jawsh … 56mfhU… Jason … 07YZf4… BTS    
# … with 1,113 more rows, 21 more variables: artist_id_3 &lt;chr&gt;, artist_4 &lt;chr&gt;,
#   artist_id_4 &lt;chr&gt;, artist_5 &lt;chr&gt;, artist_id_5 &lt;chr&gt;, artist_6 &lt;chr&gt;,
#   artist_id_6 &lt;chr&gt;, artist_7 &lt;chr&gt;, artist_id_7 &lt;chr&gt;, artist_8 &lt;chr&gt;,
#   artist_id_8 &lt;chr&gt;, artist_9 &lt;chr&gt;, artist_id_9 &lt;chr&gt;, artist_10 &lt;chr&gt;,
#   artist_id_10 &lt;chr&gt;, artist_11 &lt;chr&gt;, artist_id_11 &lt;chr&gt;, artist_12 &lt;chr&gt;,
#   artist_id_12 &lt;chr&gt;, artist_13 &lt;chr&gt;, artist_id_13 &lt;chr&gt;, and abbreviated
#   variable names ¹​kpop_artist_name, ²​artist_id, ³​artist_1, ⁴​artist_id_1, …</code></pre>
</div>
</div>
</section>
<section id="artists" class="level3">
<h3 class="anchored" data-anchor-id="artists">Artists</h3>
<p><code>artists</code> is a dataframe where each row represents an artist (individual/group) that have participated in Kpop collaboration songs by top Kpop artists.</p>
<ol type="1">
<li><p>name: the name of the artist</p></li>
<li><p>id: This is a Spotify Artist ID of the artist. It can be used as a key when joining with <code>collab_songs</code> dataframe</p></li>
<li><p>top_kpop: if the artist is one of the top 50 Kpop artists in 2010, 2015, or 2020, the value is 1. Otherwise, the value is 0.</p></li>
<li><p>genre: the genre of the artist (can be multiple)</p></li>
<li><p>followers: the number of the followers on Spotify. Spotify API doesn’t provide the number of artists’ monthly followers so the number of followers is the only index of popularity of artists.</p></li>
</ol>
<p><code>artist</code> dataframe has 962 unique rows, meaning that there are 962 artists (including K-pop artists, and non-kpop artists) that have participated in K-pop musical collaboration</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(artists)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">artists</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">962</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">name</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">962</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">id</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">962</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">genre</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 2%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">top_kpop</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">▇▁▁▁▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">followers</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1346115.00</td>
<td style="text-align: right;">5889520.19</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1167.25</td>
<td style="text-align: right;">39480</td>
<td style="text-align: right;">387868.5</td>
<td style="text-align: right;">111956794</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(artists)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     name                id               top_kpop         genre          
 Length:962         Length:962         Min.   :0.0000   Length:962        
 Class :character   Class :character   1st Qu.:0.0000   Class :character  
 Mode  :character   Mode  :character   Median :0.0000   Mode  :character  
                                       Mean   :0.1455                     
                                       3rd Qu.:0.0000                     
                                       Max.   :1.0000                     
   followers        
 Min.   :        0  
 1st Qu.:     1167  
 Median :    39480  
 Mean   :  1346115  
 3rd Qu.:   387868  
 Max.   :111956794  </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>artists</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 962 × 5
   name                                id                  top_k…¹ genre follo…²
   &lt;chr&gt;                               &lt;chr&gt;                 &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;
 1 Relax Beer                          04BxwccHO4U2wMwVLv…       0 []     2   e0
 2 KAHI                                04C0MPapc1HXpTbspJ…       0 []     0     
 3 LE                                  04JxNGSux7QdmrCvnQ…       0 []     4.2 e1
 4 Sunwoojunga                         04L3elxyr0XFua2Ek3…       0 ['k-…  9.49e4
 5 Miso                                04xEkodoWyFji8icX9…       0 ['ko…  7.97e4
 6 Symba                               06S3fr7xEES7e3QPXh…       0 []     6.66e4
 7 Tommy “TBHits” Brown                06moEoVtCKweJmGYid…       0 []     5   e0
 8 m-flo loves Sik-K &amp; eill &amp; 向井太一 072YnMT5EniZhvDssX…       0 []     8.64e2
 9 Sebastian Yatra                     07YUOmWljBTXwIseAU…       0 ['co…  2.15e7
10 Jason Derulo                        07YZf4WDAMNwqr4jfg…       0 ['da…  1.18e7
# … with 952 more rows, and abbreviated variable names ¹​top_kpop, ²​followers</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>artists <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 962 × 2
   id                         n
   &lt;chr&gt;                  &lt;int&gt;
 1 04BxwccHO4U2wMwVLvYTLO     1
 2 04C0MPapc1HXpTbspJhmWg     1
 3 04JxNGSux7QdmrCvnQowyr     1
 4 04L3elxyr0XFua2Ek3domW     1
 5 04xEkodoWyFji8icX911jM     1
 6 06moEoVtCKweJmGYid8vU7     1
 7 06S3fr7xEES7e3QPXhu3ay     1
 8 072YnMT5EniZhvDssXL2VB     1
 9 07YUOmWljBTXwIseAUd9TW     1
10 07YZf4WDAMNwqr4jfgOZ8y     1
# … with 952 more rows</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean data by removing unnecessary columns</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>artists <span class="ot">&lt;-</span> artists <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(id, <span class="at">.before =</span> name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is the list of the genre names that appear in artist dataframe</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>artists <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(genre) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(genre, <span class="at">sep =</span> <span class="st">",</span><span class="sc">\\</span><span class="st">s*"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">genre =</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">[|'|</span><span class="sc">\\</span><span class="st">]"</span>, <span class="st">""</span>, genre)) <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(genre) <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(genre)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 230 × 2
   genre                                 n
   &lt;chr&gt;                             &lt;int&gt;
 1 ""                                  353
 2 "a cappella"                          1
 3 "afrobeats"                           1
 4 "alt z"                               5
 5 "alternative r&amp;b"                     2
 6 "american 21st century classical"     1
 7 "anime"                               1
 8 "art pop"                             3
 9 "asian american hip hop"              5
10 "atl hip hop"                         4
# … with 220 more rows</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>artists <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">str_detect</span>(genre, <span class="st">"desi pop"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  id                     name         top_kpop genre                     follo…¹
  &lt;chr&gt;                  &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;                       &lt;dbl&gt;
1 4IKVDbCSBTxBeAsMKjAuTs Armaan Malik        0 ['desi pop', 'filmi', 'm…  1.79e7
# … with abbreviated variable name ¹​followers</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>artists <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">str_detect</span>(genre, <span class="st">"j-|japanese|josei"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  id                     name         top_kpop genre                     follo…¹
  &lt;chr&gt;                  &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;                       &lt;dbl&gt;
1 1qM11R4ylJyQiPJ0DffE9z Lilas Ikuta         0 ['j-pop', 'japanese teen…  4.30e5
2 2mGYHril2LuZodRtTX06BC Kumi Koda           0 ['j-pop']                  5.69e5
3 2oNStf3CKKLM5lnzELWMcH Taichi Mukai        0 ['japanese r&amp;b']           1.31e5
4 2vjeuQwzSP5ErC1S41gONX CHANMINA            0 ['j-rap', 'josei rap']     5.98e5
5 3AiES4wyTOfJvNgqz9baDn eill                0 ['anime', 'japanese r&amp;b']  1.17e5
6 3JsHnjpbhX4SnySpvpa9DK V                   1 ['j-division', 'korean o…  1.31e7
7 3yzQHdj9G34CVZ5rVUDrOM Crystal Kay         0 ['j-pop', 'japanese r&amp;b']  3.00e5
8 4UhiMIdxKqQxmzdE9nYe6O m-flo               0 ['j-pop']                  3.32e5
# … with abbreviated variable name ¹​followers</code></pre>
</div>
</div>
<p>I added two new columns to the <code>artist</code> dataFrame. The first column <code>region_genre</code>, which indicate the broader regional genre of each artist, such as K-pop, Latin-pop, or J-pop (Japanese pop), which would help us to better understand the overall geographical market. The second column would simply indicate whether each artist is K-pop or not.</p>
<p>First, I decided to classify the overall genre by detecting the follwoing word in the <code>genre</code> column</p>
<p><strong>K-pop:</strong> “korean”, “k-” (for example k-pop, k-rap). Also any artists whose column “top-kpop” is 1 are considered as K-pop genre.</p>
<p><strong>Latin-pop:</strong> “latin”, “latino”, “chicano”, “chileno”, “bachata”, “colombian”, “mexican”, “puerto rican”, “reggaeton”, “dominicano”</p>
<p><strong>East Asia:</strong> “japanese”, “j-” (for example j-pop, j-rap, j-core), “visual-kei”, “josei”, “kawaii”, “chinese<br>
,”c-“,”taiwan”</p>
<p><strong>South East Asia:</strong> “vietnamese”, “viet”, “v-pop”, “singaporean”, “desi pop”, “bollywood”, “indian”, “indonesian”, “malaysian”, “thai”, “burmese”</p>
<p><strong>Europe:</strong> “uk” (uk-pop, uk-hiphop), “norwegian”, “swedish”, “belgian”</p>
<p><strong>US or Others:</strong> artists whose genre doesn’t include the above words but has any word</p>
<p><strong>Unknown:</strong> artists whose genre is empty</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>artists <span class="sc">%&gt;%</span> <span class="fu">group_by_all</span>()<span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 5
# … with 5 variables: id &lt;chr&gt;, name &lt;chr&gt;, top_kpop &lt;dbl&gt;, genre &lt;chr&gt;,
#   followers &lt;dbl&gt;</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>artists <span class="ot">&lt;-</span> artists <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region_category=</span><span class="fu">case_when</span>(</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"k-|koreanp"</span>, genre) <span class="sc">|</span> top_kpop <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"K-pop"</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"latin|latino|chicano|chileno|bachata|colombian|mexican|puerto rican|reggaeton|dominicano"</span>, genre) <span class="sc">~</span> <span class="st">"Latino"</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"j-|japanese|visual-kei|josei|visualkawaii|chinese|c-|taiwan"</span>, genre) <span class="sc">~</span> <span class="st">"East Asia"</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"vietnamese|viet|v-|singaporean|desi pop|bollywood|indian |indonesian|malaysian|thai|burmese"</span>, genre) <span class="sc">~</span> <span class="st">"South East Asia"</span>,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"uk-|uk "</span>, genre) <span class="sc">~</span> <span class="st">"Europe"</span>,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">[</span><span class="sc">\\</span><span class="st">]"</span>, genre) <span class="sc">~</span> <span class="st">"Unknown"</span>,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"US or Other"</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>artists <span class="sc">%&gt;%</span> </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region_category) <span class="sc">%&gt;%</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
  region_category     n
  &lt;chr&gt;           &lt;int&gt;
1 East Asia          13
2 Europe             11
3 K-pop             319
4 Latino             11
5 South East Asia    11
6 Unknown           349
7 US or Other       248</code></pre>
</div>
</div>
<p>There are 349 artists whose genre is unknown. I checked them and changed <code>region_category</code> of some of them.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(artists <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(region_category <span class="sc">==</span> <span class="st">"Unknown"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(name)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 349 × 6
   id                     name               top_kpop genre followers region_c…¹
   &lt;chr&gt;                  &lt;chr&gt;                 &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;     
 1 23aPUZaR8bESXN4UD3T2Sx 香取慎吾                  0 []        20927 Unknown   
 2 2VrDFxXbEHomf7A8Q87uRA 朴宰範                    0 []           18 Unknown   
 3 7BrydByY8Q9MZjovkvRsCP 尹美萊                    0 []          150 Unknown   
 4 76yPSQzTmeCY5fCsrMFoSw 혜미                      0 []            2 Unknown   
 5 3lTYYNwaDmW0rrsAz5aG8o 헤리티지(Heritage)        0 []           37 Unknown   
 6 1WLp3CeL7X1Ic7DTu67CCP 한겨울                    0 []            0 Unknown   
 7 7fCSy7Had5Fs540ilzxV20 트리키                    0 []          103 Unknown   
 8 76JVW7YYK3nRTVvRxUalpI 토끼                      0 []            2 Unknown   
 9 6OK3Lf8Ws6A4UdRw3lMNZo 태완                      0 []           57 Unknown   
10 0BeIulKOpcvsabwlt4u8qp 태양                      0 []         8010 Unknown   
# … with 339 more rows, and abbreviated variable name ¹​region_category</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I noticed there were a few Japanese artists so I manually changed his region_category "East Asia"</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"香取慎吾"</span>] <span class="ot">&lt;-</span> <span class="st">"East Asia"</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Yutaka Furukawa"</span>] <span class="ot">&lt;-</span> <span class="st">"East Asia"</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Takanori Nishikawa T.M.Revolution"</span>] <span class="ot">&lt;-</span> <span class="st">"East Asia"</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Naoko Tanaka"</span>] <span class="ot">&lt;-</span> <span class="st">"East Asia"</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"m-flo loves Sik-K &amp; eill &amp; 向井太一"</span>] <span class="ot">&lt;-</span> <span class="st">"East Asia"</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Artists whose name include Hangul, I manually changed their region_category to "K-pop"</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>artists <span class="ot">&lt;-</span> artists <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(name)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(region_category) <span class="co"># row 371 - 404 are in Hangul</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[<span class="dv">371</span><span class="sc">:</span><span class="dv">404</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"nafla (나플라)"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"MC 몽"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(artists <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(region_category <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> followers <span class="sc">&gt;</span> <span class="dv">10000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(followers))) <span class="sc">%&gt;%</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"name"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 55 × 6
   id                     name        top_kpop genre followers region_category
   &lt;chr&gt;                  &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;          
 1 70DFixYAFPv4Pf9kgSfR9O MARK               0 []       509054 Unknown        
 2 7wFDo161xYdeaiLz3KIHoM Gallant            0 []       302064 Unknown        
 3 2FgZrgTMX6Sk0VNcOsEPmm Punch              0 []       301148 Unknown        
 4 7cEaNXXTHx3LokbjUUyHal BIG Naughty        0 []       286344 Unknown        
 5 31SBgHxc8eqZUk9MdveH42 PREP               0 []       254055 Unknown        
 6 0JOxt5QOwq0czoJxvSc5hS GASHI              0 []       235666 Unknown        
 7 2qDIR2WlcW3llkGqJWg9VJ Lolo Zouaï         0 []       210312 Unknown        
 8 79R17q4kiPsimHDtdOlN2L SEHUN              0 []       184818 Unknown        
 9 31IZdHrCZ5pRhLz4zBxN3o Riff Raff          0 []       179063 Unknown        
10 5C01hDqpEmrmDfUhX9YWsH FIFA Sound         0 []       167771 Unknown        
# … with 45 more rows</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 55 × 2
   id                     name       
   &lt;chr&gt;                  &lt;chr&gt;      
 1 70DFixYAFPv4Pf9kgSfR9O MARK       
 2 7wFDo161xYdeaiLz3KIHoM Gallant    
 3 2FgZrgTMX6Sk0VNcOsEPmm Punch      
 4 7cEaNXXTHx3LokbjUUyHal BIG Naughty
 5 31SBgHxc8eqZUk9MdveH42 PREP       
 6 0JOxt5QOwq0czoJxvSc5hS GASHI      
 7 2qDIR2WlcW3llkGqJWg9VJ Lolo Zouaï 
 8 79R17q4kiPsimHDtdOlN2L SEHUN      
 9 31IZdHrCZ5pRhLz4zBxN3o Riff Raff  
10 5C01hDqpEmrmDfUhX9YWsH FIFA Sound 
# … with 45 more rows</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I manually changed the region_categoroy for artists whose followers are over 15000 by checking the online information</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>id <span class="sc">==</span> <span class="st">"70DFixYAFPv4Pf9kgSfR9O"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Gallant"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Punch"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"BIG Naughty"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"PREP"</span>] <span class="ot">&lt;-</span> <span class="st">"Europe"</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"GASHI"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Lolo Zouaï"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"SEHUN"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Riff Raff"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"FIFA Sound"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"vaultboy"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"D_LITE"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Seraphine"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Wonstein"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"YooA"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Wuki"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"MINNIE"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Symba"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"HWANG MIN HYUN"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"T.O.P"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"End of the World"</span>] <span class="ot">&lt;-</span> <span class="st">"East Asia"</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"MELOH"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"LUCAS"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Paul Blanco"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"JEON WOONG"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Sion"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"KEN THE 390"</span>] <span class="ot">&lt;-</span> <span class="st">"East Asia"</span></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"BM"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Minhyun"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Yong Jun Hyung"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Lucas"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span> <span class="co"># I learned he is a Hong Kong rapper but is based in South Korea and is a member of Kpop group NCT.</span></span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Paniel"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"PANIEL"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"PENIEL"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"LIM YOUNG MIN"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"KIM DONG HYUN"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"D-LITE"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"LUNA"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"LEE DAE HWI"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"LEEGIKWANG"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"T.O.P."</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-56"><a href="#cb56-56" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Zior Park"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-57"><a href="#cb56-57" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Sandara Park"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-58"><a href="#cb56-58" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"U-KWON"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-59"><a href="#cb56-59" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"HOYA"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-60"><a href="#cb56-60" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Slom"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-61"><a href="#cb56-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-62"><a href="#cb56-62" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"TAEHYUN"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-63"><a href="#cb56-63" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"WOOSEOK"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-64"><a href="#cb56-64" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"ABLE"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-65"><a href="#cb56-65" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Imad Royal"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb56-66"><a href="#cb56-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-67"><a href="#cb56-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-68"><a href="#cb56-68" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"J.UNA"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-69"><a href="#cb56-69" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Yeeun"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-70"><a href="#cb56-70" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Reiley"</span>] <span class="ot">&lt;-</span> <span class="st">"Europe"</span></span>
<span id="cb56-71"><a href="#cb56-71" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"NARSHA"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-72"><a href="#cb56-72" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Son Dong Woon"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-73"><a href="#cb56-73" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"LEE CHANHYUK"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-74"><a href="#cb56-74" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"The Chosen"</span>] <span class="ot">&lt;-</span> <span class="st">"Latino"</span></span>
<span id="cb56-75"><a href="#cb56-75" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"JeHwi"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb56-76"><a href="#cb56-76" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"inverness"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(artists <span class="sc">%&gt;%</span> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(region_category <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> <span class="fu">str_detect</span>(name,<span class="st">"</span><span class="sc">\\</span><span class="st">("</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 6
   id                     name                     top_k…¹ genre follo…² regio…³
   &lt;chr&gt;                  &lt;chr&gt;                      &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1 54JXhmpGDN8NdAIq44z4gt Young Jae (B.A.P)              0 []       4541 Unknown
 2 5bRCVFekTRnptEuJ0ZxTtf Yoon Han (Pop Pianist)         0 []          4 Unknown
 3 2KbOz7b91wiUpnv34Twd9f YOOK SUNGJAE (BTOB)            0 []        119 Unknown
 4 2oG0hcbCfRofbtKnuS1fWF Yeo-Eun (MelodyDay)            0 []         27 Unknown
 5 5KnPgqPc7aCvEfXrCs4QjV Yella Diamond) (Perform…       0 []          3 Unknown
 6 76EfJwRQeOeQ5aMh3FF7z4 Sanchez (of Phantom)           0 []         15 Unknown
 7 6KIjwPp994JQ2LJ8IBvZPc LEE MINHYUK (BTOB)             0 []        648 Unknown
 8 3LcvhSx1kL5VwaOHhAN1B5 Kwon Soonil(Urban Zakap…       0 []          4 Unknown
 9 0sSAFVekiDtX7PXDQvHnlK JONG UP (B.A.P)                0 []       5853 Unknown
10 1htPJUlogkZBjbKp86uuLF DAE HYUN (B.A.P)               0 []       6874 Unknown
11 3schR1HLbYu3RqqPDiDFrE ANYUJIN (IVE)                  0 []       1924 Unknown
# … with abbreviated variable names ¹​top_kpop, ²​followers, ³​region_category</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Some artists are from a group where he/she belongs to</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[<span class="fu">str_detect</span>(artists<span class="sc">$</span>name, <span class="st">"B.A.P"</span>)] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[<span class="fu">str_detect</span>(artists<span class="sc">$</span>name, <span class="st">"BTOB"</span>)] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[<span class="fu">str_detect</span>(artists<span class="sc">$</span>name, <span class="st">"MelodyDay"</span>)] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[<span class="fu">str_detect</span>(artists<span class="sc">$</span>name, <span class="st">"Urban Zakapa"</span>)] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>artists <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region_category <span class="sc">==</span> <span class="st">"Unknown"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(name, <span class="st">"of"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"name"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  id                     name                     
  &lt;chr&gt;                  &lt;chr&gt;                    
1 4TYswX6bKUjM9rbEL7CMBH YEJI &amp; RYUJIN of ITZY    
2 76EfJwRQeOeQ5aMh3FF7z4 Sanchez (of Phantom)     
3 40zyx4iztMjRbIIoI802r4 Felix of Stray Kids      
4 5Fa7oN67rqbrgxbRVux7F4 CHOI JUNG HOON of JANNABI
5 4nzWj1u4IslWFr3B5f7HfY Ahin of MOMOLAND         </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Some artists are from a group where he/she belongs to</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[<span class="fu">str_detect</span>(artists<span class="sc">$</span>name, <span class="st">"ITZY"</span>)] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[<span class="fu">str_detect</span>(artists<span class="sc">$</span>name, <span class="st">"Stray Kids"</span>)] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[<span class="fu">str_detect</span>(artists<span class="sc">$</span>name, <span class="st">"MOMOLAND"</span>)] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[<span class="fu">str_detect</span>(artists<span class="sc">$</span>name, <span class="st">"JANNABI"</span>)] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>artists <span class="ot">&lt;-</span> artists <span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">kpop =</span> <span class="fu">case_when</span>(</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    region_category <span class="sc">==</span> <span class="st">"K-pop"</span> <span class="sc">~</span> <span class="st">"yes"</span>,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"no"</span>),</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">show_kpop_top =</span> <span class="fu">case_when</span>(</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>      top_kpop <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> name,</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">""</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="song_detail-song_detail.csv" class="level3">
<h3 class="anchored" data-anchor-id="song_detail-song_detail.csv">song_detail (song_detail.csv)</h3>
<p><code>song_detail</code> is a dataframe where each observation is a collaboration song by K-pop top artists and other artists. While <code>collab_songs</code> provides the general information of the artists that worked on the song, this dataframe provides more detailed information about the songs themselves such as duration, track number, release date etc…</p>
<p>It has 1123 rows (collaboration songs), which is the same as the number of the rows of <code>collab_songs</code>, and 19 columns.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(song_detail)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    album             artists          available_markets   disc_number
 Length:1123        Length:1123        Length:1123        Min.   :1   
 Class :character   Class :character   Class :character   1st Qu.:1   
 Mode  :character   Mode  :character   Mode  :character   Median :1   
                                                          Mean   :1   
                                                          3rd Qu.:1   
                                                          Max.   :1   
  duration_ms      explicit       external_ids       external_urls     
 Min.   :  5889   Mode :logical   Length:1123        Length:1123       
 1st Qu.:192577   FALSE:1036      Class :character   Class :character  
 Median :211300   TRUE :87        Mode  :character   Mode  :character  
 Mean   :212247                                                        
 3rd Qu.:230346                                                        
 Max.   :459853                                                        
     href                id             is_local           name          
 Length:1123        Length:1123        Mode :logical   Length:1123       
 Class :character   Class :character   FALSE:1123      Class :character  
 Mode  :character   Mode  :character                   Mode  :character  
                                                                         
                                                                         
                                                                         
   popularity    preview_url         track_number        type          
 Min.   : 0.00   Length:1123        Min.   : 1.000   Length:1123       
 1st Qu.:17.00   Class :character   1st Qu.: 1.000   Class :character  
 Median :28.00   Mode  :character   Median : 1.000   Mode  :character  
 Mean   :29.02                      Mean   : 2.102                     
 3rd Qu.:40.00                      3rd Qu.: 3.000                     
 Max.   :86.00                      Max.   :11.000                     
     uri             release_date         release_year 
 Length:1123        Min.   :2001-12-19   Min.   :2001  
 Class :character   1st Qu.:2015-05-26   1st Qu.:2015  
 Mode  :character   Median :2018-03-08   Median :2018  
                    Mean   :2017-08-14   Mean   :2017  
                    3rd Qu.:2020-08-24   3rd Qu.:2020  
                    Max.   :2023-05-09   Max.   :2023  </code></pre>
</div>
</div>
<p>The necessary columns are as follows</p>
<ol type="1">
<li>id: This is a Spotify song id. Can be used as a key when joining with <code>collab_songs</code></li>
<li>name: name of the songs</li>
<li>popularity: the popularity index from Spotify</li>
<li>release_year:</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # I will remove unnecessary columns</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># song_detail &lt;- song_detail %&gt;% </span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(c("id", "name", "popularity", "release_year"))</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># song_detail$release_year &lt;- as.integer(song_detail$release_year)</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co"># song_detail %&gt;% arrange(release_year)</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ```</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Extra data cleaning</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="co"># `collab_songs` include unofficial songs by unofficial accounts. For example, there are a few songs by After School and Blackpink. However, if you look at the Spotify album page, this "Blackpink" is different from "BLACK PINK". There seem to be several cases that the artist ID is not the correct one. So I removed the songs that are not by "official" (=with more monthly followers) accounts.</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ```{r}</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="co"># # Remove the songs by artist_1 whose id doesn't exist</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="co"># collab_songs &lt;- collab_songs %&gt;%</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(artists, by = c("artist_id_1" = "id")) %&gt;%</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!is.na(name)) %&gt;%</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c("name", "top_kpop", "genre", "followers", "name_lower", "region_category", "kpop"))</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a><span class="co"># # Remove the songs by artist_2 whose id doesn't exist </span></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a><span class="co"># collab_songs &lt;- collab_songs %&gt;% </span></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(artists, by = c("artist_id_2" = "id")) %&gt;%</span></span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(is.na(artist_2)|!is.na(name)) %&gt;%</span></span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c("name", "top_kpop", "genre", "followers", "name_lower", "region_category", "kpop"))</span></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a><span class="co"># # Remove the songs by artist_3 whose id doesn't exist </span></span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a><span class="co"># collab_songs &lt;- collab_songs %&gt;% </span></span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(artists, by = c("artist_id_3" = "id")) %&gt;%</span></span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(is.na(artist_3)|!is.na(name)) %&gt;%</span></span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c("name", "top_kpop", "genre", "followers", "name_lower", "region_category", "kpop"))</span></span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a><span class="co"># # Remove the songs by artist_4 whose id doesn't exist </span></span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a><span class="co"># collab_songs &lt;- collab_songs %&gt;% </span></span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(artists, by = c("artist_id_4" = "id")) %&gt;%</span></span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(is.na(artist_4)|!is.na(name)) %&gt;%</span></span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c("name", "top_kpop", "genre", "followers", "name_lower", "region_category", "kpop"))</span></span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a><span class="co"># # Remove the songs by artist_5 whose id doesn't exist </span></span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a><span class="co"># collab_songs &lt;- collab_songs %&gt;% </span></span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(artists, by = c("artist_id_5" = "id")) %&gt;%</span></span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(is.na(artist_5)|!is.na(name)) %&gt;%</span></span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c("name", "top_kpop", "genre", "followers", "name_lower", "region_category", "kpop"))</span></span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a><span class="co"># # Remove the songs by artist_6 whose id doesn't exist </span></span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a><span class="co"># collab_songs &lt;- collab_songs %&gt;% </span></span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(artists, by = c("artist_id_6" = "id")) %&gt;%</span></span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(is.na(artist_6)|!is.na(name)) %&gt;%</span></span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c("name", "top_kpop", "genre", "followers", "name_lower", "region_category", "kpop"))</span></span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a><span class="co"># # Remove the songs by artist_7 whose id doesn't exist </span></span>
<span id="cb66-53"><a href="#cb66-53" aria-hidden="true" tabindex="-1"></a><span class="co"># collab_songs &lt;- collab_songs %&gt;% </span></span>
<span id="cb66-54"><a href="#cb66-54" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(artists, by = c("artist_id_7" = "id")) %&gt;%</span></span>
<span id="cb66-55"><a href="#cb66-55" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(is.na(artist_7)|!is.na(name)) %&gt;%</span></span>
<span id="cb66-56"><a href="#cb66-56" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c("name", "top_kpop", "genre", "followers", "name_lower", "region_category", "kpop"))</span></span>
<span id="cb66-57"><a href="#cb66-57" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb66-58"><a href="#cb66-58" aria-hidden="true" tabindex="-1"></a><span class="co"># collab_songs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="exploratory-data-analysis" class="level1">
<h1>Exploratory Data Analysis</h1>
<section id="how-many-k-pop-collaboration-songs-are-released-by-year" class="level3">
<h3 class="anchored" data-anchor-id="how-many-k-pop-collaboration-songs-are-released-by-year">How many K-pop collaboration songs are released by year?</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>collab_songs <span class="sc">%&gt;%</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(song_detail, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"song_id"</span><span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>release_year)) <span class="sc">+</span> </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2010</span>, <span class="dv">2022</span>, <span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">2000</span>, <span class="dv">2023</span>) <span class="sc">+</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"The number of K-pop collaboration songs"</span>, <span class="at">subtitle =</span> <span class="st">"The number of collaboration songs by K-pop top artists is increasing over the time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for 'x' is already present. Adding another scale for 'x', which will
replace the existing scale.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (geom_bar).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Kpop_network_Erika_Nagai_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="is-the-popularity-of-k-pop-collaboration-songs-increasing" class="level3">
<h3 class="anchored" data-anchor-id="is-the-popularity-of-k-pop-collaboration-songs-increasing">Is the popularity of K-pop collaboration songs increasing?</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>song_detail <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(release_year) <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_popularity =</span> <span class="fu">mean</span>(popularity)) <span class="sc">%&gt;%</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>release_year, <span class="at">y=</span>mean_popularity)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Popularity of K-pop collaboration songs"</span>, <span class="at">subtitle =</span> <span class="st">"The popularity of K-pop collaboration songs is increasing constantly since around 2009"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Kpop_network_Erika_Nagai_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="the-popularity-of-k-pop-artists" class="level2">
<h2 class="anchored" data-anchor-id="the-popularity-of-k-pop-artists">The popularity of K-pop artists</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>artists <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region_category<span class="sc">==</span><span class="st">"K-pop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>followers)) <span class="sc">+</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Kpop_network_Erika_Nagai_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>artists <span class="sc">%&gt;%</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(region_category <span class="sc">==</span> <span class="st">"K-pop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(followers)) <span class="sc">%&gt;%</span> </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"followers"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 403 × 2
   name       followers
   &lt;chr&gt;          &lt;dbl&gt;
 1 BTS         64752045
 2 BLACKPINK   40782301
 3 TWICE       17544057
 4 j-hope      14644327
 5 RM          13576102
 6 V           13096788
 7 Agust D     11679645
 8 Stray Kids  11204838
 9 SEVENTEEN    9155169
10 Red Velvet   8364750
# … with 393 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="data-processing" class="level1">
<h1>Data Processing</h1>
<section id="convert-the-data-in-an-edgelist-format" class="level2">
<h2 class="anchored" data-anchor-id="convert-the-data-in-an-edgelist-format">Convert the data in an edgelist format</h2>
<p>To analyze this data in a perspective of social network, I need to convert this data into an edgelist where from_nodes are K-pop top artists, to_nodes are artists who collaborated with them, and edges are songs.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert collab_songs to edgelist</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>edgelist <span class="ot">&lt;-</span> collab_songs <span class="sc">%&gt;%</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"artist_id_"</span>),</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"variable"</span>,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"to_artist_id"</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">%&gt;%</span> </span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(to_artist_id)) <span class="sc">%&gt;%</span> <span class="co"># Remove the rows where the to_artist_id is blank </span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(artist_id <span class="sc">!=</span> to_artist_id) <span class="sc">%&gt;%</span>  <span class="co"># Remove the rows where from_artist and to_artist are the same </span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"artist_id"</span>, <span class="st">"to_artist_id"</span>, <span class="st">"song_id"</span>, <span class="st">"song_name"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(artists, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"artist_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"artist_id"</span>, <span class="st">"to_artist_id"</span>, <span class="st">"song_id"</span>, <span class="st">"song_name"</span>, <span class="st">"name"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(artists, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to_artist_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"artist_id"</span>, <span class="st">"to_artist_id"</span>, <span class="st">"song_id"</span>, <span class="st">"song_name"</span>, <span class="st">"name.x"</span>, <span class="st">"name.y"</span>, <span class="st">"region_category"</span>))</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the name of columns</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(edgelist) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"From"</span>, <span class="st">"To"</span>, <span class="st">"song_id"</span>, <span class="st">"song_name"</span>, <span class="st">"From_artists"</span>, <span class="st">"To_artists"</span>, <span class="st">"Collab_region1"</span>)</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Add new columns of collaboration types</span></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>edgelist <span class="ot">&lt;-</span> edgelist <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">Collab_region2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>    Collab_region1 <span class="sc">==</span> <span class="st">"K-pop"</span> <span class="sc">~</span> <span class="st">"Domestic/Unknown"</span>,</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"International"</span></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column of release year</span></span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>edgelist <span class="ot">&lt;-</span> edgelist <span class="sc">%&gt;%</span> </span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(song_detail, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"song_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"From"</span>, <span class="st">"To"</span>, <span class="st">"song_id"</span>, <span class="st">"song_name"</span>, <span class="st">"From_artists"</span>, <span class="st">"To_artists"</span>, <span class="st">"Collab_region1"</span>, <span class="st">"Collab_region2"</span>, <span class="st">"release_year"</span>, <span class="st">"popularity"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert edgelist into a graph</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>collab.net <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_data_frame</span>(edgelist, <span class="at">directed =</span> <span class="cn">FALSE</span>, <span class="at">vertices =</span> artists)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting the attributes</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # For visualization</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ## color</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>artists <span class="ot">&lt;-</span> artists <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">color_region_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>    region_category <span class="sc">==</span> <span class="st">"K-pop"</span> <span class="sc">~</span> <span class="st">"#FFFFE1"</span>,</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>    region_category <span class="sc">==</span> <span class="st">"Latin"</span> <span class="sc">~</span> <span class="st">"darkgreen"</span>,</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>    region_category <span class="sc">==</span> <span class="st">"South East Asia"</span> <span class="sc">~</span> <span class="st">"#FDCCCC"</span>,</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>    region_category <span class="sc">==</span> <span class="st">"East Asia"</span> <span class="sc">~</span> <span class="st">"#920002"</span>,</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>    region_category <span class="sc">==</span> <span class="st">"Europe"</span> <span class="sc">~</span> <span class="st">"#ABD7E6"</span>,</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>    region_category <span class="sc">==</span> <span class="st">"US or Other"</span> <span class="sc">~</span> <span class="st">"deepskyblue3"</span>,</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"darkgrey"</span> ),</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">color_kpop =</span> <span class="fu">case_when</span>(</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>    kpop <span class="sc">==</span> <span class="st">"yes"</span> <span class="sc">~</span> <span class="st">"#FFFFE1"</span>,</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"#010087"</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(collab.net)<span class="sc">$</span>color <span class="ot">&lt;-</span> artists<span class="sc">$</span>color_region_category</span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a><span class="co"># V(collab.net)$name_kpop_top &lt;- artists$show_name_kpop_top</span></span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a><span class="co"># V(collab.net)$name_followers &lt;- artists$show_name_followers</span></span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a><span class="co">#edgelist &lt;- edgelist %&gt;% left_join(song_detail, by = c("song_id"="id"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This graph contains 1519 edges (collaboration songs) by 962 artists in the last 20 years.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check attributes</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(collab.net) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>IGRAPH 938b92c UN-- 962 1519 -- 
+ attr: name (v/c), top_kpop (v/n), genre (v/c), followers (v/n),
| region_category (v/c), kpop (v/c), show_kpop_top (v/c), color (v/c),
| song_id (e/c), song_name (e/c), From_artists (e/c), To_artists (e/c),
| Collab_region1 (e/c), Collab_region2 (e/c), release_year (e/n),
| popularity (e/n)</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">vertex_attr_names</span>(collab.net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "name"            "top_kpop"        "genre"           "followers"      
[5] "region_category" "kpop"            "show_kpop_top"   "color"          </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">edge_attr_names</span>(collab.net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "song_id"        "song_name"      "From_artists"   "To_artists"    
[5] "Collab_region1" "Collab_region2" "release_year"   "popularity"    </code></pre>
</div>
</div>
</section>
</section>
<section id="total-overview-of-k-pop-collaboration-network" class="level1">
<h1>(Total) Overview of K-pop collaboration network</h1>
<p>This is the graph of the last 20 years’ K-pop collaboration.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(collab.net,</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label =</span> <span class="cn">NA</span>,</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">arrow.mode=</span><span class="st">"-"</span>,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size =</span> <span class="fu">log</span>(<span class="fu">V</span>(collab.net)<span class="sc">$</span>followers) <span class="sc">*</span> <span class="fl">0.4</span>,</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.cex =</span> .<span class="dv">4</span>,</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.color =</span> <span class="st">"black"</span>,</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.frame.color =</span> <span class="st">'lightgrey'</span>,</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.dist =</span> <span class="dv">0</span>,</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">frame.width =</span> <span class="dv">0</span>,</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">color =</span> <span class="fu">V</span>(collab.net)<span class="sc">$</span>color_region_category,</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"K pop collaboration network for the last 20 years"</span>,</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ref =</span> <span class="st">"The size of the circles means the popularity"</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"bottomright"</span>,</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"K-pop"</span>, <span class="st">"Latin"</span>, <span class="st">"East Asia"</span>, <span class="st">"South East Asia"</span>, <span class="st">"Europe"</span>, <span class="st">"US or Other"</span>, <span class="st">"Unknown"</span>),</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">pt.bg  =</span> <span class="fu">c</span>(<span class="st">"#FFFFE1"</span>, <span class="st">"darkgreen"</span>, <span class="st">"#920002"</span>,<span class="st">"#FDCCCC"</span>, <span class="st">"#ABD7E6"</span>, <span class="st">"deepskyblue3"</span>, <span class="st">"darkgrey"</span>),</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch    =</span> <span class="dv">21</span>,</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex    =</span> <span class="dv">1</span>,</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">bty    =</span> <span class="st">"n"</span>,</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">title  =</span> <span class="st">"Genre"</span></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Kpop_network_Erika_Nagai_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="network-overview" class="level1">
<h1>Network overview</h1>
<section id="nodes-and-edges" class="level2">
<h2 class="anchored" data-anchor-id="nodes-and-edges">Nodes and Edges</h2>
<p>As mentioned, this network consists of 962 nodes (artists) and 1519 edges. The number of edges and the number of songs are not the same because one song can have more than 2 artists.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">vcount</span>(collab.net))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 962</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">ecount</span>(collab.net))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1519</code></pre>
</div>
</div>
</section>
<section id="density-and-transitivity" class="level2">
<h2 class="anchored" data-anchor-id="density-and-transitivity">Density and transitivity</h2>
<p>Density and transitivity of K-pop collaboration network is not high.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Density</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">edge_density</span>(collab.net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.003286165</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transitivity</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">transitivity</span>(collab.net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02449146</code></pre>
</div>
</div>
</section>
<section id="degree" class="level2">
<h2 class="anchored" data-anchor-id="degree">Degree</h2>
<p>This is analysis on nodes.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">V</span>(collab.net)<span class="sc">$</span>name,</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">total.degree =</span> <span class="fu">degree</span>(collab.net, <span class="at">mode =</span> <span class="st">'total'</span>),</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">eigen.centrality =</span> <span class="fu">evcent</span>(collab.net)<span class="sc">$</span>vector)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'reshape2'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tidyr':

    smiths</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="sc">%&gt;%</span> melt <span class="sc">%&gt;%</span> </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> variable, <span class="at">color =</span> variable)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">alpha =</span> .<span class="dv">2</span>, <span class="at">bw =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Degree Distribution'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Using name as id variables</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Kpop_network_Erika_Nagai_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="dyad-census" class="level2">
<h2 class="anchored" data-anchor-id="dyad-census">Dyad Census</h2>
<p>It is expected that there is no asymmetry dyad because collaboration network is NOT directed. There are quite many null dyads, meaning that there are many artists that don’t work together.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dyad.census</span>(collab.net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$mut
[1] 1199

$asym
[1] 0

$null
[1] 461042</code></pre>
</div>
</div>
</section>
<section id="triad-census" class="level2">
<h2 class="anchored" data-anchor-id="triad-census">Triad Census</h2>
<p>Most triads are empty because when artist A works with artist B, they don’t work with the same artists.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>triad.labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A,B,C, the empty graph."</span>,</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A-&gt;B, C, the graph with a single directed edge."</span>,</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A&lt;-&gt;B, C, the graph with a mutual connection between two vertices."</span>,</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A&lt;-B-&gt;C, the out-star."</span>,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A-&gt;B&lt;-C, the in-star."</span>,</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A-&gt;B-&gt;C, directed line."</span>,<span class="st">"A&lt;-&gt;B&lt;-C."</span>,</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A&lt;-&gt;B-&gt;C."</span>,</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A-&gt;B&lt;-C, A-&gt;C."</span>,</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A&lt;-B&lt;-C, A-&gt;C."</span>,</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A&lt;-&gt;B&lt;-&gt;C."</span>,</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A&lt;-B-&gt;C, A&lt;-&gt;C."</span>,</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A-&gt;B&lt;-C, A&lt;-&gt;C."</span>,</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A-&gt;B-&gt;C, A&lt;-&gt;C."</span>,</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A-&gt;B&lt;-&gt;C, A&lt;-&gt;C."</span>,</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A&lt;-&gt;B&lt;-&gt;C, A&lt;-&gt;C, the complete graph."</span>)</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>triad.census.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">label =</span> triad.labels, <span class="at">collab.net =</span> <span class="fu">triad.census</span>(collab.net)) <span class="sc">%&gt;%</span> melt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in triad.census(collab.net): At core/misc/motifs.c:1165 : Triad census
called on an undirected graph.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using label as id variables</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(triad.census.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'triad'</span>, <span class="st">'network'</span>, <span class="st">'value'</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>triad.census.data <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> triad, <span class="at">fill =</span> network)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>, <span class="at">position =</span> <span class="st">'dodge'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Kpop_network_Erika_Nagai_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="transitivity" class="level2">
<h2 class="anchored" data-anchor-id="transitivity">Transitivity</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>nodes<span class="sc">$</span>transitivity <span class="ot">&lt;-</span> <span class="fu">transitivity</span>(collab.net, <span class="at">type =</span> <span class="st">'local'</span>)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">melt</span>(nodes) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">'transitivity'</span> <span class="sc">|</span> variable <span class="sc">==</span> <span class="st">'weighted.transitivity'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> variable, <span class="at">color =</span> variable)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Transitivity Distribution'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Using name as id variables</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 688 rows containing non-finite values (stat_density).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Kpop_network_Erika_Nagai_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="component-structure" class="level2">
<h2 class="anchored" data-anchor-id="component-structure">Component Structure</h2>
<p>There are more than 110 components in this network. Most of them have members less than 25.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>wc.collab.net <span class="ot">&lt;-</span> <span class="fu">cluster_walktrap</span>(collab.net)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>member <span class="ot">&lt;-</span> <span class="fu">membership</span>(wc.collab.net)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>nodes<span class="sc">$</span>member <span class="ot">&lt;-</span> member</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(member) <span class="sc">%&gt;%</span> melt <span class="sc">%&gt;%</span> ggplot <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(member, <span class="sc">-</span> value), <span class="at">y =</span> value, <span class="at">fill =</span> <span class="fu">factor</span>(member)), <span class="at">stat =</span> <span class="st">'identity'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Kpop_network_Erika_Nagai_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="closer-look" class="level1">
<h1>Closer look</h1>
<p>Since the graph of 20 years doesn’t give information about how K-pop collaboration has evolved so I analyzed the graph by year. There are few collaboration songs before 2005, so from here I will limit my analysis to the time span from 2005 till present (as of May 17, 2023).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a graph for each year</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>graph_from_data_frame_with_all_vertices <span class="ot">&lt;-</span> <span class="cf">function</span>(df, vertices) {</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with all possible edges between vertices</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>  unique_vertices <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(df<span class="sc">$</span>From, df<span class="sc">$</span>To))</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>  artists_period <span class="ot">&lt;-</span> artists[artists<span class="sc">$</span>id <span class="sc">%in%</span> unique_vertices, ]</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the graph with all vertices and existing edges</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>  graph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(df, <span class="at">directed =</span> <span class="cn">FALSE</span>, <span class="at">vertices =</span> artists_period)</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(graph)</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>graphs_year <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>, <span class="cf">function</span>(x) <span class="fu">graph_from_data_frame_with_all_vertices</span>(<span class="at">df =</span> edgelist[edgelist<span class="sc">$</span>release_year <span class="sc">==</span> x, ], <span class="at">vertices =</span> artists))</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>periods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>)</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:length(graphs_year)) {</span></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   V(graphs_year[[i]])$color &lt;- V(graphs_year[[i]])$color_region_category</span></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot(graphs_year[[i]], </span></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.label = V(graphs_year[[i]])$show_kpop_top,</span></span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a><span class="co">#      arrow.mode="-",</span></span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.size = log(V(graphs_year[[i]])$followers) * 0.7,</span></span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.label.cex = .8,</span></span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.label.color = "black",</span></span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.label.dist = 0,</span></span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a><span class="co">#      frame.width = 0,</span></span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a><span class="co">#      color = V(graphs_year[[i]])$color_region_category,</span></span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a><span class="co">#      main = paste0("Collaboration by K-pop top artists ", periods[[i]])</span></span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a><span class="co">#      )</span></span>
<span id="cb108-30"><a href="#cb108-30" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb108-31"><a href="#cb108-31" aria-hidden="true" tabindex="-1"></a><span class="co">#   legend(</span></span>
<span id="cb108-32"><a href="#cb108-32" aria-hidden="true" tabindex="-1"></a><span class="co">#     "bottomright",</span></span>
<span id="cb108-33"><a href="#cb108-33" aria-hidden="true" tabindex="-1"></a><span class="co">#     legend = c("K-pop", "Latin", "East Asia", "South East Asia", "Europe", "US or Other", "Unknown"),</span></span>
<span id="cb108-34"><a href="#cb108-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     pt.bg  = c("#FFFFE1", "darkgreen", "#920002","#FDCCCC", "#ABD7E6", "#010087", "darkgrey"),</span></span>
<span id="cb108-35"><a href="#cb108-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     pch    = 21,</span></span>
<span id="cb108-36"><a href="#cb108-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     cex    = 1,</span></span>
<span id="cb108-37"><a href="#cb108-37" aria-hidden="true" tabindex="-1"></a><span class="co">#     bty    = "n",</span></span>
<span id="cb108-38"><a href="#cb108-38" aria-hidden="true" tabindex="-1"></a><span class="co">#     title  = "Genre"</span></span>
<span id="cb108-39"><a href="#cb108-39" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb108-40"><a href="#cb108-40" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb108-41"><a href="#cb108-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-42"><a href="#cb108-42" aria-hidden="true" tabindex="-1"></a>graph_stats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>, </span>
<span id="cb108-43"><a href="#cb108-43" aria-hidden="true" tabindex="-1"></a>                          <span class="at">num_nodes =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>)), </span>
<span id="cb108-44"><a href="#cb108-44" aria-hidden="true" tabindex="-1"></a>                          <span class="at">num_edges =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>)), </span>
<span id="cb108-45"><a href="#cb108-45" aria-hidden="true" tabindex="-1"></a>                          <span class="at">num_songs =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>)),</span>
<span id="cb108-46"><a href="#cb108-46" aria-hidden="true" tabindex="-1"></a>                          <span class="at">artists_per_song =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>)),</span>
<span id="cb108-47"><a href="#cb108-47" aria-hidden="true" tabindex="-1"></a>                          <span class="at">centralization =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>)), </span>
<span id="cb108-48"><a href="#cb108-48" aria-hidden="true" tabindex="-1"></a>                          <span class="at">density =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>)), </span>
<span id="cb108-49"><a href="#cb108-49" aria-hidden="true" tabindex="-1"></a>                          <span class="at">transitivity =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>))</span>
<span id="cb108-50"><a href="#cb108-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb108-51"><a href="#cb108-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-52"><a href="#cb108-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each year and calculate the desired graph statistics</span></span>
<span id="cb108-53"><a href="#cb108-53" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(graphs_year)) {</span>
<span id="cb108-54"><a href="#cb108-54" aria-hidden="true" tabindex="-1"></a>  graph <span class="ot">&lt;-</span> graphs_year[[i]]</span>
<span id="cb108-55"><a href="#cb108-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-56"><a href="#cb108-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fill in the corresponding row of the data frame with the calculated statistics</span></span>
<span id="cb108-57"><a href="#cb108-57" aria-hidden="true" tabindex="-1"></a>  graph_stats[i, <span class="st">"num_nodes"</span>] <span class="ot">&lt;-</span> <span class="fu">vcount</span>(graph)</span>
<span id="cb108-58"><a href="#cb108-58" aria-hidden="true" tabindex="-1"></a>  graph_stats[i, <span class="st">"num_edges"</span>] <span class="ot">&lt;-</span> <span class="fu">ecount</span>(graph)</span>
<span id="cb108-59"><a href="#cb108-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-60"><a href="#cb108-60" aria-hidden="true" tabindex="-1"></a>  song_ids <span class="ot">&lt;-</span> <span class="fu">E</span>(graph)<span class="sc">$</span>song_id</span>
<span id="cb108-61"><a href="#cb108-61" aria-hidden="true" tabindex="-1"></a>  num_unique_songs <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(song_ids))</span>
<span id="cb108-62"><a href="#cb108-62" aria-hidden="true" tabindex="-1"></a>  graph_stats[i, <span class="st">"num_songs"</span>] <span class="ot">&lt;-</span> num_unique_songs</span>
<span id="cb108-63"><a href="#cb108-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-64"><a href="#cb108-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-65"><a href="#cb108-65" aria-hidden="true" tabindex="-1"></a>  graph_stats[i, <span class="st">"centralization"</span>] <span class="ot">&lt;-</span> <span class="fu">centr_degree</span>(graph)<span class="sc">$</span>centralization</span>
<span id="cb108-66"><a href="#cb108-66" aria-hidden="true" tabindex="-1"></a>  graph_stats[i, <span class="st">"density"</span>] <span class="ot">&lt;-</span> <span class="fu">graph.density</span>(graph)</span>
<span id="cb108-67"><a href="#cb108-67" aria-hidden="true" tabindex="-1"></a>  graph_stats[i, <span class="st">"transitivity"</span>] <span class="ot">&lt;-</span> <span class="fu">transitivity</span>(graph, <span class="at">type =</span> <span class="st">'global'</span>)</span>
<span id="cb108-68"><a href="#cb108-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-69"><a href="#cb108-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-70"><a href="#cb108-70" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb108-71"><a href="#cb108-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-72"><a href="#cb108-72" aria-hidden="true" tabindex="-1"></a>collab_by_years <span class="ot">&lt;-</span> edgelist <span class="sc">%&gt;%</span></span>
<span id="cb108-73"><a href="#cb108-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(release_year) <span class="sc">%&gt;%</span></span>
<span id="cb108-74"><a href="#cb108-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb108-75"><a href="#cb108-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">popularity =</span> <span class="fu">mean</span>(popularity),</span>
<span id="cb108-76"><a href="#cb108-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">K_Pop =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"K-pop"</span>),</span>
<span id="cb108-77"><a href="#cb108-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">US_Other =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"US or Other"</span>),</span>
<span id="cb108-78"><a href="#cb108-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">E_Asia =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"East Asia"</span>),</span>
<span id="cb108-79"><a href="#cb108-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE_Asia =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"South East Asia"</span>),</span>
<span id="cb108-80"><a href="#cb108-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">Latino =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"Latino"</span>),</span>
<span id="cb108-81"><a href="#cb108-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">Europe =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"Europe"</span>),</span>
<span id="cb108-82"><a href="#cb108-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">Unknown =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"Unknown"</span>)</span>
<span id="cb108-83"><a href="#cb108-83" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb108-84"><a href="#cb108-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-85"><a href="#cb108-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-86"><a href="#cb108-86" aria-hidden="true" tabindex="-1"></a>graph_stats <span class="ot">&lt;-</span> graph_stats <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(collab_by_years, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"year"</span> <span class="ot">=</span> <span class="st">"release_year"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb108-87"><a href="#cb108-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">song_per_kpop_artists =</span> num_songs<span class="sc">/</span><span class="st">`</span><span class="at">K_Pop</span><span class="st">`</span>)</span>
<span id="cb108-88"><a href="#cb108-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-89"><a href="#cb108-89" aria-hidden="true" tabindex="-1"></a>graph_stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   year num_nodes num_edges num_songs artists_per_song centralization
1  2006         9         6         6                0     0.33333333
2  2007         4         2         2                0     0.00000000
3  2008        18        12         9                0     0.09803922
4  2009        34        35        25                0     0.18003565
5  2010        39        31        26                0     0.11605938
6  2011        53        50        32                0     0.13679245
7  2012        69        56        49                0     0.07907076
8  2013        71        53        42                0     0.06438632
9  2014        96        75        62                0     0.07828947
10 2015       128       120        88                0     0.16633858
11 2016       142       142       107                0     0.07801418
12 2017       133       120        96                0     0.12269310
13 2018       125       126        94                0     0.12083871
14 2019       154       166       121                0     0.28002716
15 2020       190       202       130                0     0.14747981
16 2021       154       132       101                0     0.04108310
17 2022       130       107        87                0     0.04925462
18 2023        94        78        40                0     0.32624113
      density transitivity popularity K_Pop US_Other E_Asia SE_Asia Latino
1  0.16666667   0.00000000   16.83333     4        2      0       0      0
2  0.33333333          NaN   10.00000     0        0      1       0      0
3  0.07843137   0.00000000   12.58333     4        4      0       0      0
4  0.06238859   0.00000000   17.74286    14        5      1       0      0
5  0.04183536   0.00000000   18.58065    19        4      0       0      0
6  0.03628447   0.00000000   17.38000    26        6      0       0      0
7  0.02387042   0.00000000   21.44643    28       12      1       0      0
8  0.02132797   0.00000000   19.01887    29        8      0       0      0
9  0.01644737   0.02654867   23.40000    50        7      0       0      0
10 0.01476378   0.01929260   23.28333    72       17      0       0      0
11 0.01418440   0.03114187   26.70423    90       26      2       0      0
12 0.01367054   0.02158273   30.47500    64       34      3       0      0
13 0.01625806   0.03191489   28.69841    56       40      3       1      4
14 0.01409048   0.01601423   31.20482    82       55      0       2      3
15 0.01125035   0.00000000   32.79208    93       54     19       5      0
16 0.01120448   0.00000000   37.82576    41       58      4       3      3
17 0.01276088   0.02238806   39.60748    34       51      4       1      1
18 0.01784489   0.00000000   46.20513    31       17      1       1      3
   Europe Unknown song_per_kpop_artists
1       0       0              1.500000
2       0       1                   Inf
3       0       4              2.250000
4       0      15              1.785714
5       0       8              1.368421
6       0      18              1.230769
7       0      15              1.750000
8       0      16              1.448276
9       0      18              1.240000
10      0      31              1.222222
11      0      24              1.188889
12      1      18              1.500000
13      2      20              1.678571
14      5      19              1.475610
15      2      29              1.397849
16      2      21              2.463415
17      2      14              2.558824
18      1      24              1.290323</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (3 years moving average range) Closer look: How does the network change every year</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a plot with a bar chart and a line chart</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>graph_stats <span class="sc">%&gt;%</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"K_Pop"</span>, <span class="st">"US_Other"</span>, <span class="st">"E_Asia"</span>, <span class="st">"SE_Asia"</span>, <span class="st">"Latino"</span>, <span class="st">"Europe"</span>, <span class="st">"Unknown"</span>), <span class="at">names_to =</span> <span class="st">"collab_region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">collab_region =</span> <span class="fu">factor</span>(collab_region, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"K_Pop"</span>, <span class="st">"US_Other"</span>, <span class="st">"E_Asia"</span>, <span class="st">"SE_Asia"</span>, <span class="st">"Latino"</span>, <span class="st">"Europe"</span>, <span class="st">"Unknown"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year)) <span class="sc">+</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> value, <span class="at">fill =</span> collab_region), <span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Number"</span>, <span class="at">x =</span> <span class="st">"year"</span>, <span class="at">title =</span> <span class="st">"The number of K-pop collaboration songs"</span>, <span class="at">sub =</span> <span class="st">"After around 2017 the number of international collaboration songs increased."</span>)  <span class="sc">+</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">" "</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"num_edges"</span> <span class="ot">=</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"Collab Region"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"K_Pop"</span> <span class="ot">=</span> <span class="st">"#FFFFE1"</span>, <span class="st">"Latino"</span> <span class="ot">=</span> <span class="st">"darkgreen"</span>, <span class="st">"E_Asia"</span> <span class="ot">=</span> <span class="st">"#920002"</span>,</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">"SE_Asia"</span> <span class="ot">=</span> <span class="st">"#FDCCCC"</span>, <span class="st">"Europe"</span> <span class="ot">=</span> <span class="st">"#ABD7E6"</span>, <span class="st">"US_Other"</span> <span class="ot">=</span> <span class="st">"#010087"</span>,</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">"Unknown"</span> <span class="ot">=</span> <span class="st">"darkgrey"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Kpop_network_Erika_Nagai_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>List of 93
 $ line                      :List of 6
  ..$ colour       : chr "black"
  ..$ size         : num 0.5
  ..$ linetype     : num 1
  ..$ lineend      : chr "butt"
  ..$ arrow        : logi FALSE
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_line" "element"
 $ rect                      :List of 5
  ..$ fill         : chr "white"
  ..$ colour       : chr "black"
  ..$ size         : num 0.5
  ..$ linetype     : num 1
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_rect" "element"
 $ text                      :List of 11
  ..$ family       : chr ""
  ..$ face         : chr "plain"
  ..$ colour       : chr "black"
  ..$ size         : num 11
  ..$ hjust        : num 0.5
  ..$ vjust        : num 0.5
  ..$ angle        : num 0
  ..$ lineheight   : num 0.9
  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : logi FALSE
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ title                     : NULL
 $ aspect.ratio              : NULL
 $ axis.title                : NULL
 $ axis.title.x              :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 1
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 2.75points 0points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.title.x.top          :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 0
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 0points 2.75points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.title.x.bottom       : NULL
 $ axis.title.y              :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 1
  ..$ angle        : num 90
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 2.75points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.title.y.left         : NULL
 $ axis.title.y.right        :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 0
  ..$ angle        : num -90
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 2.75points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text                 :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : chr "grey30"
  ..$ size         : 'rel' num 0.8
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.x               :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 1
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 2.2points 0points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.x.top           :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 0
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 0points 2.2points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.x.bottom        : NULL
 $ axis.text.y               :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : num 1
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 2.2points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.y.left          : NULL
 $ axis.text.y.right         :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : num 0
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 2.2points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.ticks                :List of 6
  ..$ colour       : chr "grey20"
  ..$ size         : NULL
  ..$ linetype     : NULL
  ..$ lineend      : NULL
  ..$ arrow        : logi FALSE
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_line" "element"
 $ axis.ticks.x              : NULL
 $ axis.ticks.x.top          : NULL
 $ axis.ticks.x.bottom       : NULL
 $ axis.ticks.y              : NULL
 $ axis.ticks.y.left         : NULL
 $ axis.ticks.y.right        : NULL
 $ axis.ticks.length         : 'simpleUnit' num 2.75points
  ..- attr(*, "unit")= int 8
 $ axis.ticks.length.x       : NULL
 $ axis.ticks.length.x.top   : NULL
 $ axis.ticks.length.x.bottom: NULL
 $ axis.ticks.length.y       : NULL
 $ axis.ticks.length.y.left  : NULL
 $ axis.ticks.length.y.right : NULL
 $ axis.line                 :List of 6
  ..$ colour       : chr "black"
  ..$ size         : 'rel' num 1
  ..$ linetype     : NULL
  ..$ lineend      : NULL
  ..$ arrow        : logi FALSE
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_line" "element"
 $ axis.line.x               : NULL
 $ axis.line.x.top           : NULL
 $ axis.line.x.bottom        : NULL
 $ axis.line.y               : NULL
 $ axis.line.y.left          : NULL
 $ axis.line.y.right         : NULL
 $ legend.background         :List of 5
  ..$ fill         : NULL
  ..$ colour       : logi NA
  ..$ size         : NULL
  ..$ linetype     : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_rect" "element"
 $ legend.margin             : 'margin' num [1:4] 5.5points 5.5points 5.5points 5.5points
  ..- attr(*, "unit")= int 8
 $ legend.spacing            : 'simpleUnit' num 11points
  ..- attr(*, "unit")= int 8
 $ legend.spacing.x          : NULL
 $ legend.spacing.y          : NULL
 $ legend.key                : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ legend.key.size           : 'simpleUnit' num 1.2lines
  ..- attr(*, "unit")= int 3
 $ legend.key.height         : NULL
 $ legend.key.width          : NULL
 $ legend.text               :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : 'rel' num 0.8
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ legend.text.align         : NULL
 $ legend.title              :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : num 0
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ legend.title.align        : NULL
 $ legend.position           : chr "right"
 $ legend.direction          : NULL
 $ legend.justification      : chr "center"
 $ legend.box                : NULL
 $ legend.box.just           : NULL
 $ legend.box.margin         : 'margin' num [1:4] 0cm 0cm 0cm 0cm
  ..- attr(*, "unit")= int 1
 $ legend.box.background     : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ legend.box.spacing        : 'simpleUnit' num 11points
  ..- attr(*, "unit")= int 8
 $ panel.background          :List of 5
  ..$ fill         : chr "white"
  ..$ colour       : logi NA
  ..$ size         : NULL
  ..$ linetype     : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_rect" "element"
 $ panel.border              : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ panel.spacing             : 'simpleUnit' num 5.5points
  ..- attr(*, "unit")= int 8
 $ panel.spacing.x           : NULL
 $ panel.spacing.y           : NULL
 $ panel.grid                :List of 6
  ..$ colour       : chr "grey92"
  ..$ size         : NULL
  ..$ linetype     : NULL
  ..$ lineend      : NULL
  ..$ arrow        : logi FALSE
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_line" "element"
 $ panel.grid.major          : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ panel.grid.minor          : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ panel.grid.major.x        : NULL
 $ panel.grid.major.y        : NULL
 $ panel.grid.minor.x        : NULL
 $ panel.grid.minor.y        : NULL
 $ panel.ontop               : logi FALSE
 $ plot.background           :List of 5
  ..$ fill         : NULL
  ..$ colour       : chr "white"
  ..$ size         : NULL
  ..$ linetype     : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_rect" "element"
 $ plot.title                :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : 'rel' num 1.2
  ..$ hjust        : num 0
  ..$ vjust        : num 1
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 0points 5.5points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ plot.title.position       : chr "panel"
 $ plot.subtitle             :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : num 0
  ..$ vjust        : num 1
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 0points 5.5points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ plot.caption              :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : 'rel' num 0.8
  ..$ hjust        : num 1
  ..$ vjust        : num 1
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 5.5points 0points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ plot.caption.position     : chr "panel"
 $ plot.tag                  :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : 'rel' num 1.2
  ..$ hjust        : num 0.5
  ..$ vjust        : num 0.5
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ plot.tag.position         : chr "topleft"
 $ plot.margin               : 'margin' num [1:4] 5.5points 5.5points 5.5points 5.5points
  ..- attr(*, "unit")= int 8
 $ strip.background          :List of 5
  ..$ fill         : chr "white"
  ..$ colour       : chr "black"
  ..$ size         : 'rel' num 2
  ..$ linetype     : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_rect" "element"
 $ strip.background.x        : NULL
 $ strip.background.y        : NULL
 $ strip.placement           : chr "inside"
 $ strip.text                :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : chr "grey10"
  ..$ size         : 'rel' num 0.8
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 4.4points 4.4points 4.4points 4.4points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ strip.text.x              : NULL
 $ strip.text.y              :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : num -90
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ strip.switch.pad.grid     : 'simpleUnit' num 2.75points
  ..- attr(*, "unit")= int 8
 $ strip.switch.pad.wrap     : 'simpleUnit' num 2.75points
  ..- attr(*, "unit")= int 8
 $ strip.text.y.left         :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : num 90
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 - attr(*, "class")= chr [1:2] "theme" "gg"
 - attr(*, "complete")= logi TRUE
 - attr(*, "validate")= logi TRUE</code></pre>
</div>
</div>
<p>This graph shows that around 2012, the number of collaboration songs among K-pop artists was limited, with few international collaborations. The network is sparse In 2014, the number of K-pop collaborations started increasing with more Western collaborations. Between 2015 and 2020, K-pop experienced significant growth in terms of the number and types of collaborations. The collaborations werenot limited to the US-based artists, but to small numbers of Latino, East-Asian, South East Asian, and Europe based artists. After 2021, the number of collaborations per year is decreased, and the proportion of collaborations involving K-pop artists with artists from the US or countries other than Korea has been increasing.</p>
</section>
<section id="by-regime" class="level1">
<h1>(By regime)</h1>
<p>The graph above illustrates that collaborations in K-pop have different characteristics depending on the era. Taking into account the aforementioned features and significant milestones in the history of K-pop, such as the 2012 breakout with “Gangnam Style” and the major advancement in the American market by BTS in 2017, I have decided to divide the period from 2005 to 2023 into four eras: 2005-2011, 2012-2016, 2017-2020, and 2021-2023.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>edgelist <span class="ot">&lt;-</span> edgelist <span class="sc">%&gt;%</span> </span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">regime =</span> <span class="fu">case_when</span>(</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>      release_year <span class="sc">&lt;</span> <span class="dv">2012</span> <span class="sc">~</span> <span class="st">"2005-2011"</span>,</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>      release_year <span class="sc">&gt;=</span> <span class="dv">2012</span> <span class="sc">&amp;</span> release_year <span class="sc">&lt;</span> <span class="dv">2017</span> <span class="sc">~</span> <span class="st">"2012-2016"</span>,</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>      release_year <span class="sc">&gt;=</span> <span class="dv">2017</span> <span class="sc">&amp;</span> release_year <span class="sc">&lt;</span> <span class="dv">2021</span> <span class="sc">~</span> <span class="st">"2017-2020"</span>,</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"2021-"</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>    )) </span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>edgelist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,519 × 11
   From    To    song_id song_…¹ From_…² To_ar…³ Colla…⁴ Colla…⁵ relea…⁶ popul…⁷
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1 3Nrfpe… 1oSP… 5qyjy0… Angel … BTS     Jimin   K-pop   Domest…    2023      79
 2 3Nrfpe… 164U… 5qyjy0… Angel … BTS     JVKE    US or … Intern…    2023      79
 3 3Nrfpe… 46SH… 5qyjy0… Angel … BTS     Kodak … Latino  Intern…    2023      79
 4 3Nrfpe… 0Erz… 5qyjy0… Angel … BTS     NLE Ch… US or … Intern…    2023      79
 5 3Nrfpe… 7tjV… 5qyjy0… Angel … BTS     Muni L… US or … Intern…    2023      79
 6 3Nrfpe… 6HaG… 1RDvyO… Dreame… BTS     Jung K… K-pop   Domest…    2022      86
 7 3Nrfpe… 5C01… 1RDvyO… Dreame… BTS     FIFA S… US or … Intern…    2022      86
 8 3Nrfpe… 5CiG… 0xzI1K… Bad De… BTS     benny … US or … Intern…    2022      78
 9 3Nrfpe… 7hJc… 0xzI1K… Bad De… BTS     Snoop … US or … Intern…    2022      78
10 3Nrfpe… 6VuM… 0mBP9X… Left a… BTS     Charli… US or … Intern…    2022      82
# … with 1,509 more rows, 1 more variable: regime &lt;chr&gt;, and abbreviated
#   variable names ¹​song_name, ²​From_artists, ³​To_artists, ⁴​Collab_region1,
#   ⁵​Collab_region2, ⁶​release_year, ⁷​popularity</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">#E(collab.net)$period &lt;- edgelist$period</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the edgelist dataframe into 4 groups based on "period"</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>edgelist_list <span class="ot">&lt;-</span> <span class="fu">split</span>(edgelist, edgelist<span class="sc">$</span>regime)</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="co"># convert each element of the list into a separate dataframe</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>graphs <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(edgelist_list)) {</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"edgelist_"</span>, <span class="fu">names</span>(edgelist_list)[i]), edgelist_list[[i]])</span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>  unique_vertices <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(edgelist_list[[i]]<span class="sc">$</span>From, edgelist_list[[i]]<span class="sc">$</span>To))</span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>  artists_period <span class="ot">&lt;-</span> artists[artists<span class="sc">$</span>id <span class="sc">%in%</span> unique_vertices, ]</span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the graph from the filtered edgelist and vertices</span></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a>  graph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(edgelist_list[[i]], <span class="at">directed =</span> <span class="cn">FALSE</span>, <span class="at">vertices =</span> artists_period)</span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Append the graph to the list of graphs</span></span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a>  graphs[[i]] <span class="ot">&lt;-</span> graph</span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a>} </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assigning visualization attributes</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>regime <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"2005-2011"</span>, <span class="st">"2012-2016"</span>, <span class="st">"2017-2020"</span>, <span class="st">"2021"</span>)</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(graphs)) {</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">V</span>(graphs[[i]])<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">V</span>(graphs[[i]])<span class="sc">$</span>color_region_category</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(graphs[[i]], </span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label =</span> <span class="cn">NA</span>,</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">arrow.mode=</span><span class="st">"-"</span>,</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size =</span> <span class="fu">log</span>(<span class="fu">V</span>(graphs[[i]])<span class="sc">$</span>followers) <span class="sc">*</span> <span class="fl">0.7</span>,</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.cex =</span> .<span class="dv">6</span>,</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.color =</span> <span class="st">"black"</span>,</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.dist =</span> <span class="dv">0</span>,</span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.frame.color =</span> <span class="st">'lightgrey'</span>,</span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">frame.width =</span> <span class="dv">0</span>,</span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">color =</span> <span class="fu">V</span>(graphs[[i]])<span class="sc">$</span>color_region_category,</span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Collaboration by K-pop top artists</span><span class="sc">\n</span><span class="st">"</span>, regime[[i]])</span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"bottomright"</span>,</span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"K-pop"</span>, <span class="st">"Latin"</span>, <span class="st">"East Asia"</span>, <span class="st">"South East Asia"</span>, <span class="st">"Europe"</span>, <span class="st">"US or Other"</span>, <span class="st">"Unknown"</span>),</span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.bg  =</span> <span class="fu">c</span>(<span class="st">"#FFFFE1"</span>, <span class="st">"darkgreen"</span>, <span class="st">"#920002"</span>,<span class="st">"#FDCCCC"</span>, <span class="st">"#ABD7E6"</span>, <span class="st">"deepskyblue3"</span>, <span class="st">"darkgrey"</span>),</span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch    =</span> <span class="dv">21</span>,</span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex    =</span> <span class="dv">1</span>,</span>
<span id="cb118-26"><a href="#cb118-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty    =</span> <span class="st">"n"</span>,</span>
<span id="cb118-27"><a href="#cb118-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title  =</span> <span class="st">"Genre"</span></span>
<span id="cb118-28"><a href="#cb118-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb118-29"><a href="#cb118-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Kpop_network_Erika_Nagai_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Kpop_network_Erika_Nagai_files/figure-html/unnamed-chunk-39-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Kpop_network_Erika_Nagai_files/figure-html/unnamed-chunk-39-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Kpop_network_Erika_Nagai_files/figure-html/unnamed-chunk-39-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="overview-how-the-collaboration-patterns-have-changed-over-time" class="level2">
<h2 class="anchored" data-anchor-id="overview-how-the-collaboration-patterns-have-changed-over-time">Overview: How the collaboration patterns have changed over time?</h2>
<ol type="1">
<li><p>Between 2006 and 2010, the number of collaboration songs among K-pop artists was limited, with few international collaborations with artists outside of South Korea. Additionally, the network was sparse and disconnected.</p></li>
<li><p>From 2011 to 2015, the number of collaboration songs slightly increased, with more international collaborations and a more connected network.</p></li>
<li><p>Between 2016 and 2020, K-pop experienced significant growth in terms of the number and types of collaborations. Notably, BTS, G(I)DLE, and Blackpink have a large number of international collaboration songs.</p></li>
<li><p>In 2021, the number of collaboration songs is not as large as that of 2016-2020 due to the shorter time span, but the proportion of international collaborations appears to be higher.</p></li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>collab_by_regimes <span class="ot">&lt;-</span> edgelist <span class="sc">%&gt;%</span> </span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(regime) <span class="sc">%&gt;%</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">popularity =</span> <span class="fu">mean</span>(popularity),</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">K_Pop =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"K-pop"</span>),</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">US_Other =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"US or Other"</span>),</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">E_Asia =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"East Asia"</span>),</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE_Asia =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"South East Asia"</span>),</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Latino =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"Latino"</span>),</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Europe =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"Europe"</span>),</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Unknown =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"Unknown"</span>)</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>edgelist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,519 × 11
   From    To    song_id song_…¹ From_…² To_ar…³ Colla…⁴ Colla…⁵ relea…⁶ popul…⁷
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1 3Nrfpe… 1oSP… 5qyjy0… Angel … BTS     Jimin   K-pop   Domest…    2023      79
 2 3Nrfpe… 164U… 5qyjy0… Angel … BTS     JVKE    US or … Intern…    2023      79
 3 3Nrfpe… 46SH… 5qyjy0… Angel … BTS     Kodak … Latino  Intern…    2023      79
 4 3Nrfpe… 0Erz… 5qyjy0… Angel … BTS     NLE Ch… US or … Intern…    2023      79
 5 3Nrfpe… 7tjV… 5qyjy0… Angel … BTS     Muni L… US or … Intern…    2023      79
 6 3Nrfpe… 6HaG… 1RDvyO… Dreame… BTS     Jung K… K-pop   Domest…    2022      86
 7 3Nrfpe… 5C01… 1RDvyO… Dreame… BTS     FIFA S… US or … Intern…    2022      86
 8 3Nrfpe… 5CiG… 0xzI1K… Bad De… BTS     benny … US or … Intern…    2022      78
 9 3Nrfpe… 7hJc… 0xzI1K… Bad De… BTS     Snoop … US or … Intern…    2022      78
10 3Nrfpe… 6VuM… 0mBP9X… Left a… BTS     Charli… US or … Intern…    2022      82
# … with 1,509 more rows, 1 more variable: regime &lt;chr&gt;, and abbreviated
#   variable names ¹​song_name, ²​From_artists, ³​To_artists, ⁴​Collab_region1,
#   ⁵​Collab_region2, ⁶​release_year, ⁷​popularity</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>graph_stats_regimes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">regime =</span> <span class="fu">c</span>(<span class="st">"2005-2011"</span>, <span class="st">"2012-2016"</span>, <span class="st">"2017-2020"</span>, <span class="st">"2021-"</span>),</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">start_year =</span> <span class="fu">c</span>(<span class="dv">2006</span>, <span class="dv">2013</span>, <span class="dv">2017</span>, <span class="dv">2021</span>),</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">end_year =</span> <span class="fu">c</span>(<span class="dv">2011</span>, <span class="dv">2016</span>, <span class="dv">2020</span>, <span class="dv">2023</span>),</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">num_nodes =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime)), </span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">num_edges =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime)), </span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">num_songs =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime)),</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">num_kpop_artists =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime)),</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">num_no_kpop_artists =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime)),</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">percent_no_kpop_artitst =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime)),</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">artists_per_song =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime)),</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">centralization =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime)), </span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">density =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime)), </span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">transitivity =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime))</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>graph_stats_regimes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     regime start_year end_year num_nodes num_edges num_songs num_kpop_artists
1 2005-2011       2006     2011         0         0         0                0
2 2012-2016       2013     2016         0         0         0                0
3 2017-2020       2017     2020         0         0         0                0
4     2021-       2021     2023         0         0         0                0
  num_no_kpop_artists percent_no_kpop_artitst artists_per_song centralization
1                   0                       0                0              0
2                   0                       0                0              0
3                   0                       0                0              0
4                   0                       0                0              0
  density transitivity
1       0            0
2       0            0
3       0            0
4       0            0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>regime</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2005-2011" "2012-2016" "2017-2020" "2021"     </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each year and calculate the desired graph statistics</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(regime)) {</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  start_year <span class="ot">&lt;-</span> graph_stats_regimes<span class="sc">$</span>start_year[i]</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>  end_year <span class="ot">&lt;-</span> graph_stats_regimes<span class="sc">$</span>end_year[i]</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current 3-year span</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>  subset_data <span class="ot">&lt;-</span> edgelist[edgelist<span class="sc">$</span>release_year <span class="sc">%in%</span> <span class="fu">c</span>(start_year<span class="sc">:</span>end_year), ]</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(start_year)</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(end_year)</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the graph for the current 3-year span</span></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>  graph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame_with_all_vertices</span>(<span class="at">df =</span> subset_data, <span class="at">vertices =</span> artists)</span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fill in the corresponding row of the data frame with the calculated statistics</span></span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"num_nodes"</span>] <span class="ot">&lt;-</span> <span class="fu">vcount</span>(graph)</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"num_edges"</span>] <span class="ot">&lt;-</span> <span class="fu">ecount</span>(graph)</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a>  song_ids <span class="ot">&lt;-</span> <span class="fu">E</span>(graph)<span class="sc">$</span>song_id</span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>  num_unique_songs <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(song_ids))</span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"num_songs"</span>] <span class="ot">&lt;-</span> num_unique_songs</span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>  kpop_values <span class="ot">&lt;-</span> <span class="fu">V</span>(graph)<span class="sc">$</span>kpop</span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a>  num_kpop <span class="ot">&lt;-</span> <span class="fu">sum</span>(kpop_values <span class="sc">==</span> <span class="st">"yes"</span>)</span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"num_kpop_artists"</span>] <span class="ot">&lt;-</span> num_kpop</span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-28"><a href="#cb126-28" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"num_no_kpop_artists"</span>] <span class="ot">&lt;-</span> <span class="fu">vcount</span>(graph) <span class="sc">-</span> num_kpop</span>
<span id="cb126-29"><a href="#cb126-29" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"percent_no_kpop_artitst"</span>] <span class="ot">&lt;-</span> (<span class="fu">vcount</span>(graph)<span class="sc">-</span>num_kpop)<span class="sc">/</span><span class="fu">vcount</span>(graph)</span>
<span id="cb126-30"><a href="#cb126-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-31"><a href="#cb126-31" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"artists_per_song"</span>] <span class="ot">&lt;-</span> <span class="fu">vcount</span>(graph)<span class="sc">/</span>num_unique_songs</span>
<span id="cb126-32"><a href="#cb126-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-33"><a href="#cb126-33" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"centralization"</span>] <span class="ot">&lt;-</span> <span class="fu">centr_degree</span>(graph)<span class="sc">$</span>centralization</span>
<span id="cb126-34"><a href="#cb126-34" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"density"</span>] <span class="ot">&lt;-</span> <span class="fu">graph.density</span>(graph)</span>
<span id="cb126-35"><a href="#cb126-35" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"transitivity"</span>] <span class="ot">&lt;-</span> <span class="fu">transitivity</span>(graph, <span class="at">type =</span> <span class="st">'global'</span>)</span>
<span id="cb126-36"><a href="#cb126-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-37"><a href="#cb126-37" aria-hidden="true" tabindex="-1"></a>  kpop_values <span class="ot">&lt;-</span> <span class="fu">V</span>(graph)<span class="sc">$</span>kpop</span>
<span id="cb126-38"><a href="#cb126-38" aria-hidden="true" tabindex="-1"></a>  num_kpop <span class="ot">&lt;-</span> <span class="fu">sum</span>(kpop_values <span class="sc">==</span> <span class="st">"yes"</span>)</span>
<span id="cb126-39"><a href="#cb126-39" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"num_kpop_artists"</span>] <span class="ot">&lt;-</span> num_kpop</span>
<span id="cb126-40"><a href="#cb126-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-41"><a href="#cb126-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-42"><a href="#cb126-42" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2006
[1] 2011
[1] 2013
[1] 2016
[1] 2017
[1] 2020
[1] 2021
[1] 2023</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>graph_stats_regimes <span class="sc">%&gt;%</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(collab_by_regimes) <span class="sc">%&gt;%</span> </span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">song_per_kpop_artists =</span> num_songs<span class="sc">/</span><span class="st">`</span><span class="at">K_Pop</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = "regime"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     regime start_year end_year num_nodes num_edges num_songs num_kpop_artists
1 2005-2011       2006     2011       126       136       100               71
2 2012-2016       2013     2016       324       390       299              190
3 2017-2020       2017     2020       432       614       441              207
4     2021-       2021     2023       318       317       228              141
  num_no_kpop_artists percent_no_kpop_artitst artists_per_song centralization
1                  55               0.4365079        1.2600000     0.08673016
2                 134               0.4135802        1.0836120     0.07923403
3                 225               0.5208333        0.9795918     0.20686173
4                 177               0.5566038        1.3947368     0.14513025
      density transitivity popularity K_Pop US_Other E_Asia SE_Asia Latino
1 0.017269841  0.000000000   17.40845    71       21      4       0      0
2 0.007453274  0.021097046   23.65471   269       70      3       0      0
3 0.006595342  0.025306122   31.07003   295      183     25       8      7
4 0.006289308  0.004087193   40.48896   106      126      9       5      7
  Europe Unknown song_per_kpop_artists
1      0      46              1.408451
2      0     104              1.111524
3     10      86              1.494915
4      5      59              2.150943</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #graph_stats_regimes &lt;- graph_stats_regimes %&gt;% </span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(collab_by_regimes)%&gt;%</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(song_per_kpop_artists = num_songs/`K_Pop`)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the 3-year spans</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:length(end_years)) {</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   end_year &lt;- end_years[i]</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   start_year &lt;- end_year - 2</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   year &lt;- end_year -1</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Subset the data for the current 3-year span</span></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   subset_data &lt;- edgelist[edgelist$release_year %in% c(start_year:end_year), ]</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Create the graph for the current 3-year span</span></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph &lt;- graph_from_data_frame_with_all_vertices(df = subset_data, vertices = artists)</span></span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   V(graph)$color &lt;- V(graph)$color_region_category</span></span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot(graph,</span></span>
<span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a><span class="co">#        vertex.label = V(graph)$show_kpop_top,</span></span>
<span id="cb132-20"><a href="#cb132-20" aria-hidden="true" tabindex="-1"></a><span class="co">#        arrow.mode = "-",</span></span>
<span id="cb132-21"><a href="#cb132-21" aria-hidden="true" tabindex="-1"></a><span class="co">#        vertex.size = log(V(graph)$followers) * 0.7,</span></span>
<span id="cb132-22"><a href="#cb132-22" aria-hidden="true" tabindex="-1"></a><span class="co">#        vertex.label.cex = 0.6,</span></span>
<span id="cb132-23"><a href="#cb132-23" aria-hidden="true" tabindex="-1"></a><span class="co">#        vertex.label.color = "black",</span></span>
<span id="cb132-24"><a href="#cb132-24" aria-hidden="true" tabindex="-1"></a><span class="co">#        vertex.frame.color = 'lightgrey',</span></span>
<span id="cb132-25"><a href="#cb132-25" aria-hidden="true" tabindex="-1"></a><span class="co">#        vertex.label.dist = 0,</span></span>
<span id="cb132-26"><a href="#cb132-26" aria-hidden="true" tabindex="-1"></a><span class="co">#        frame.width = 0,</span></span>
<span id="cb132-27"><a href="#cb132-27" aria-hidden="true" tabindex="-1"></a><span class="co">#        color = V(graph)$color_region_category,</span></span>
<span id="cb132-28"><a href="#cb132-28" aria-hidden="true" tabindex="-1"></a><span class="co">#        main = paste0("Collaboration by K-pop top artists ", start_year, "-", end_year)</span></span>
<span id="cb132-29"><a href="#cb132-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb132-30"><a href="#cb132-30" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb132-31"><a href="#cb132-31" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb132-32"><a href="#cb132-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   legend(</span></span>
<span id="cb132-33"><a href="#cb132-33" aria-hidden="true" tabindex="-1"></a><span class="co">#     "bottomright",</span></span>
<span id="cb132-34"><a href="#cb132-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     legend = c("K-pop", "Latin", "East Asia", "South East Asia", "Europe", "US or Other", "Unknown"),</span></span>
<span id="cb132-35"><a href="#cb132-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     pt.bg  = c("#FFFFE1", "darkgreen", "#920002","#FDCCCC", "#ABD7E6", "deepskyblue3", "darkgrey"),</span></span>
<span id="cb132-36"><a href="#cb132-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     pch    = 21,</span></span>
<span id="cb132-37"><a href="#cb132-37" aria-hidden="true" tabindex="-1"></a><span class="co">#     cex    = 1,</span></span>
<span id="cb132-38"><a href="#cb132-38" aria-hidden="true" tabindex="-1"></a><span class="co">#     bty    = "n",</span></span>
<span id="cb132-39"><a href="#cb132-39" aria-hidden="true" tabindex="-1"></a><span class="co">#     title  = "Genre"</span></span>
<span id="cb132-40"><a href="#cb132-40" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb132-41"><a href="#cb132-41" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># end_years &lt;- 2008:2023</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="co"># graph_stats_3years &lt;- data.frame(</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                           start_year = 2006:2021,</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                           end_year = 2008:2023, </span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                           year = 2007:2022,</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                           num_nodes = numeric(length(2008:2023)), </span></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                           num_edges = numeric(length(2008:2023)), </span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                           num_songs = numeric(length(2008:2023)),</span></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                           num_kpop_artists = numeric(length(2008:2023)),</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                           num_no_kpop_artists = numeric(length(2008:2023)),</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                           percent_no_kpop_artitst = numeric(length(2008:2023)),</span></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                           artists_per_song = numeric(length(2008:2023)),</span></span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                           centralization = numeric(length(2008:2023)), </span></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                           density = numeric(length(2008:2023)), </span></span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                           transitivity = numeric(length(2008:2023))</span></span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a><span class="co"># # Loop through each year and calculate the desired graph statistics</span></span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:length(end_years)) {</span></span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   end_year &lt;- end_years[i]</span></span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   start_year &lt;- end_year - 2</span></span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Subset the data for the current 3-year span</span></span>
<span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   subset_data &lt;- edgelist[edgelist$release_year %in% c(start_year:end_year), ]</span></span>
<span id="cb133-26"><a href="#cb133-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb133-27"><a href="#cb133-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Create the graph for the current 3-year span</span></span>
<span id="cb133-28"><a href="#cb133-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph &lt;- graph_from_data_frame_with_all_vertices(df = subset_data, vertices = artists)</span></span>
<span id="cb133-29"><a href="#cb133-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb133-30"><a href="#cb133-30" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Fill in the corresponding row of the data frame with the calculated statistics</span></span>
<span id="cb133-31"><a href="#cb133-31" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "num_nodes"] &lt;- vcount(graph)</span></span>
<span id="cb133-32"><a href="#cb133-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "num_edges"] &lt;- ecount(graph)</span></span>
<span id="cb133-33"><a href="#cb133-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb133-34"><a href="#cb133-34" aria-hidden="true" tabindex="-1"></a><span class="co">#   song_ids &lt;- E(graph)$song_id</span></span>
<span id="cb133-35"><a href="#cb133-35" aria-hidden="true" tabindex="-1"></a><span class="co">#   num_unique_songs &lt;- length(unique(song_ids))</span></span>
<span id="cb133-36"><a href="#cb133-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "num_songs"] &lt;- num_unique_songs</span></span>
<span id="cb133-37"><a href="#cb133-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb133-38"><a href="#cb133-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   kpop_values &lt;- V(graph)$kpop</span></span>
<span id="cb133-39"><a href="#cb133-39" aria-hidden="true" tabindex="-1"></a><span class="co">#   num_kpop &lt;- sum(kpop_values == "yes")</span></span>
<span id="cb133-40"><a href="#cb133-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "num_kpop_artists"] &lt;- num_kpop</span></span>
<span id="cb133-41"><a href="#cb133-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb133-42"><a href="#cb133-42" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "num_no_kpop_artists"] &lt;- vcount(graph) - num_kpop</span></span>
<span id="cb133-43"><a href="#cb133-43" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "percent_no_kpop_artitst"] &lt;- (vcount(graph)-num_kpop)/vcount(graph)</span></span>
<span id="cb133-44"><a href="#cb133-44" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb133-45"><a href="#cb133-45" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "artists_per_song"] &lt;- vcount(graph)/num_unique_songs</span></span>
<span id="cb133-46"><a href="#cb133-46" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb133-47"><a href="#cb133-47" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "centralization"] &lt;- centr_degree(graph)$centralization</span></span>
<span id="cb133-48"><a href="#cb133-48" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "density"] &lt;- graph.density(graph)</span></span>
<span id="cb133-49"><a href="#cb133-49" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "transitivity"] &lt;- transitivity(graph, type = 'global')</span></span>
<span id="cb133-50"><a href="#cb133-50" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb133-51"><a href="#cb133-51" aria-hidden="true" tabindex="-1"></a><span class="co">#   kpop_values &lt;- V(graph)$kpop</span></span>
<span id="cb133-52"><a href="#cb133-52" aria-hidden="true" tabindex="-1"></a><span class="co">#   num_kpop &lt;- sum(kpop_values == "yes")</span></span>
<span id="cb133-53"><a href="#cb133-53" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "num_kpop_artists"] &lt;- num_kpop</span></span>
<span id="cb133-54"><a href="#cb133-54" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb133-55"><a href="#cb133-55" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb133-56"><a href="#cb133-56" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb133-57"><a href="#cb133-57" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb133-58"><a href="#cb133-58" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb133-59"><a href="#cb133-59" aria-hidden="true" tabindex="-1"></a><span class="co"># graph_stats_3years</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="how-does-the-nature-of-collaboration-change-between-2017-2020-and-2021-" class="level1">
<h1>How does the nature of collaboration change between 2017-2020 and 2021-?</h1>
<p>As the first graph showed, the number of collaborations has decreased since 2021 after it peaked in 2020 even though the they are quite diverse with many US-based artists and a few East Asian, South East Asian, and Latino artists.</p>
<p>Here, I will try to find out what has changed since 2021 and what caused this change.</p>
<p>One of the hypotheses is that as K-pop had established its international popularity by 2021, there was no longer a need for as many collaborations with international artists. Instead, artists relatively less popular whose main base is not South Korea started collaborating with K-pop artists to benefit from its popularity.</p>
<p>In Regime 3 (2017-2020) and Regime 4 (2021-), the relationship between K-pop artists and international artists in collaborations has changed. In Regime 3, K-pop artists often collaborated with internationally renowned artists. However, in Regime 4, this trend has shifted, and compared to Regime 3, there seems to be an increasing tendency for more popular K-pop artists to collaborate with relatively less famous non-Korean-based artists. This can be observed in the right graph above, where the slope becomes gentler, with the y-axis representing the popularity of international artists and the x-axis representing the popularity of K-pop artists.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>analysis <span class="ot">&lt;-</span> edgelist <span class="sc">%&gt;%</span> </span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(regime <span class="sc">==</span> <span class="st">"2017-2020"</span> <span class="sc">|</span> regime <span class="sc">==</span> <span class="st">"2021-"</span> <span class="sc">&amp;</span> Collab_region2 <span class="sc">==</span> <span class="st">"International"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"Collab_region1"</span>, <span class="st">"Collab_region2"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(artists <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"followers"</span>)), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"From"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(artists <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"followers"</span>)), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"To"</span> <span class="ot">=</span> <span class="st">"id"</span>)) </span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>analysis <span class="ot">&lt;-</span> analysis <span class="sc">%&gt;%</span> </span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Followers_of_Kpop_artists"</span> <span class="ot">=</span> <span class="st">"followers.x"</span>,</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Followers_of_Intl_artists"</span> <span class="ot">=</span> <span class="st">"followers.y"</span>)</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>analysis <span class="sc">%&gt;%</span> </span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Followers_of_Kpop_artists <span class="sc">&lt;</span> <span class="dv">2000000</span> <span class="sc">&amp;</span> Followers_of_Intl_artists <span class="sc">&gt;</span> <span class="dv">1000</span> <span class="sc">&amp;</span> Followers_of_Intl_artists <span class="sc">&lt;</span> <span class="dv">4000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Followers_of_Kpop_artists</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Followers_of_Intl_artists</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm , <span class="at">color=</span><span class="st">"darkblue"</span>, <span class="at">fill=</span><span class="st">"#69b3a2"</span>, <span class="at">se=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="at">col =</span> <span class="st">"steelblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"The number of followers of K-pop artists"</span>, <span class="at">y =</span> <span class="st">"The number of followers of International artists"</span>, <span class="at">title =</span> <span class="st">"The popularity of artists who collaborated in K-pop songs"</span>) <span class="sc">+</span></span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> regime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Kpop_network_Erika_Nagai_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In order to confirm this hypothesis more quantitatively, a regression model was used to examine the popularity of collaboration songs involving K-pop artists, the popularity of the K-pop artists themselves (measured by the number of followers on Spotify), and the popularity of international artists. (popularity of songs ~ popularity of K-pop artists who participated in the collaboration + popularity of international artists who participated in the collaboration).</p>
<p>The results showed that the influence of the popularity of K-pop artists and international artists on the popularity of collaboration songs was 2.9 and 3.9 (significant with p = 0.05), respectively, from 2017 to 2020. However, from 2021 onwards, these values became 4.8 and 3.08 (significant with p = 0.05), respectively, indicating a reversal in the impact of the popularity of K-pop artists and international artists on the popularity of collaboration song.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>lm.pop_reg3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(popularity <span class="sc">~</span> Followers_of_Kpop_artists <span class="sc">+</span> Followers_of_Intl_artists, <span class="at">data =</span> analysis <span class="sc">%&gt;%</span> <span class="fu">filter</span>(regime <span class="sc">==</span> <span class="st">"2017-2020"</span>))</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>lm.pop_reg4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(popularity <span class="sc">~</span> Followers_of_Kpop_artists <span class="sc">+</span> Followers_of_Intl_artists, <span class="at">data =</span> analysis <span class="sc">%&gt;%</span> <span class="fu">filter</span>(regime <span class="sc">==</span> <span class="st">"2021-"</span>))</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(lm.pop_reg3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = popularity ~ Followers_of_Kpop_artists + Followers_of_Intl_artists, 
    data = analysis %&gt;% filter(regime == "2017-2020"))

Residuals:
    Min      1Q  Median      3Q     Max 
-43.935  -9.397  -0.991   8.596  40.528 

Coefficients:
                           Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               2.893e+01  6.409e-01  45.144  &lt; 2e-16 ***
Followers_of_Kpop_artists 3.899e-07  6.279e-08   6.209 9.84e-10 ***
Followers_of_Intl_artists 7.319e-07  1.810e-07   4.044 5.93e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.97 on 611 degrees of freedom
Multiple R-squared:  0.1409,    Adjusted R-squared:  0.1381 
F-statistic: 50.09 on 2 and 611 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(lm.pop_reg4))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = popularity ~ Followers_of_Kpop_artists + Followers_of_Intl_artists, 
    data = analysis %&gt;% filter(regime == "2021-"))

Residuals:
   Min     1Q Median     3Q    Max 
-35.89 -13.39   0.54  12.79  38.23 

Coefficients:
                           Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               3.428e+01  1.381e+00  24.821  &lt; 2e-16 ***
Followers_of_Kpop_artists 4.781e-07  8.183e-08   5.842 1.96e-08 ***
Followers_of_Intl_artists 3.083e-07  1.215e-07   2.538   0.0119 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 17.9 on 208 degrees of freedom
Multiple R-squared:  0.2222,    Adjusted R-squared:  0.2148 
F-statistic: 29.72 on 2 and 208 DF,  p-value: 4.44e-12</code></pre>
</div>
</div>
</section>
<section id="summary-of-evoluation-of-k-pop-collaborations-for-last-20-years." class="level1">
<h1>Summary of evoluation of K-pop collaborations for last 20 years.</h1>
<p>In summary, K-pop artists gained international popularity and a global audience partially due to collaborations with international artists starting in the mid-2010s. Since 2021,the number of collaboration songs has decreased. Besides, there has been a shift where artists outside of Korea are now collaborating with K-pop artists, leveraging their global popularity, to reach a broader audience.</p>
</section>
<section id="additional-analysis" class="level1">
<h1>Additional analysis</h1>
<section id="artists-based-analysis-who-are-the-key-artists" class="level2">
<h2 class="anchored" data-anchor-id="artists-based-analysis-who-are-the-key-artists">(Artists-based analysis) Who are the key artists?</h2>
<p>The below are the top 10 artists with the highest eigenvector centrality. It is interesting that they are not necessarily the most popular artists. For example BTS, BLACKPINK, or other more popular K-pop artists are not listed here. 8 of them are K-Pop artists and the rest of them are Yultron, DJ based in Los Angeles, and Gray, a New York base band.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">V</span>(collab.net)<span class="sc">$</span>name,</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">followers =</span> <span class="fu">V</span>(collab.net)<span class="sc">$</span>followers,</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">region_category =</span> <span class="fu">V</span>(collab.net)<span class="sc">$</span>region_category,</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">kpop =</span> <span class="fu">V</span>(collab.net)<span class="sc">$</span>kpop,</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">degree =</span> <span class="fu">degree</span>(collab.net, <span class="at">mode =</span> <span class="st">'total'</span>),</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">transitivity =</span> <span class="fu">transitivity</span>(collab.net, <span class="at">type =</span> <span class="st">'local'</span>),</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">betweenness =</span> <span class="fu">betweenness</span>(collab.net),</span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">eigen_cent =</span> <span class="fu">eigen_centrality</span>(collab.net, <span class="at">directed =</span> F, <span class="at">scale =</span> F)<span class="sc">$</span>vector)</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>nodes <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(eigen_cent)) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                       name followers region_category kpop degree transitivity
Jay Park           Jay Park   1941923           K-pop  yes    171  0.007947639
Sik-K                 Sik-K    431030           K-pop  yes     84  0.035437431
Loco                   Loco    379142           K-pop  yes     57  0.033868093
pH-1                   pH-1    372581           K-pop  yes     15  0.238095238
Ugly Duck         Ugly Duck      9671           K-pop  yes      9  1.000000000
DJ Wegun           DJ Wegun     13768           K-pop  yes      9  0.000000000
GRAY                   GRAY    282549           K-pop  yes     15  0.200000000
Hit-Boy             Hit-Boy     68444     US or Other   no      7          NaN
YULTRON             YULTRON     34860     US or Other   no      7          NaN
Simon Dominic Simon Dominic    442764           K-pop  yes      9  0.666666667
              betweenness eigen_cent
Jay Park      118616.1730  0.6221463
Sik-K          55250.6056  0.3817554
Loco           39472.8834  0.2740903
pH-1           12630.9924  0.2043511
Ugly Duck          0.0000  0.1870638
DJ Wegun         474.1053  0.1763272
GRAY            3819.0552  0.1550732
Hit-Boy            0.0000  0.1520206
YULTRON            0.0000  0.1520206
Simon Dominic   1598.8051  0.1454675</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co">#nodes_stat_regime_list &lt;- list()  # Create an empty list to store the dataframes</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:length(graphs)) {</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   nodes_stat_regime &lt;- data.frame(</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     genre = V(graphs[[i]])$genre,</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     followers = V(graphs[[i]])$followers,</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     region_category = V(graphs[[i]])$region_category,</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     kpop = V(graphs[[i]])$kpop,</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     degree = degree(graphs[[i]]),</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     transitivity = transitivity(graphs[[i]], type = 'local'),</span></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     betweenness = betweenness(graphs[[i]]),</span></span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     eigen_cent = eigen_centrality(graphs[[i]], directed = F, scale = F)$vector</span></span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     </span></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   nodes_stat_regime_list[[i]] &lt;- nodes_stat_regime  # Store the dataframe in the list</span></span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Most nodes have a small eigenvector centrality, whch is less than 0.1. The nodes with a relatively bigger eigenvector centrality are K-pop artists and do not have many followers.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="sc">%&gt;%</span> </span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(eigen_cent <span class="sc">&lt;</span> <span class="fl">0.4</span> <span class="sc">&amp;</span> followers <span class="sc">&lt;</span> <span class="dv">4000000</span>) <span class="sc">%&gt;%</span> <span class="co">#excluding outliers</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>followers, <span class="at">y=</span>eigen_cent, <span class="at">color=</span>region_category)) <span class="sc">+</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"region_category"</span>, </span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"K-pop"</span> <span class="ot">=</span> <span class="st">"#FFFFE1"</span>, </span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Latino"</span> <span class="ot">=</span> <span class="st">"darkgreen"</span>, </span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"East Asia"</span> <span class="ot">=</span> <span class="st">"#920002"</span>,</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Southeast Asia"</span> <span class="ot">=</span> <span class="st">"#FDCCCC"</span>, </span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Europe"</span> <span class="ot">=</span> <span class="st">"#ABD7E6"</span>, </span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"US or Other"</span> <span class="ot">=</span> <span class="st">"#010087"</span>,                                      <span class="st">"Unknown"</span> <span class="ot">=</span> <span class="st">"darkgrey"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Kpop_network_Erika_Nagai_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>There is not a clear correlation between the number of collaboration songs and the artist’s popularity.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="sc">%&gt;%</span> </span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(followers <span class="sc">&lt;</span> <span class="dv">4000000</span>) <span class="sc">%&gt;%</span> <span class="co">#excluding outliers</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>followers, <span class="at">y=</span>degree, <span class="at">color=</span>region_category)) <span class="sc">+</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"region_category"</span>, </span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"K-pop"</span> <span class="ot">=</span> <span class="st">"#FFFFE1"</span>, </span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Latino"</span> <span class="ot">=</span> <span class="st">"darkgreen"</span>, </span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"East Asia"</span> <span class="ot">=</span> <span class="st">"#920002"</span>,</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Southeast Asia"</span> <span class="ot">=</span> <span class="st">"#FDCCCC"</span>, </span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Europe"</span> <span class="ot">=</span> <span class="st">"#ABD7E6"</span>, </span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"US or Other"</span> <span class="ot">=</span> <span class="st">"#010087"</span>,                                      <span class="st">"Unknown"</span> <span class="ot">=</span> <span class="st">"darkgrey"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Kpop_network_Erika_Nagai_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a graph for each year</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="co"># graph_from_data_frame_with_all_vertices &lt;- function(df, vertices) {</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Create a data frame with all possible edges between vertices</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   unique_vertices &lt;- unique(c(df$From, df$To))</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   artists_period &lt;- artists[artists$id %in% unique_vertices, ]</span></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Create the graph with all vertices and existing edges</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph &lt;- graph_from_data_frame(df, directed = FALSE, vertices = artists_period)</span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   return(graph)</span></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a><span class="co"># graphs_year &lt;- lapply(2006:2023, function(x) graph_from_data_frame_with_all_vertices(df = edgelist[edgelist$release_year == x, ], vertices = artists))</span></span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a><span class="co"># periods &lt;- c(2006:2023)</span></span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:length(graphs_year)) {</span></span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   V(graphs_year[[i]])$color &lt;- V(graphs_year[[i]])$color_region_category</span></span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot(graphs_year[[i]], </span></span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.label = V(graphs_year[[i]])$show_kpop_top,</span></span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a><span class="co">#      arrow.mode="-",</span></span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.size = log(V(graphs_year[[i]])$followers) * 0.7,</span></span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.label.cex = .8,</span></span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.label.color = "black",</span></span>
<span id="cb145-25"><a href="#cb145-25" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.label.dist = 0,</span></span>
<span id="cb145-26"><a href="#cb145-26" aria-hidden="true" tabindex="-1"></a><span class="co">#      frame.width = 0,</span></span>
<span id="cb145-27"><a href="#cb145-27" aria-hidden="true" tabindex="-1"></a><span class="co">#      color = V(graphs_year[[i]])$color_region_category,</span></span>
<span id="cb145-28"><a href="#cb145-28" aria-hidden="true" tabindex="-1"></a><span class="co">#      main = paste0("Collaboration by K-pop top artists ", periods[[i]])</span></span>
<span id="cb145-29"><a href="#cb145-29" aria-hidden="true" tabindex="-1"></a><span class="co">#      )</span></span>
<span id="cb145-30"><a href="#cb145-30" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb145-31"><a href="#cb145-31" aria-hidden="true" tabindex="-1"></a><span class="co">#   legend(</span></span>
<span id="cb145-32"><a href="#cb145-32" aria-hidden="true" tabindex="-1"></a><span class="co">#     "bottomright",</span></span>
<span id="cb145-33"><a href="#cb145-33" aria-hidden="true" tabindex="-1"></a><span class="co">#     legend = c("K-pop", "Latin", "East Asia", "South East Asia", "Europe", "US or Other", "Unknown"),</span></span>
<span id="cb145-34"><a href="#cb145-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     pt.bg  = c("#FFFFE1", "darkgreen", "#920002","#FDCCCC", "#ABD7E6", "#010087", "darkgrey"),</span></span>
<span id="cb145-35"><a href="#cb145-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     pch    = 21,</span></span>
<span id="cb145-36"><a href="#cb145-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     cex    = 1,</span></span>
<span id="cb145-37"><a href="#cb145-37" aria-hidden="true" tabindex="-1"></a><span class="co">#     bty    = "n",</span></span>
<span id="cb145-38"><a href="#cb145-38" aria-hidden="true" tabindex="-1"></a><span class="co">#     title  = "Genre"</span></span>
<span id="cb145-39"><a href="#cb145-39" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb145-40"><a href="#cb145-40" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># collab_by_years &lt;- edgelist %&gt;% </span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(release_year) %&gt;%</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     popularity = mean(popularity),</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     K_Pop = sum(Collab_region1 == "K-pop"),</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     US_Other = sum(Collab_region1 == "US or Other"),</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     E_Asia = sum(Collab_region1 == "East Asia"),</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     SE_Asia = sum(Collab_region1 == "South East Asia"),</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     Latino = sum(Collab_region1 == "Latino"),</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     Europe = sum(Collab_region1 == "Europe"),</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     Unknown = sum(Collab_region1 == "Unknown")</span></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(collab_by_years)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># graph_stats &lt;- data.frame(year = 2006:2023, </span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                           num_nodes = numeric(length(2006:2023)), </span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                           num_edges = numeric(length(2006:2023)), </span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                           num_songs = numeric(length(2006:2023)),</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                           artists_per_song = numeric(length(2006:2023)),</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                           centralization = numeric(length(2006:2023)), </span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                           density = numeric(length(2006:2023)), </span></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                           transitivity = numeric(length(2006:2023))</span></span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # Loop through each year and calculate the desired graph statistics</span></span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:length(graphs_year)) {</span></span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph &lt;- graphs_year[[i]]</span></span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Fill in the corresponding row of the data frame with the calculated statistics</span></span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats[i, "num_nodes"] &lt;- vcount(graph)</span></span>
<span id="cb147-17"><a href="#cb147-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats[i, "num_edges"] &lt;- ecount(graph)</span></span>
<span id="cb147-18"><a href="#cb147-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb147-19"><a href="#cb147-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   song_ids &lt;- E(graph)$song_id</span></span>
<span id="cb147-20"><a href="#cb147-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   num_unique_songs &lt;- length(unique(song_ids))</span></span>
<span id="cb147-21"><a href="#cb147-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats[i, "num_songs"] &lt;- num_unique_songs</span></span>
<span id="cb147-22"><a href="#cb147-22" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb147-23"><a href="#cb147-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb147-24"><a href="#cb147-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats[i, "centralization"] &lt;- centr_degree(graph)$centralization</span></span>
<span id="cb147-25"><a href="#cb147-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats[i, "density"] &lt;- graph.density(graph)</span></span>
<span id="cb147-26"><a href="#cb147-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats[i, "transitivity"] &lt;- transitivity(graph, type = 'global')</span></span>
<span id="cb147-27"><a href="#cb147-27" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb147-28"><a href="#cb147-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb147-29"><a href="#cb147-29" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb147-30"><a href="#cb147-30" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb147-31"><a href="#cb147-31" aria-hidden="true" tabindex="-1"></a><span class="co"># graph_stats &lt;- graph_stats %&gt;% left_join(collab_by_years, by = c("year" = "release_year"))%&gt;%</span></span>
<span id="cb147-32"><a href="#cb147-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(song_per_kpop_artists = num_songs/`K_Pop`)</span></span>
<span id="cb147-33"><a href="#cb147-33" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb147-34"><a href="#cb147-34" aria-hidden="true" tabindex="-1"></a><span class="co"># graph_stats</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="discussion" class="level1">
<h1>Discussion</h1>
<p>This network analysis was conducted to illustrate the general characteristics and changes in K-pop over the past roughly 20 years. The analysis revealed that K-pop has increased the number of collaborations, particularly with Western artists, since the mid-2010s. In the late 2010s, K-pop expanded its collaborations to include a diverse range of artists from Asia, Europe, and Latin America, reaching its peak in the number of collaborations in 2020. This suggests that K-pop aimed to approach markets outside of Asia and increase its international popularity, especially after the massive success of “Gangnam Style” in 2012. There is no evidence to prove, however, the increase in the number of collaborations with Latino artists after 2018 may be due to the huge hit of “Despacito” by Luis Fonsi in 2017.</p>
<p>From 2021, the number of collaborations decreased, but the proportion of international collaborations surpassed collaborations between K-pop artists themselves. This indicates the presence of relatively less popular artists who are not based in Korea, but collaborate with internationally renowned K-pop artists to reach a wider audience.</p>
<p>According to the linear regression model, the popularity of collaborative songs between 2017 and 2020 was influenced by the popularity of the international artists involved in the collaborations. However, from 2021 onwards, it was found that the popularity of K-pop artists had a greater impact.</p>
<p>While this analysis represents one factor that can explain the recent prominence of K-pop, it lacks detailed analysis in terms of network analysis and has certain limitations in the data. For instance, community identification is limited. Due to the reliance on limited data primarily obtained from the Spotify API, it was not possible to analyze based on meaningful information such as the artists’ affiliations with agencies. Additionally, the data used in this analysis reflects the popularity of songs and artists as of May 2023, as current and retrospective information is unavailable from the Spotify API.</p>
<p>The findings proposed by this analysis are believed to be worth researching further based on detailed data and analysis in the future.</p>
</section>
<section id="source" class="level1">
<h1>Source</h1>
<p>KIM, K. H. (2021). Short History of K-Pop, K-Cinema, and K-Television. In Hegemonic Mimicry: Korean Popular Culture of the Twenty-First Century (pp.&nbsp;35–84). Duke University Press. https://doi.org/10.2307/j.ctv1xrb6s6.5</p>
<p>Shin, H. (2009). Have you ever seen the Rain? And who’ll stop the Rain?: The globalizing project of Korean pop (K-pop). Inter-Asia Cultural Studies, 10(4), 507–523.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/Social_Networks_Spring_2023" data-repo-id="R_kgDOI9d_OA" data-category="Announcements" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb148" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Final Project Kpop Collaboration Network"</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Erika Nagai"</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "05/20/2023"</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a><span class="co"># editor: visual</span></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a><span class="fu"># Overview</span></span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a>The phenomenon of K-pop has recently emerged as a prominent cultural force, gaining significant attention and popularity not only in South Korea and other Asian nations but globally as well, particularly among the younger generation. An interesting aspect of K-pop is that many K-pop artists collaborate with other artists, often those who are not based in South Korea. In this analysis, my objective is to delve into the dynamics of such collaborations within the K-pop industry and beyond, across various musical genres, and to investigate how these collaborative patterns have evolved over time. To achieve this goal, I aim to examine the social network of K-pop collaborations, with a view to gaining a better understanding of the underlying trends and structures shaping this phenomenon.</span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true" tabindex="-1"></a><span class="fu"># Literature review and hypothesis</span></span>
<span id="cb148-20"><a href="#cb148-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-21"><a href="#cb148-21" aria-hidden="true" tabindex="-1"></a>During the 1990s, Seo Taiji gained significant popularity in the K-pop industry by pioneering a fusion of hip-hop and euro-pop-inspired songs (Kyung, 2021). Subsequently, from the late 1990s to the mid-2020s, K-pop experienced a surge in popularity in other Asian regions, particularly China and Japan (Kyung, 2021; Shin, 2009). The notable global success of Psy's "Gangnam Style" in 2012 served as a pivotal moment, propelling K-pop into the U.S. market and instilling hope within the industry for accessing a broader international audience (Kyung, 2021). Based on these historical developments, I hypothesized: H1. K-pop started to collaborate on songs with international artists, particularly those from Western countries, following the impact of "Gangnam Style" in 2012."</span>
<span id="cb148-22"><a href="#cb148-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-23"><a href="#cb148-23" aria-hidden="true" tabindex="-1"></a><span class="fu"># Methods of studies</span></span>
<span id="cb148-24"><a href="#cb148-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-25"><a href="#cb148-25" aria-hidden="true" tabindex="-1"></a>To analyze the K-pop music landscape, the following steps were taken: First, the name of K-pop artists were gathered by prompting ChatGPT on famous K-pop artists for the last 20 years (specifically, as of 2005, 2010, 2012, 2015, 2018, and 2020) and by extracting all the artists' name from Spotify official playlists "Top-KPop Artists of 2022," "Millenium K-Pop," "Best of 2008: K-Pop". Then, all the songs who are sung by these artists were gathered using Spotify API and only collaboration songs, which are sung by more than one artist were used for this analysis. This resulted in 1123 songs by 962 artists/groups. (Refer to "Preparation_SpotifyID.ipynb" and "K-Pop Social Network ANalysis.ipynb" for the process of data collection.)</span>
<span id="cb148-26"><a href="#cb148-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-27"><a href="#cb148-27" aria-hidden="true" tabindex="-1"></a><span class="fu"># Read in &amp; Describe data</span></span>
<span id="cb148-28"><a href="#cb148-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-29"><a href="#cb148-29" aria-hidden="true" tabindex="-1"></a>**collab_songs.csv:**</span>
<span id="cb148-30"><a href="#cb148-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-31"><a href="#cb148-31" aria-hidden="true" tabindex="-1"></a>This is a list of collaboration songs collected by</span>
<span id="cb148-32"><a href="#cb148-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-33"><a href="#cb148-33" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>gathering the name of the top 50 Kpop artists in 2010, 2015, and 2020 by asking ChatGPT</span>
<span id="cb148-34"><a href="#cb148-34" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>manually collecting their Spotify artist id</span>
<span id="cb148-35"><a href="#cb148-35" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>collecting all the singles/albums data of the artists by using Spotify API and</span>
<span id="cb148-36"><a href="#cb148-36" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>removing the songs that are NOT collaborative by filtering out those who have only one artist registered</span>
<span id="cb148-37"><a href="#cb148-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-38"><a href="#cb148-38" aria-hidden="true" tabindex="-1"></a>**artist.csv:**</span>
<span id="cb148-39"><a href="#cb148-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-40"><a href="#cb148-40" aria-hidden="true" tabindex="-1"></a>This is a list of artists performed the collaboration songs collected by</span>
<span id="cb148-41"><a href="#cb148-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-42"><a href="#cb148-42" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>extracting the unique artists from the collab_songs.csv</span>
<span id="cb148-43"><a href="#cb148-43" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>collecting their information (genre and followers) using Spotify API</span>
<span id="cb148-44"><a href="#cb148-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-45"><a href="#cb148-45" aria-hidden="true" tabindex="-1"></a>**song_detail.csv:**</span>
<span id="cb148-46"><a href="#cb148-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-47"><a href="#cb148-47" aria-hidden="true" tabindex="-1"></a>This is a list of songs with detail information prepared by</span>
<span id="cb148-48"><a href="#cb148-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-49"><a href="#cb148-49" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>extracting the detailed song information (release year, available market etc) by using Spotify API based on the track id from kpop_collab.csv</span>
<span id="cb148-50"><a href="#cb148-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-53"><a href="#cb148-53" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-54"><a href="#cb148-54" aria-hidden="true" tabindex="-1"></a><span class="co"># install libraries</span></span>
<span id="cb148-55"><a href="#cb148-55" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb148-56"><a href="#cb148-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb148-57"><a href="#cb148-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb148-58"><a href="#cb148-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb148-59"><a href="#cb148-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb148-60"><a href="#cb148-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-61"><a href="#cb148-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-64"><a href="#cb148-64" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-65"><a href="#cb148-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb148-66"><a href="#cb148-66" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb148-67"><a href="#cb148-67" aria-hidden="true" tabindex="-1"></a>collab_songs <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"_data/Kpop_analysis_ErikaNagai/final_collab_songs.csv"</span>)</span>
<span id="cb148-68"><a href="#cb148-68" aria-hidden="true" tabindex="-1"></a>artists <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"_data/Kpop_analysis_ErikaNagai/final_artists_df.csv"</span>)</span>
<span id="cb148-69"><a href="#cb148-69" aria-hidden="true" tabindex="-1"></a>song_detail <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"_data/Kpop_analysis_ErikaNagai/song_detail.csv"</span>)</span>
<span id="cb148-70"><a href="#cb148-70" aria-hidden="true" tabindex="-1"></a>song_detail <span class="ot">&lt;-</span> song_detail <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"...1"</span>))</span>
<span id="cb148-71"><a href="#cb148-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-72"><a href="#cb148-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-73"><a href="#cb148-73" aria-hidden="true" tabindex="-1"></a><span class="fu"># Describe &amp; Clean the data</span></span>
<span id="cb148-74"><a href="#cb148-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-75"><a href="#cb148-75" aria-hidden="true" tabindex="-1"></a><span class="fu">### `collab_songs` dataframe</span></span>
<span id="cb148-76"><a href="#cb148-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-77"><a href="#cb148-77" aria-hidden="true" tabindex="-1"></a><span class="in">`collab_songs`</span> is a dataframe where each observation is a collaboration songs by Kpop top artists and other artists.</span>
<span id="cb148-78"><a href="#cb148-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-79"><a href="#cb148-79" aria-hidden="true" tabindex="-1"></a>It has 1123 rows (collaboration songs) and 30 columns.</span>
<span id="cb148-80"><a href="#cb148-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-83"><a href="#cb148-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-84"><a href="#cb148-84" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb148-85"><a href="#cb148-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-86"><a href="#cb148-86" aria-hidden="true" tabindex="-1"></a><span class="co"># Skim the data</span></span>
<span id="cb148-87"><a href="#cb148-87" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(collab_songs)</span>
<span id="cb148-88"><a href="#cb148-88" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(collab_songs)</span>
<span id="cb148-89"><a href="#cb148-89" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-90"><a href="#cb148-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-91"><a href="#cb148-91" aria-hidden="true" tabindex="-1"></a><span class="in">`collab_songs`</span> has following columns.</span>
<span id="cb148-92"><a href="#cb148-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-93"><a href="#cb148-93" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>song_name</span>
<span id="cb148-94"><a href="#cb148-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-95"><a href="#cb148-95" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>song_id: this can be used as a key when joining with <span class="in">`song_detail`</span> dataframe</span>
<span id="cb148-96"><a href="#cb148-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-97"><a href="#cb148-97" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>kpop_artist_name: This is a name of the Kpop top artists.(KPop top artists are from Spotify Top playlists or the answers from Chat GPT)</span>
<span id="cb148-98"><a href="#cb148-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-99"><a href="#cb148-99" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>artist_id: This is a Spotify Artist id of the Kpop top artists. This can be used as a key when joining with <span class="in">`artist`</span> dataframe</span>
<span id="cb148-100"><a href="#cb148-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-101"><a href="#cb148-101" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>artist<span class="sc">\_\[</span>i<span class="sc">\]</span>: This is a name of the artists that collaborated with Kpop top artists or the Kpop top artists themselves, which means that it might duplicate with <span class="in">`kpop_artist_name`</span> (i is a number from 1 to 7)</span>
<span id="cb148-102"><a href="#cb148-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-103"><a href="#cb148-103" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>artist_id<span class="sc">\_\[</span>i<span class="sc">\]</span>: This is a Spotify Artist ID of the artists that collaborated with Kpop top artists or the Kpop top artists themselves, which means that it might duplicate with <span class="in">`artist_id`</span> (i is a number from 1 to 7). This can be used as a key when joining with <span class="in">`artists`</span> dataframe.</span>
<span id="cb148-104"><a href="#cb148-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-107"><a href="#cb148-107" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-108"><a href="#cb148-108" aria-hidden="true" tabindex="-1"></a>collab_songs <span class="ot">&lt;-</span> collab_songs <span class="sc">%&gt;%</span> </span>
<span id="cb148-109"><a href="#cb148-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"song_name"</span>, <span class="st">"song_id"</span>, <span class="st">"kpop_artist_name"</span>, <span class="st">"artist_id"</span>, <span class="st">"artist_1"</span>, <span class="st">"artist_id_1"</span>, <span class="st">"artist_2"</span>, <span class="st">"artist_id_2"</span>, <span class="st">"artist_3"</span>, <span class="st">"artist_id_3"</span>, <span class="st">"artist_4"</span>, <span class="st">"artist_id_4"</span>, <span class="st">"artist_5"</span>, <span class="st">"artist_id_5"</span>, <span class="st">"artist_6"</span>, <span class="st">"artist_id_6"</span>, <span class="st">"artist_7"</span>, <span class="st">"artist_id_7"</span>, <span class="st">"artist_8"</span>, <span class="st">"artist_id_8"</span>, <span class="st">"artist_9"</span>, <span class="st">"artist_id_9"</span>, <span class="st">"artist_10"</span>, <span class="st">"artist_id_10"</span>, <span class="st">"artist_11"</span>, <span class="st">"artist_id_11"</span>, <span class="st">"artist_12"</span>, <span class="st">"artist_id_12"</span>, <span class="st">"artist_13"</span>, <span class="st">"artist_id_13"</span>))</span>
<span id="cb148-110"><a href="#cb148-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-111"><a href="#cb148-111" aria-hidden="true" tabindex="-1"></a>collab_songs</span>
<span id="cb148-112"><a href="#cb148-112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-113"><a href="#cb148-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-114"><a href="#cb148-114" aria-hidden="true" tabindex="-1"></a><span class="fu">### Artists</span></span>
<span id="cb148-115"><a href="#cb148-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-116"><a href="#cb148-116" aria-hidden="true" tabindex="-1"></a><span class="in">`artists`</span> is a dataframe where each row represents an artist (individual/group) that have participated in Kpop collaboration songs by top Kpop artists.</span>
<span id="cb148-117"><a href="#cb148-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-118"><a href="#cb148-118" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>name: the name of the artist</span>
<span id="cb148-119"><a href="#cb148-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-120"><a href="#cb148-120" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>id: This is a Spotify Artist ID of the artist. It can be used as a key when joining with <span class="in">`collab_songs`</span> dataframe</span>
<span id="cb148-121"><a href="#cb148-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-122"><a href="#cb148-122" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>top_kpop: if the artist is one of the top 50 Kpop artists in 2010, 2015, or 2020, the value is 1. Otherwise, the value is 0.</span>
<span id="cb148-123"><a href="#cb148-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-124"><a href="#cb148-124" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>genre: the genre of the artist (can be multiple)</span>
<span id="cb148-125"><a href="#cb148-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-126"><a href="#cb148-126" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>followers: the number of the followers on Spotify. Spotify API doesn't provide the number of artists' monthly followers so the number of followers is the only index of popularity of artists.</span>
<span id="cb148-127"><a href="#cb148-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-128"><a href="#cb148-128" aria-hidden="true" tabindex="-1"></a><span class="in">`artist`</span> dataframe has 962 unique rows, meaning that there are 962 artists (including K-pop artists, and non-kpop artists) that have participated in K-pop musical collaboration</span>
<span id="cb148-129"><a href="#cb148-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-132"><a href="#cb148-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-133"><a href="#cb148-133" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(artists)</span>
<span id="cb148-134"><a href="#cb148-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-135"><a href="#cb148-135" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(artists)</span>
<span id="cb148-136"><a href="#cb148-136" aria-hidden="true" tabindex="-1"></a>artists</span>
<span id="cb148-137"><a href="#cb148-137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-138"><a href="#cb148-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-141"><a href="#cb148-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-142"><a href="#cb148-142" aria-hidden="true" tabindex="-1"></a>artists <span class="sc">%&gt;%</span> </span>
<span id="cb148-143"><a href="#cb148-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb148-144"><a href="#cb148-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb148-145"><a href="#cb148-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb148-146"><a href="#cb148-146" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-147"><a href="#cb148-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-150"><a href="#cb148-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-151"><a href="#cb148-151" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean data by removing unnecessary columns</span></span>
<span id="cb148-152"><a href="#cb148-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-153"><a href="#cb148-153" aria-hidden="true" tabindex="-1"></a>artists <span class="ot">&lt;-</span> artists <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(id, <span class="at">.before =</span> name)</span>
<span id="cb148-154"><a href="#cb148-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-155"><a href="#cb148-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-158"><a href="#cb148-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-159"><a href="#cb148-159" aria-hidden="true" tabindex="-1"></a><span class="co"># This is the list of the genre names that appear in artist dataframe</span></span>
<span id="cb148-160"><a href="#cb148-160" aria-hidden="true" tabindex="-1"></a>artists <span class="sc">%&gt;%</span></span>
<span id="cb148-161"><a href="#cb148-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(genre) <span class="sc">%&gt;%</span></span>
<span id="cb148-162"><a href="#cb148-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(genre, <span class="at">sep =</span> <span class="st">",</span><span class="sc">\\</span><span class="st">s*"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb148-163"><a href="#cb148-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">genre =</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">[|'|</span><span class="sc">\\</span><span class="st">]"</span>, <span class="st">""</span>, genre)) <span class="sc">%&gt;%</span></span>
<span id="cb148-164"><a href="#cb148-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(genre) <span class="sc">%&gt;%</span></span>
<span id="cb148-165"><a href="#cb148-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(genre)</span>
<span id="cb148-166"><a href="#cb148-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-167"><a href="#cb148-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-170"><a href="#cb148-170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-171"><a href="#cb148-171" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb148-172"><a href="#cb148-172" aria-hidden="true" tabindex="-1"></a>artists <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">str_detect</span>(genre, <span class="st">"desi pop"</span>))</span>
<span id="cb148-173"><a href="#cb148-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-174"><a href="#cb148-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-175"><a href="#cb148-175" aria-hidden="true" tabindex="-1"></a>artists <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">str_detect</span>(genre, <span class="st">"j-|japanese|josei"</span>))</span>
<span id="cb148-176"><a href="#cb148-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-177"><a href="#cb148-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-178"><a href="#cb148-178" aria-hidden="true" tabindex="-1"></a>I added two new columns to the <span class="in">`artist`</span> dataFrame. The first column <span class="in">`region_genre`</span>, which indicate the broader regional genre of each artist, such as K-pop, Latin-pop, or J-pop (Japanese pop), which would help us to better understand the overall geographical market. The second column would simply indicate whether each artist is K-pop or not.</span>
<span id="cb148-179"><a href="#cb148-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-180"><a href="#cb148-180" aria-hidden="true" tabindex="-1"></a>First, I decided to classify the overall genre by detecting the follwoing word in the <span class="in">`genre`</span> column</span>
<span id="cb148-181"><a href="#cb148-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-182"><a href="#cb148-182" aria-hidden="true" tabindex="-1"></a>**K-pop:** "korean", "k-" (for example k-pop, k-rap). Also any artists whose column "top-kpop" is 1 are considered as K-pop genre.</span>
<span id="cb148-183"><a href="#cb148-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-184"><a href="#cb148-184" aria-hidden="true" tabindex="-1"></a>**Latin-pop:** "latin", "latino", "chicano", "chileno", "bachata", "colombian", "mexican", "puerto rican", "reggaeton", "dominicano"</span>
<span id="cb148-185"><a href="#cb148-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-186"><a href="#cb148-186" aria-hidden="true" tabindex="-1"></a>**East Asia:** "japanese", "j-" (for example j-pop, j-rap, j-core), "visual-kei", "josei", "kawaii", "chinese\</span>
<span id="cb148-187"><a href="#cb148-187" aria-hidden="true" tabindex="-1"></a>,"c-","taiwan"</span>
<span id="cb148-188"><a href="#cb148-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-189"><a href="#cb148-189" aria-hidden="true" tabindex="-1"></a>**South East Asia:** "vietnamese", "viet", "v-pop", "singaporean", "desi pop", "bollywood", "indian", "indonesian", "malaysian", "thai", "burmese"</span>
<span id="cb148-190"><a href="#cb148-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-191"><a href="#cb148-191" aria-hidden="true" tabindex="-1"></a>**Europe:** "uk" (uk-pop, uk-hiphop), "norwegian", "swedish", "belgian"</span>
<span id="cb148-192"><a href="#cb148-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-193"><a href="#cb148-193" aria-hidden="true" tabindex="-1"></a>**US or Others:** artists whose genre doesn't include the above words but has any word</span>
<span id="cb148-194"><a href="#cb148-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-195"><a href="#cb148-195" aria-hidden="true" tabindex="-1"></a>**Unknown:** artists whose genre is empty</span>
<span id="cb148-196"><a href="#cb148-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-199"><a href="#cb148-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-200"><a href="#cb148-200" aria-hidden="true" tabindex="-1"></a>artists <span class="sc">%&gt;%</span> <span class="fu">group_by_all</span>()<span class="sc">%&gt;%</span></span>
<span id="cb148-201"><a href="#cb148-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb148-202"><a href="#cb148-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb148-203"><a href="#cb148-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-204"><a href="#cb148-204" aria-hidden="true" tabindex="-1"></a>artists <span class="ot">&lt;-</span> artists <span class="sc">%&gt;%</span> </span>
<span id="cb148-205"><a href="#cb148-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region_category=</span><span class="fu">case_when</span>(</span>
<span id="cb148-206"><a href="#cb148-206" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"k-|koreanp"</span>, genre) <span class="sc">|</span> top_kpop <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"K-pop"</span>,</span>
<span id="cb148-207"><a href="#cb148-207" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"latin|latino|chicano|chileno|bachata|colombian|mexican|puerto rican|reggaeton|dominicano"</span>, genre) <span class="sc">~</span> <span class="st">"Latino"</span>,</span>
<span id="cb148-208"><a href="#cb148-208" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"j-|japanese|visual-kei|josei|visualkawaii|chinese|c-|taiwan"</span>, genre) <span class="sc">~</span> <span class="st">"East Asia"</span>,</span>
<span id="cb148-209"><a href="#cb148-209" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"vietnamese|viet|v-|singaporean|desi pop|bollywood|indian |indonesian|malaysian|thai|burmese"</span>, genre) <span class="sc">~</span> <span class="st">"South East Asia"</span>,</span>
<span id="cb148-210"><a href="#cb148-210" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"uk-|uk "</span>, genre) <span class="sc">~</span> <span class="st">"Europe"</span>,</span>
<span id="cb148-211"><a href="#cb148-211" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">[</span><span class="sc">\\</span><span class="st">]"</span>, genre) <span class="sc">~</span> <span class="st">"Unknown"</span>,</span>
<span id="cb148-212"><a href="#cb148-212" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"US or Other"</span></span>
<span id="cb148-213"><a href="#cb148-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-214"><a href="#cb148-214" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb148-215"><a href="#cb148-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-216"><a href="#cb148-216" aria-hidden="true" tabindex="-1"></a>artists <span class="sc">%&gt;%</span> </span>
<span id="cb148-217"><a href="#cb148-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region_category) <span class="sc">%&gt;%</span></span>
<span id="cb148-218"><a href="#cb148-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>())</span>
<span id="cb148-219"><a href="#cb148-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-220"><a href="#cb148-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-221"><a href="#cb148-221" aria-hidden="true" tabindex="-1"></a>There are 349 artists whose genre is unknown. I checked them and changed <span class="in">`region_category`</span> of some of them.</span>
<span id="cb148-222"><a href="#cb148-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-225"><a href="#cb148-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-226"><a href="#cb148-226" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(artists <span class="sc">%&gt;%</span> </span>
<span id="cb148-227"><a href="#cb148-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(region_category <span class="sc">==</span> <span class="st">"Unknown"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb148-228"><a href="#cb148-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(name)))</span>
<span id="cb148-229"><a href="#cb148-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-230"><a href="#cb148-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-231"><a href="#cb148-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-234"><a href="#cb148-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-235"><a href="#cb148-235" aria-hidden="true" tabindex="-1"></a><span class="co"># I noticed there were a few Japanese artists so I manually changed his region_category "East Asia"</span></span>
<span id="cb148-236"><a href="#cb148-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-237"><a href="#cb148-237" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"香取慎吾"</span>] <span class="ot">&lt;-</span> <span class="st">"East Asia"</span></span>
<span id="cb148-238"><a href="#cb148-238" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Yutaka Furukawa"</span>] <span class="ot">&lt;-</span> <span class="st">"East Asia"</span></span>
<span id="cb148-239"><a href="#cb148-239" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Takanori Nishikawa T.M.Revolution"</span>] <span class="ot">&lt;-</span> <span class="st">"East Asia"</span></span>
<span id="cb148-240"><a href="#cb148-240" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Naoko Tanaka"</span>] <span class="ot">&lt;-</span> <span class="st">"East Asia"</span></span>
<span id="cb148-241"><a href="#cb148-241" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"m-flo loves Sik-K &amp; eill &amp; 向井太一"</span>] <span class="ot">&lt;-</span> <span class="st">"East Asia"</span></span>
<span id="cb148-242"><a href="#cb148-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-243"><a href="#cb148-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-244"><a href="#cb148-244" aria-hidden="true" tabindex="-1"></a><span class="co"># Artists whose name include Hangul, I manually changed their region_category to "K-pop"</span></span>
<span id="cb148-245"><a href="#cb148-245" aria-hidden="true" tabindex="-1"></a>artists <span class="ot">&lt;-</span> artists <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(name)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(region_category) <span class="co"># row 371 - 404 are in Hangul</span></span>
<span id="cb148-246"><a href="#cb148-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-247"><a href="#cb148-247" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[<span class="dv">371</span><span class="sc">:</span><span class="dv">404</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-248"><a href="#cb148-248" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"nafla (나플라)"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-249"><a href="#cb148-249" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"MC 몽"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-250"><a href="#cb148-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-251"><a href="#cb148-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-252"><a href="#cb148-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-255"><a href="#cb148-255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-256"><a href="#cb148-256" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(artists <span class="sc">%&gt;%</span></span>
<span id="cb148-257"><a href="#cb148-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(region_category <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> followers <span class="sc">&gt;</span> <span class="dv">10000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb148-258"><a href="#cb148-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(followers))) <span class="sc">%&gt;%</span></span>
<span id="cb148-259"><a href="#cb148-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"name"</span>))</span>
<span id="cb148-260"><a href="#cb148-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-261"><a href="#cb148-261" aria-hidden="true" tabindex="-1"></a><span class="co"># I manually changed the region_categoroy for artists whose followers are over 15000 by checking the online information</span></span>
<span id="cb148-262"><a href="#cb148-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-263"><a href="#cb148-263" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>id <span class="sc">==</span> <span class="st">"70DFixYAFPv4Pf9kgSfR9O"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-264"><a href="#cb148-264" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Gallant"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb148-265"><a href="#cb148-265" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Punch"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-266"><a href="#cb148-266" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"BIG Naughty"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-267"><a href="#cb148-267" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"PREP"</span>] <span class="ot">&lt;-</span> <span class="st">"Europe"</span></span>
<span id="cb148-268"><a href="#cb148-268" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"GASHI"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb148-269"><a href="#cb148-269" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Lolo Zouaï"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb148-270"><a href="#cb148-270" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"SEHUN"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-271"><a href="#cb148-271" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Riff Raff"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb148-272"><a href="#cb148-272" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"FIFA Sound"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb148-273"><a href="#cb148-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-274"><a href="#cb148-274" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"vaultboy"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb148-275"><a href="#cb148-275" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"D_LITE"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-276"><a href="#cb148-276" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Seraphine"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-277"><a href="#cb148-277" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Wonstein"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-278"><a href="#cb148-278" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"YooA"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-279"><a href="#cb148-279" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Wuki"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb148-280"><a href="#cb148-280" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"MINNIE"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-281"><a href="#cb148-281" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Symba"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb148-282"><a href="#cb148-282" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"HWANG MIN HYUN"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-283"><a href="#cb148-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-284"><a href="#cb148-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-285"><a href="#cb148-285" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"T.O.P"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-286"><a href="#cb148-286" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"End of the World"</span>] <span class="ot">&lt;-</span> <span class="st">"East Asia"</span></span>
<span id="cb148-287"><a href="#cb148-287" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"MELOH"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-288"><a href="#cb148-288" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"LUCAS"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-289"><a href="#cb148-289" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Paul Blanco"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb148-290"><a href="#cb148-290" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"JEON WOONG"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-291"><a href="#cb148-291" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Sion"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-292"><a href="#cb148-292" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"KEN THE 390"</span>] <span class="ot">&lt;-</span> <span class="st">"East Asia"</span></span>
<span id="cb148-293"><a href="#cb148-293" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"BM"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-294"><a href="#cb148-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-295"><a href="#cb148-295" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Minhyun"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-296"><a href="#cb148-296" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Yong Jun Hyung"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-297"><a href="#cb148-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-298"><a href="#cb148-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-299"><a href="#cb148-299" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Lucas"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span> <span class="co"># I learned he is a Hong Kong rapper but is based in South Korea and is a member of Kpop group NCT.</span></span>
<span id="cb148-300"><a href="#cb148-300" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Paniel"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-301"><a href="#cb148-301" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"PANIEL"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-302"><a href="#cb148-302" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"PENIEL"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-303"><a href="#cb148-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-304"><a href="#cb148-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-305"><a href="#cb148-305" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"LIM YOUNG MIN"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-306"><a href="#cb148-306" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"KIM DONG HYUN"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-307"><a href="#cb148-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-308"><a href="#cb148-308" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"D-LITE"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-309"><a href="#cb148-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-310"><a href="#cb148-310" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"LUNA"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-311"><a href="#cb148-311" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"LEE DAE HWI"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-312"><a href="#cb148-312" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"LEEGIKWANG"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-313"><a href="#cb148-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-314"><a href="#cb148-314" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"T.O.P."</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-315"><a href="#cb148-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-316"><a href="#cb148-316" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Zior Park"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-317"><a href="#cb148-317" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Sandara Park"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-318"><a href="#cb148-318" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"U-KWON"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-319"><a href="#cb148-319" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"HOYA"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-320"><a href="#cb148-320" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Slom"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-321"><a href="#cb148-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-322"><a href="#cb148-322" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"TAEHYUN"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-323"><a href="#cb148-323" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"WOOSEOK"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-324"><a href="#cb148-324" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"ABLE"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-325"><a href="#cb148-325" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Imad Royal"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb148-326"><a href="#cb148-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-327"><a href="#cb148-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-328"><a href="#cb148-328" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"J.UNA"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-329"><a href="#cb148-329" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Yeeun"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-330"><a href="#cb148-330" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Reiley"</span>] <span class="ot">&lt;-</span> <span class="st">"Europe"</span></span>
<span id="cb148-331"><a href="#cb148-331" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"NARSHA"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-332"><a href="#cb148-332" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"Son Dong Woon"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-333"><a href="#cb148-333" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"LEE CHANHYUK"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-334"><a href="#cb148-334" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"The Chosen"</span>] <span class="ot">&lt;-</span> <span class="st">"Latino"</span></span>
<span id="cb148-335"><a href="#cb148-335" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"JeHwi"</span>] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-336"><a href="#cb148-336" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[artists<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"inverness"</span>] <span class="ot">&lt;-</span> <span class="st">"US or Other"</span></span>
<span id="cb148-337"><a href="#cb148-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-338"><a href="#cb148-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-341"><a href="#cb148-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-342"><a href="#cb148-342" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb148-343"><a href="#cb148-343" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(artists <span class="sc">%&gt;%</span> </span>
<span id="cb148-344"><a href="#cb148-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(region_category <span class="sc">==</span> <span class="st">"Unknown"</span> <span class="sc">&amp;</span> <span class="fu">str_detect</span>(name,<span class="st">"</span><span class="sc">\\</span><span class="st">("</span>)))</span>
<span id="cb148-345"><a href="#cb148-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-346"><a href="#cb148-346" aria-hidden="true" tabindex="-1"></a><span class="co"># Some artists are from a group where he/she belongs to</span></span>
<span id="cb148-347"><a href="#cb148-347" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[<span class="fu">str_detect</span>(artists<span class="sc">$</span>name, <span class="st">"B.A.P"</span>)] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-348"><a href="#cb148-348" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[<span class="fu">str_detect</span>(artists<span class="sc">$</span>name, <span class="st">"BTOB"</span>)] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-349"><a href="#cb148-349" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[<span class="fu">str_detect</span>(artists<span class="sc">$</span>name, <span class="st">"MelodyDay"</span>)] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-350"><a href="#cb148-350" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[<span class="fu">str_detect</span>(artists<span class="sc">$</span>name, <span class="st">"Urban Zakapa"</span>)] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-351"><a href="#cb148-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-352"><a href="#cb148-352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-353"><a href="#cb148-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-356"><a href="#cb148-356" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-357"><a href="#cb148-357" aria-hidden="true" tabindex="-1"></a>artists <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region_category <span class="sc">==</span> <span class="st">"Unknown"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb148-358"><a href="#cb148-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(name, <span class="st">"of"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb148-359"><a href="#cb148-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"name"</span>))</span>
<span id="cb148-360"><a href="#cb148-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-361"><a href="#cb148-361" aria-hidden="true" tabindex="-1"></a><span class="co"># Some artists are from a group where he/she belongs to</span></span>
<span id="cb148-362"><a href="#cb148-362" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[<span class="fu">str_detect</span>(artists<span class="sc">$</span>name, <span class="st">"ITZY"</span>)] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-363"><a href="#cb148-363" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[<span class="fu">str_detect</span>(artists<span class="sc">$</span>name, <span class="st">"Stray Kids"</span>)] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-364"><a href="#cb148-364" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[<span class="fu">str_detect</span>(artists<span class="sc">$</span>name, <span class="st">"MOMOLAND"</span>)] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-365"><a href="#cb148-365" aria-hidden="true" tabindex="-1"></a>artists<span class="sc">$</span>region_category[<span class="fu">str_detect</span>(artists<span class="sc">$</span>name, <span class="st">"JANNABI"</span>)] <span class="ot">&lt;-</span> <span class="st">"K-pop"</span></span>
<span id="cb148-366"><a href="#cb148-366" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-367"><a href="#cb148-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-370"><a href="#cb148-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-371"><a href="#cb148-371" aria-hidden="true" tabindex="-1"></a>artists <span class="ot">&lt;-</span> artists <span class="sc">%&gt;%</span> </span>
<span id="cb148-372"><a href="#cb148-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb148-373"><a href="#cb148-373" aria-hidden="true" tabindex="-1"></a>    <span class="at">kpop =</span> <span class="fu">case_when</span>(</span>
<span id="cb148-374"><a href="#cb148-374" aria-hidden="true" tabindex="-1"></a>    region_category <span class="sc">==</span> <span class="st">"K-pop"</span> <span class="sc">~</span> <span class="st">"yes"</span>,</span>
<span id="cb148-375"><a href="#cb148-375" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"no"</span>),</span>
<span id="cb148-376"><a href="#cb148-376" aria-hidden="true" tabindex="-1"></a>    <span class="at">show_kpop_top =</span> <span class="fu">case_when</span>(</span>
<span id="cb148-377"><a href="#cb148-377" aria-hidden="true" tabindex="-1"></a>      top_kpop <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> name,</span>
<span id="cb148-378"><a href="#cb148-378" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">""</span></span>
<span id="cb148-379"><a href="#cb148-379" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb148-380"><a href="#cb148-380" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb148-381"><a href="#cb148-381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-382"><a href="#cb148-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-383"><a href="#cb148-383" aria-hidden="true" tabindex="-1"></a><span class="fu">### song_detail (song_detail.csv)</span></span>
<span id="cb148-384"><a href="#cb148-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-385"><a href="#cb148-385" aria-hidden="true" tabindex="-1"></a><span class="in">`song_detail`</span> is a dataframe where each observation is a collaboration song by K-pop top artists and other artists. While <span class="in">`collab_songs`</span> provides the general information of the artists that worked on the song, this dataframe provides more detailed information about the songs themselves such as duration, track number, release date etc...</span>
<span id="cb148-386"><a href="#cb148-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-387"><a href="#cb148-387" aria-hidden="true" tabindex="-1"></a>It has 1123 rows (collaboration songs), which is the same as the number of the rows of <span class="in">`collab_songs`</span>, and 19 columns.</span>
<span id="cb148-388"><a href="#cb148-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-391"><a href="#cb148-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-392"><a href="#cb148-392" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(song_detail)</span>
<span id="cb148-393"><a href="#cb148-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-394"><a href="#cb148-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-395"><a href="#cb148-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-396"><a href="#cb148-396" aria-hidden="true" tabindex="-1"></a>The necessary columns are as follows</span>
<span id="cb148-397"><a href="#cb148-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-398"><a href="#cb148-398" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>id: This is a Spotify song id. Can be used as a key when joining with <span class="in">`collab_songs`</span></span>
<span id="cb148-399"><a href="#cb148-399" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>name: name of the songs</span>
<span id="cb148-400"><a href="#cb148-400" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>popularity: the popularity index from Spotify</span>
<span id="cb148-401"><a href="#cb148-401" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>release_year:</span>
<span id="cb148-402"><a href="#cb148-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-405"><a href="#cb148-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-406"><a href="#cb148-406" aria-hidden="true" tabindex="-1"></a><span class="co"># # I will remove unnecessary columns</span></span>
<span id="cb148-407"><a href="#cb148-407" aria-hidden="true" tabindex="-1"></a><span class="co"># song_detail &lt;- song_detail %&gt;% </span></span>
<span id="cb148-408"><a href="#cb148-408" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(c("id", "name", "popularity", "release_year"))</span></span>
<span id="cb148-409"><a href="#cb148-409" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-410"><a href="#cb148-410" aria-hidden="true" tabindex="-1"></a><span class="co"># song_detail$release_year &lt;- as.integer(song_detail$release_year)</span></span>
<span id="cb148-411"><a href="#cb148-411" aria-hidden="true" tabindex="-1"></a><span class="co"># song_detail %&gt;% arrange(release_year)</span></span>
<span id="cb148-412"><a href="#cb148-412" aria-hidden="true" tabindex="-1"></a><span class="co"># ```</span></span>
<span id="cb148-413"><a href="#cb148-413" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-414"><a href="#cb148-414" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Extra data cleaning</span></span>
<span id="cb148-415"><a href="#cb148-415" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-416"><a href="#cb148-416" aria-hidden="true" tabindex="-1"></a><span class="co"># `collab_songs` include unofficial songs by unofficial accounts. For example, there are a few songs by After School and Blackpink. However, if you look at the Spotify album page, this "Blackpink" is different from "BLACK PINK". There seem to be several cases that the artist ID is not the correct one. So I removed the songs that are not by "official" (=with more monthly followers) accounts.</span></span>
<span id="cb148-417"><a href="#cb148-417" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-418"><a href="#cb148-418" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-419"><a href="#cb148-419" aria-hidden="true" tabindex="-1"></a><span class="co"># ```{r}</span></span>
<span id="cb148-420"><a href="#cb148-420" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-421"><a href="#cb148-421" aria-hidden="true" tabindex="-1"></a><span class="co"># # Remove the songs by artist_1 whose id doesn't exist</span></span>
<span id="cb148-422"><a href="#cb148-422" aria-hidden="true" tabindex="-1"></a><span class="co"># collab_songs &lt;- collab_songs %&gt;%</span></span>
<span id="cb148-423"><a href="#cb148-423" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(artists, by = c("artist_id_1" = "id")) %&gt;%</span></span>
<span id="cb148-424"><a href="#cb148-424" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(!is.na(name)) %&gt;%</span></span>
<span id="cb148-425"><a href="#cb148-425" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c("name", "top_kpop", "genre", "followers", "name_lower", "region_category", "kpop"))</span></span>
<span id="cb148-426"><a href="#cb148-426" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-427"><a href="#cb148-427" aria-hidden="true" tabindex="-1"></a><span class="co"># # Remove the songs by artist_2 whose id doesn't exist </span></span>
<span id="cb148-428"><a href="#cb148-428" aria-hidden="true" tabindex="-1"></a><span class="co"># collab_songs &lt;- collab_songs %&gt;% </span></span>
<span id="cb148-429"><a href="#cb148-429" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(artists, by = c("artist_id_2" = "id")) %&gt;%</span></span>
<span id="cb148-430"><a href="#cb148-430" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(is.na(artist_2)|!is.na(name)) %&gt;%</span></span>
<span id="cb148-431"><a href="#cb148-431" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c("name", "top_kpop", "genre", "followers", "name_lower", "region_category", "kpop"))</span></span>
<span id="cb148-432"><a href="#cb148-432" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-433"><a href="#cb148-433" aria-hidden="true" tabindex="-1"></a><span class="co"># # Remove the songs by artist_3 whose id doesn't exist </span></span>
<span id="cb148-434"><a href="#cb148-434" aria-hidden="true" tabindex="-1"></a><span class="co"># collab_songs &lt;- collab_songs %&gt;% </span></span>
<span id="cb148-435"><a href="#cb148-435" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(artists, by = c("artist_id_3" = "id")) %&gt;%</span></span>
<span id="cb148-436"><a href="#cb148-436" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(is.na(artist_3)|!is.na(name)) %&gt;%</span></span>
<span id="cb148-437"><a href="#cb148-437" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c("name", "top_kpop", "genre", "followers", "name_lower", "region_category", "kpop"))</span></span>
<span id="cb148-438"><a href="#cb148-438" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-439"><a href="#cb148-439" aria-hidden="true" tabindex="-1"></a><span class="co"># # Remove the songs by artist_4 whose id doesn't exist </span></span>
<span id="cb148-440"><a href="#cb148-440" aria-hidden="true" tabindex="-1"></a><span class="co"># collab_songs &lt;- collab_songs %&gt;% </span></span>
<span id="cb148-441"><a href="#cb148-441" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(artists, by = c("artist_id_4" = "id")) %&gt;%</span></span>
<span id="cb148-442"><a href="#cb148-442" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(is.na(artist_4)|!is.na(name)) %&gt;%</span></span>
<span id="cb148-443"><a href="#cb148-443" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c("name", "top_kpop", "genre", "followers", "name_lower", "region_category", "kpop"))</span></span>
<span id="cb148-444"><a href="#cb148-444" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-445"><a href="#cb148-445" aria-hidden="true" tabindex="-1"></a><span class="co"># # Remove the songs by artist_5 whose id doesn't exist </span></span>
<span id="cb148-446"><a href="#cb148-446" aria-hidden="true" tabindex="-1"></a><span class="co"># collab_songs &lt;- collab_songs %&gt;% </span></span>
<span id="cb148-447"><a href="#cb148-447" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(artists, by = c("artist_id_5" = "id")) %&gt;%</span></span>
<span id="cb148-448"><a href="#cb148-448" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(is.na(artist_5)|!is.na(name)) %&gt;%</span></span>
<span id="cb148-449"><a href="#cb148-449" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c("name", "top_kpop", "genre", "followers", "name_lower", "region_category", "kpop"))</span></span>
<span id="cb148-450"><a href="#cb148-450" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-451"><a href="#cb148-451" aria-hidden="true" tabindex="-1"></a><span class="co"># # Remove the songs by artist_6 whose id doesn't exist </span></span>
<span id="cb148-452"><a href="#cb148-452" aria-hidden="true" tabindex="-1"></a><span class="co"># collab_songs &lt;- collab_songs %&gt;% </span></span>
<span id="cb148-453"><a href="#cb148-453" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(artists, by = c("artist_id_6" = "id")) %&gt;%</span></span>
<span id="cb148-454"><a href="#cb148-454" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(is.na(artist_6)|!is.na(name)) %&gt;%</span></span>
<span id="cb148-455"><a href="#cb148-455" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c("name", "top_kpop", "genre", "followers", "name_lower", "region_category", "kpop"))</span></span>
<span id="cb148-456"><a href="#cb148-456" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-457"><a href="#cb148-457" aria-hidden="true" tabindex="-1"></a><span class="co"># # Remove the songs by artist_7 whose id doesn't exist </span></span>
<span id="cb148-458"><a href="#cb148-458" aria-hidden="true" tabindex="-1"></a><span class="co"># collab_songs &lt;- collab_songs %&gt;% </span></span>
<span id="cb148-459"><a href="#cb148-459" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(artists, by = c("artist_id_7" = "id")) %&gt;%</span></span>
<span id="cb148-460"><a href="#cb148-460" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(is.na(artist_7)|!is.na(name)) %&gt;%</span></span>
<span id="cb148-461"><a href="#cb148-461" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c("name", "top_kpop", "genre", "followers", "name_lower", "region_category", "kpop"))</span></span>
<span id="cb148-462"><a href="#cb148-462" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-463"><a href="#cb148-463" aria-hidden="true" tabindex="-1"></a><span class="co"># collab_songs</span></span>
<span id="cb148-464"><a href="#cb148-464" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-465"><a href="#cb148-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-466"><a href="#cb148-466" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exploratory Data Analysis</span></span>
<span id="cb148-467"><a href="#cb148-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-468"><a href="#cb148-468" aria-hidden="true" tabindex="-1"></a><span class="fu">### How many K-pop collaboration songs are released by year?</span></span>
<span id="cb148-469"><a href="#cb148-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-472"><a href="#cb148-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-473"><a href="#cb148-473" aria-hidden="true" tabindex="-1"></a>collab_songs <span class="sc">%&gt;%</span> </span>
<span id="cb148-474"><a href="#cb148-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(song_detail, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"song_id"</span><span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb148-475"><a href="#cb148-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>release_year)) <span class="sc">+</span> </span>
<span id="cb148-476"><a href="#cb148-476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb148-477"><a href="#cb148-477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">2010</span>, <span class="dv">2022</span>, <span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb148-478"><a href="#cb148-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">2000</span>, <span class="dv">2023</span>) <span class="sc">+</span></span>
<span id="cb148-479"><a href="#cb148-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"The number of K-pop collaboration songs"</span>, <span class="at">subtitle =</span> <span class="st">"The number of collaboration songs by K-pop top artists is increasing over the time"</span>)</span>
<span id="cb148-480"><a href="#cb148-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-481"><a href="#cb148-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-482"><a href="#cb148-482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-483"><a href="#cb148-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-484"><a href="#cb148-484" aria-hidden="true" tabindex="-1"></a><span class="fu">### Is the popularity of K-pop collaboration songs increasing?</span></span>
<span id="cb148-485"><a href="#cb148-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-488"><a href="#cb148-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-489"><a href="#cb148-489" aria-hidden="true" tabindex="-1"></a>song_detail <span class="sc">%&gt;%</span></span>
<span id="cb148-490"><a href="#cb148-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(release_year) <span class="sc">%&gt;%</span></span>
<span id="cb148-491"><a href="#cb148-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_popularity =</span> <span class="fu">mean</span>(popularity)) <span class="sc">%&gt;%</span></span>
<span id="cb148-492"><a href="#cb148-492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>release_year, <span class="at">y=</span>mean_popularity)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb148-493"><a href="#cb148-493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Popularity of K-pop collaboration songs"</span>, <span class="at">subtitle =</span> <span class="st">"The popularity of K-pop collaboration songs is increasing constantly since around 2009"</span>)</span>
<span id="cb148-494"><a href="#cb148-494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-495"><a href="#cb148-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-496"><a href="#cb148-496" aria-hidden="true" tabindex="-1"></a><span class="fu">## The popularity of K-pop artists</span></span>
<span id="cb148-497"><a href="#cb148-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-500"><a href="#cb148-500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-501"><a href="#cb148-501" aria-hidden="true" tabindex="-1"></a>artists <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region_category<span class="sc">==</span><span class="st">"K-pop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb148-502"><a href="#cb148-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>followers)) <span class="sc">+</span></span>
<span id="cb148-503"><a href="#cb148-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span>
<span id="cb148-504"><a href="#cb148-504" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-505"><a href="#cb148-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-506"><a href="#cb148-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-507"><a href="#cb148-507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-508"><a href="#cb148-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-511"><a href="#cb148-511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-512"><a href="#cb148-512" aria-hidden="true" tabindex="-1"></a>artists <span class="sc">%&gt;%</span> </span>
<span id="cb148-513"><a href="#cb148-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(region_category <span class="sc">==</span> <span class="st">"K-pop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb148-514"><a href="#cb148-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(followers)) <span class="sc">%&gt;%</span> </span>
<span id="cb148-515"><a href="#cb148-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"followers"</span>))</span>
<span id="cb148-516"><a href="#cb148-516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-517"><a href="#cb148-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-518"><a href="#cb148-518" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Processing</span></span>
<span id="cb148-519"><a href="#cb148-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-520"><a href="#cb148-520" aria-hidden="true" tabindex="-1"></a><span class="fu">## Convert the data in an edgelist format</span></span>
<span id="cb148-521"><a href="#cb148-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-522"><a href="#cb148-522" aria-hidden="true" tabindex="-1"></a>To analyze this data in a perspective of social network, I need to convert this data into an edgelist where from_nodes are K-pop top artists, to_nodes are artists who collaborated with them, and edges are songs.</span>
<span id="cb148-523"><a href="#cb148-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-526"><a href="#cb148-526" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-527"><a href="#cb148-527" aria-hidden="true" tabindex="-1"></a><span class="co"># convert collab_songs to edgelist</span></span>
<span id="cb148-528"><a href="#cb148-528" aria-hidden="true" tabindex="-1"></a>edgelist <span class="ot">&lt;-</span> collab_songs <span class="sc">%&gt;%</span></span>
<span id="cb148-529"><a href="#cb148-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb148-530"><a href="#cb148-530" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"artist_id_"</span>),</span>
<span id="cb148-531"><a href="#cb148-531" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"variable"</span>,</span>
<span id="cb148-532"><a href="#cb148-532" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"to_artist_id"</span></span>
<span id="cb148-533"><a href="#cb148-533" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">%&gt;%</span> </span>
<span id="cb148-534"><a href="#cb148-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(to_artist_id)) <span class="sc">%&gt;%</span> <span class="co"># Remove the rows where the to_artist_id is blank </span></span>
<span id="cb148-535"><a href="#cb148-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(artist_id <span class="sc">!=</span> to_artist_id) <span class="sc">%&gt;%</span>  <span class="co"># Remove the rows where from_artist and to_artist are the same </span></span>
<span id="cb148-536"><a href="#cb148-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"artist_id"</span>, <span class="st">"to_artist_id"</span>, <span class="st">"song_id"</span>, <span class="st">"song_name"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb148-537"><a href="#cb148-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(artists, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"artist_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb148-538"><a href="#cb148-538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"artist_id"</span>, <span class="st">"to_artist_id"</span>, <span class="st">"song_id"</span>, <span class="st">"song_name"</span>, <span class="st">"name"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb148-539"><a href="#cb148-539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(artists, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to_artist_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb148-540"><a href="#cb148-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"artist_id"</span>, <span class="st">"to_artist_id"</span>, <span class="st">"song_id"</span>, <span class="st">"song_name"</span>, <span class="st">"name.x"</span>, <span class="st">"name.y"</span>, <span class="st">"region_category"</span>))</span>
<span id="cb148-541"><a href="#cb148-541" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-542"><a href="#cb148-542" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb148-543"><a href="#cb148-543" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the name of columns</span></span>
<span id="cb148-544"><a href="#cb148-544" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(edgelist) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"From"</span>, <span class="st">"To"</span>, <span class="st">"song_id"</span>, <span class="st">"song_name"</span>, <span class="st">"From_artists"</span>, <span class="st">"To_artists"</span>, <span class="st">"Collab_region1"</span>)</span>
<span id="cb148-545"><a href="#cb148-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-546"><a href="#cb148-546" aria-hidden="true" tabindex="-1"></a><span class="co"># Add new columns of collaboration types</span></span>
<span id="cb148-547"><a href="#cb148-547" aria-hidden="true" tabindex="-1"></a>edgelist <span class="ot">&lt;-</span> edgelist <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb148-548"><a href="#cb148-548" aria-hidden="true" tabindex="-1"></a>  <span class="at">Collab_region2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb148-549"><a href="#cb148-549" aria-hidden="true" tabindex="-1"></a>    Collab_region1 <span class="sc">==</span> <span class="st">"K-pop"</span> <span class="sc">~</span> <span class="st">"Domestic/Unknown"</span>,</span>
<span id="cb148-550"><a href="#cb148-550" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"International"</span></span>
<span id="cb148-551"><a href="#cb148-551" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb148-552"><a href="#cb148-552" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb148-553"><a href="#cb148-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-554"><a href="#cb148-554" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column of release year</span></span>
<span id="cb148-555"><a href="#cb148-555" aria-hidden="true" tabindex="-1"></a>edgelist <span class="ot">&lt;-</span> edgelist <span class="sc">%&gt;%</span> </span>
<span id="cb148-556"><a href="#cb148-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(song_detail, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"song_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb148-557"><a href="#cb148-557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"From"</span>, <span class="st">"To"</span>, <span class="st">"song_id"</span>, <span class="st">"song_name"</span>, <span class="st">"From_artists"</span>, <span class="st">"To_artists"</span>, <span class="st">"Collab_region1"</span>, <span class="st">"Collab_region2"</span>, <span class="st">"release_year"</span>, <span class="st">"popularity"</span>))</span>
<span id="cb148-558"><a href="#cb148-558" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-559"><a href="#cb148-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-562"><a href="#cb148-562" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-563"><a href="#cb148-563" aria-hidden="true" tabindex="-1"></a><span class="co"># convert edgelist into a graph</span></span>
<span id="cb148-564"><a href="#cb148-564" aria-hidden="true" tabindex="-1"></a>collab.net <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_data_frame</span>(edgelist, <span class="at">directed =</span> <span class="cn">FALSE</span>, <span class="at">vertices =</span> artists)</span>
<span id="cb148-565"><a href="#cb148-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-566"><a href="#cb148-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-567"><a href="#cb148-567" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-568"><a href="#cb148-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-571"><a href="#cb148-571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-572"><a href="#cb148-572" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting the attributes</span></span>
<span id="cb148-573"><a href="#cb148-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-574"><a href="#cb148-574" aria-hidden="true" tabindex="-1"></a><span class="co"># # For visualization</span></span>
<span id="cb148-575"><a href="#cb148-575" aria-hidden="true" tabindex="-1"></a><span class="co"># ## color</span></span>
<span id="cb148-576"><a href="#cb148-576" aria-hidden="true" tabindex="-1"></a>artists <span class="ot">&lt;-</span> artists <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb148-577"><a href="#cb148-577" aria-hidden="true" tabindex="-1"></a>  <span class="at">color_region_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb148-578"><a href="#cb148-578" aria-hidden="true" tabindex="-1"></a>    region_category <span class="sc">==</span> <span class="st">"K-pop"</span> <span class="sc">~</span> <span class="st">"#FFFFE1"</span>,</span>
<span id="cb148-579"><a href="#cb148-579" aria-hidden="true" tabindex="-1"></a>    region_category <span class="sc">==</span> <span class="st">"Latin"</span> <span class="sc">~</span> <span class="st">"darkgreen"</span>,</span>
<span id="cb148-580"><a href="#cb148-580" aria-hidden="true" tabindex="-1"></a>    region_category <span class="sc">==</span> <span class="st">"South East Asia"</span> <span class="sc">~</span> <span class="st">"#FDCCCC"</span>,</span>
<span id="cb148-581"><a href="#cb148-581" aria-hidden="true" tabindex="-1"></a>    region_category <span class="sc">==</span> <span class="st">"East Asia"</span> <span class="sc">~</span> <span class="st">"#920002"</span>,</span>
<span id="cb148-582"><a href="#cb148-582" aria-hidden="true" tabindex="-1"></a>    region_category <span class="sc">==</span> <span class="st">"Europe"</span> <span class="sc">~</span> <span class="st">"#ABD7E6"</span>,</span>
<span id="cb148-583"><a href="#cb148-583" aria-hidden="true" tabindex="-1"></a>    region_category <span class="sc">==</span> <span class="st">"US or Other"</span> <span class="sc">~</span> <span class="st">"deepskyblue3"</span>,</span>
<span id="cb148-584"><a href="#cb148-584" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"darkgrey"</span> ),</span>
<span id="cb148-585"><a href="#cb148-585" aria-hidden="true" tabindex="-1"></a>  <span class="at">color_kpop =</span> <span class="fu">case_when</span>(</span>
<span id="cb148-586"><a href="#cb148-586" aria-hidden="true" tabindex="-1"></a>    kpop <span class="sc">==</span> <span class="st">"yes"</span> <span class="sc">~</span> <span class="st">"#FFFFE1"</span>,</span>
<span id="cb148-587"><a href="#cb148-587" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"#010087"</span></span>
<span id="cb148-588"><a href="#cb148-588" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb148-589"><a href="#cb148-589" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb148-590"><a href="#cb148-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-591"><a href="#cb148-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-592"><a href="#cb148-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-593"><a href="#cb148-593" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(collab.net)<span class="sc">$</span>color <span class="ot">&lt;-</span> artists<span class="sc">$</span>color_region_category</span>
<span id="cb148-594"><a href="#cb148-594" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-595"><a href="#cb148-595" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-596"><a href="#cb148-596" aria-hidden="true" tabindex="-1"></a><span class="co"># V(collab.net)$name_kpop_top &lt;- artists$show_name_kpop_top</span></span>
<span id="cb148-597"><a href="#cb148-597" aria-hidden="true" tabindex="-1"></a><span class="co"># V(collab.net)$name_followers &lt;- artists$show_name_followers</span></span>
<span id="cb148-598"><a href="#cb148-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-599"><a href="#cb148-599" aria-hidden="true" tabindex="-1"></a><span class="co">#edgelist &lt;- edgelist %&gt;% left_join(song_detail, by = c("song_id"="id"))</span></span>
<span id="cb148-600"><a href="#cb148-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-601"><a href="#cb148-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-602"><a href="#cb148-602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-603"><a href="#cb148-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-604"><a href="#cb148-604" aria-hidden="true" tabindex="-1"></a>This graph contains 1519 edges (collaboration songs) by 962 artists in the last 20 years.</span>
<span id="cb148-605"><a href="#cb148-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-608"><a href="#cb148-608" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-609"><a href="#cb148-609" aria-hidden="true" tabindex="-1"></a><span class="co"># Check attributes</span></span>
<span id="cb148-610"><a href="#cb148-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-611"><a href="#cb148-611" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(collab.net) </span>
<span id="cb148-612"><a href="#cb148-612" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">vertex_attr_names</span>(collab.net)</span>
<span id="cb148-613"><a href="#cb148-613" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">edge_attr_names</span>(collab.net)</span>
<span id="cb148-614"><a href="#cb148-614" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-615"><a href="#cb148-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-616"><a href="#cb148-616" aria-hidden="true" tabindex="-1"></a><span class="fu"># (Total) Overview of K-pop collaboration network</span></span>
<span id="cb148-617"><a href="#cb148-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-618"><a href="#cb148-618" aria-hidden="true" tabindex="-1"></a>This is the graph of the last 20 years' K-pop collaboration.</span>
<span id="cb148-619"><a href="#cb148-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-622"><a href="#cb148-622" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-623"><a href="#cb148-623" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(collab.net,</span>
<span id="cb148-624"><a href="#cb148-624" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label =</span> <span class="cn">NA</span>,</span>
<span id="cb148-625"><a href="#cb148-625" aria-hidden="true" tabindex="-1"></a>     <span class="at">arrow.mode=</span><span class="st">"-"</span>,</span>
<span id="cb148-626"><a href="#cb148-626" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size =</span> <span class="fu">log</span>(<span class="fu">V</span>(collab.net)<span class="sc">$</span>followers) <span class="sc">*</span> <span class="fl">0.4</span>,</span>
<span id="cb148-627"><a href="#cb148-627" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.cex =</span> .<span class="dv">4</span>,</span>
<span id="cb148-628"><a href="#cb148-628" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.color =</span> <span class="st">"black"</span>,</span>
<span id="cb148-629"><a href="#cb148-629" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.frame.color =</span> <span class="st">'lightgrey'</span>,</span>
<span id="cb148-630"><a href="#cb148-630" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.dist =</span> <span class="dv">0</span>,</span>
<span id="cb148-631"><a href="#cb148-631" aria-hidden="true" tabindex="-1"></a>     <span class="at">frame.width =</span> <span class="dv">0</span>,</span>
<span id="cb148-632"><a href="#cb148-632" aria-hidden="true" tabindex="-1"></a>     <span class="at">color =</span> <span class="fu">V</span>(collab.net)<span class="sc">$</span>color_region_category,</span>
<span id="cb148-633"><a href="#cb148-633" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"K pop collaboration network for the last 20 years"</span>,</span>
<span id="cb148-634"><a href="#cb148-634" aria-hidden="true" tabindex="-1"></a>     <span class="at">ref =</span> <span class="st">"The size of the circles means the popularity"</span></span>
<span id="cb148-635"><a href="#cb148-635" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb148-636"><a href="#cb148-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-637"><a href="#cb148-637" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb148-638"><a href="#cb148-638" aria-hidden="true" tabindex="-1"></a>  <span class="st">"bottomright"</span>,</span>
<span id="cb148-639"><a href="#cb148-639" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"K-pop"</span>, <span class="st">"Latin"</span>, <span class="st">"East Asia"</span>, <span class="st">"South East Asia"</span>, <span class="st">"Europe"</span>, <span class="st">"US or Other"</span>, <span class="st">"Unknown"</span>),</span>
<span id="cb148-640"><a href="#cb148-640" aria-hidden="true" tabindex="-1"></a>  <span class="at">pt.bg  =</span> <span class="fu">c</span>(<span class="st">"#FFFFE1"</span>, <span class="st">"darkgreen"</span>, <span class="st">"#920002"</span>,<span class="st">"#FDCCCC"</span>, <span class="st">"#ABD7E6"</span>, <span class="st">"deepskyblue3"</span>, <span class="st">"darkgrey"</span>),</span>
<span id="cb148-641"><a href="#cb148-641" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch    =</span> <span class="dv">21</span>,</span>
<span id="cb148-642"><a href="#cb148-642" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex    =</span> <span class="dv">1</span>,</span>
<span id="cb148-643"><a href="#cb148-643" aria-hidden="true" tabindex="-1"></a>  <span class="at">bty    =</span> <span class="st">"n"</span>,</span>
<span id="cb148-644"><a href="#cb148-644" aria-hidden="true" tabindex="-1"></a>  <span class="at">title  =</span> <span class="st">"Genre"</span></span>
<span id="cb148-645"><a href="#cb148-645" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb148-646"><a href="#cb148-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-647"><a href="#cb148-647" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-648"><a href="#cb148-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-649"><a href="#cb148-649" aria-hidden="true" tabindex="-1"></a><span class="fu"># Network overview</span></span>
<span id="cb148-650"><a href="#cb148-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-651"><a href="#cb148-651" aria-hidden="true" tabindex="-1"></a><span class="fu">## Nodes and Edges</span></span>
<span id="cb148-652"><a href="#cb148-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-653"><a href="#cb148-653" aria-hidden="true" tabindex="-1"></a>As mentioned, this network consists of 962 nodes (artists) and 1519 edges. The number of edges and the number of songs are not the same because one song can have more than 2 artists.</span>
<span id="cb148-654"><a href="#cb148-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-657"><a href="#cb148-657" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-658"><a href="#cb148-658" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">vcount</span>(collab.net))</span>
<span id="cb148-659"><a href="#cb148-659" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">ecount</span>(collab.net))</span>
<span id="cb148-660"><a href="#cb148-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-661"><a href="#cb148-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-662"><a href="#cb148-662" aria-hidden="true" tabindex="-1"></a><span class="fu">## Density and transitivity</span></span>
<span id="cb148-663"><a href="#cb148-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-664"><a href="#cb148-664" aria-hidden="true" tabindex="-1"></a>Density and transitivity of K-pop collaboration network is not high.</span>
<span id="cb148-665"><a href="#cb148-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-668"><a href="#cb148-668" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-669"><a href="#cb148-669" aria-hidden="true" tabindex="-1"></a><span class="co"># Density</span></span>
<span id="cb148-670"><a href="#cb148-670" aria-hidden="true" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">edge_density</span>(collab.net)</span>
<span id="cb148-671"><a href="#cb148-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-672"><a href="#cb148-672" aria-hidden="true" tabindex="-1"></a><span class="co"># Transitivity</span></span>
<span id="cb148-673"><a href="#cb148-673" aria-hidden="true" tabindex="-1"></a><span class="fu">transitivity</span>(collab.net)</span>
<span id="cb148-674"><a href="#cb148-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-675"><a href="#cb148-675" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-676"><a href="#cb148-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-677"><a href="#cb148-677" aria-hidden="true" tabindex="-1"></a><span class="fu">## Degree</span></span>
<span id="cb148-678"><a href="#cb148-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-679"><a href="#cb148-679" aria-hidden="true" tabindex="-1"></a>This is analysis on nodes.</span>
<span id="cb148-680"><a href="#cb148-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-683"><a href="#cb148-683" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-684"><a href="#cb148-684" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb148-685"><a href="#cb148-685" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">V</span>(collab.net)<span class="sc">$</span>name,</span>
<span id="cb148-686"><a href="#cb148-686" aria-hidden="true" tabindex="-1"></a>  <span class="at">total.degree =</span> <span class="fu">degree</span>(collab.net, <span class="at">mode =</span> <span class="st">'total'</span>),</span>
<span id="cb148-687"><a href="#cb148-687" aria-hidden="true" tabindex="-1"></a>  <span class="at">eigen.centrality =</span> <span class="fu">evcent</span>(collab.net)<span class="sc">$</span>vector)</span>
<span id="cb148-688"><a href="#cb148-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-689"><a href="#cb148-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-690"><a href="#cb148-690" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb148-691"><a href="#cb148-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-692"><a href="#cb148-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-693"><a href="#cb148-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-694"><a href="#cb148-694" aria-hidden="true" tabindex="-1"></a>nodes <span class="sc">%&gt;%</span> melt <span class="sc">%&gt;%</span> </span>
<span id="cb148-695"><a href="#cb148-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> variable, <span class="at">color =</span> variable)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">alpha =</span> .<span class="dv">2</span>, <span class="at">bw =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb148-696"><a href="#cb148-696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Degree Distribution'</span>)</span>
<span id="cb148-697"><a href="#cb148-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-698"><a href="#cb148-698" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-699"><a href="#cb148-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-700"><a href="#cb148-700" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dyad Census</span></span>
<span id="cb148-701"><a href="#cb148-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-702"><a href="#cb148-702" aria-hidden="true" tabindex="-1"></a>It is expected that there is no asymmetry dyad because collaboration network is NOT directed. There are quite many null dyads, meaning that there are many artists that don't work together.</span>
<span id="cb148-703"><a href="#cb148-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-706"><a href="#cb148-706" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-707"><a href="#cb148-707" aria-hidden="true" tabindex="-1"></a><span class="fu">dyad.census</span>(collab.net)</span>
<span id="cb148-708"><a href="#cb148-708" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-709"><a href="#cb148-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-710"><a href="#cb148-710" aria-hidden="true" tabindex="-1"></a><span class="fu">## Triad Census</span></span>
<span id="cb148-711"><a href="#cb148-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-712"><a href="#cb148-712" aria-hidden="true" tabindex="-1"></a>Most triads are empty because when artist A works with artist B, they don't work with the same artists.</span>
<span id="cb148-713"><a href="#cb148-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-716"><a href="#cb148-716" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-717"><a href="#cb148-717" aria-hidden="true" tabindex="-1"></a>triad.labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A,B,C, the empty graph."</span>,</span>
<span id="cb148-718"><a href="#cb148-718" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A-&gt;B, C, the graph with a single directed edge."</span>,</span>
<span id="cb148-719"><a href="#cb148-719" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A&lt;-&gt;B, C, the graph with a mutual connection between two vertices."</span>,</span>
<span id="cb148-720"><a href="#cb148-720" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A&lt;-B-&gt;C, the out-star."</span>,</span>
<span id="cb148-721"><a href="#cb148-721" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A-&gt;B&lt;-C, the in-star."</span>,</span>
<span id="cb148-722"><a href="#cb148-722" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A-&gt;B-&gt;C, directed line."</span>,<span class="st">"A&lt;-&gt;B&lt;-C."</span>,</span>
<span id="cb148-723"><a href="#cb148-723" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A&lt;-&gt;B-&gt;C."</span>,</span>
<span id="cb148-724"><a href="#cb148-724" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A-&gt;B&lt;-C, A-&gt;C."</span>,</span>
<span id="cb148-725"><a href="#cb148-725" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A&lt;-B&lt;-C, A-&gt;C."</span>,</span>
<span id="cb148-726"><a href="#cb148-726" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A&lt;-&gt;B&lt;-&gt;C."</span>,</span>
<span id="cb148-727"><a href="#cb148-727" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A&lt;-B-&gt;C, A&lt;-&gt;C."</span>,</span>
<span id="cb148-728"><a href="#cb148-728" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A-&gt;B&lt;-C, A&lt;-&gt;C."</span>,</span>
<span id="cb148-729"><a href="#cb148-729" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A-&gt;B-&gt;C, A&lt;-&gt;C."</span>,</span>
<span id="cb148-730"><a href="#cb148-730" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A-&gt;B&lt;-&gt;C, A&lt;-&gt;C."</span>,</span>
<span id="cb148-731"><a href="#cb148-731" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"A&lt;-&gt;B&lt;-&gt;C, A&lt;-&gt;C, the complete graph."</span>)</span>
<span id="cb148-732"><a href="#cb148-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-733"><a href="#cb148-733" aria-hidden="true" tabindex="-1"></a>triad.census.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">label =</span> triad.labels, <span class="at">collab.net =</span> <span class="fu">triad.census</span>(collab.net)) <span class="sc">%&gt;%</span> melt</span>
<span id="cb148-734"><a href="#cb148-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-735"><a href="#cb148-735" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(triad.census.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'triad'</span>, <span class="st">'network'</span>, <span class="st">'value'</span>)</span>
<span id="cb148-736"><a href="#cb148-736" aria-hidden="true" tabindex="-1"></a>triad.census.data <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> triad, <span class="at">fill =</span> network)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>, <span class="at">position =</span> <span class="st">'dodge'</span>)</span>
<span id="cb148-737"><a href="#cb148-737" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-738"><a href="#cb148-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-739"><a href="#cb148-739" aria-hidden="true" tabindex="-1"></a><span class="fu">## Transitivity</span></span>
<span id="cb148-740"><a href="#cb148-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-743"><a href="#cb148-743" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-744"><a href="#cb148-744" aria-hidden="true" tabindex="-1"></a>nodes<span class="sc">$</span>transitivity <span class="ot">&lt;-</span> <span class="fu">transitivity</span>(collab.net, <span class="at">type =</span> <span class="st">'local'</span>)</span>
<span id="cb148-745"><a href="#cb148-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-746"><a href="#cb148-746" aria-hidden="true" tabindex="-1"></a><span class="fu">melt</span>(nodes) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">'transitivity'</span> <span class="sc">|</span> variable <span class="sc">==</span> <span class="st">'weighted.transitivity'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb148-747"><a href="#cb148-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> variable, <span class="at">color =</span> variable)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb148-748"><a href="#cb148-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Transitivity Distribution'</span>)</span>
<span id="cb148-749"><a href="#cb148-749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-750"><a href="#cb148-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-751"><a href="#cb148-751" aria-hidden="true" tabindex="-1"></a><span class="fu">## Component Structure</span></span>
<span id="cb148-752"><a href="#cb148-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-753"><a href="#cb148-753" aria-hidden="true" tabindex="-1"></a>There are more than 110 components in this network. Most of them have members less than 25.</span>
<span id="cb148-754"><a href="#cb148-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-757"><a href="#cb148-757" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-758"><a href="#cb148-758" aria-hidden="true" tabindex="-1"></a>wc.collab.net <span class="ot">&lt;-</span> <span class="fu">cluster_walktrap</span>(collab.net)</span>
<span id="cb148-759"><a href="#cb148-759" aria-hidden="true" tabindex="-1"></a>member <span class="ot">&lt;-</span> <span class="fu">membership</span>(wc.collab.net)</span>
<span id="cb148-760"><a href="#cb148-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-761"><a href="#cb148-761" aria-hidden="true" tabindex="-1"></a>nodes<span class="sc">$</span>member <span class="ot">&lt;-</span> member</span>
<span id="cb148-762"><a href="#cb148-762" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(member) <span class="sc">%&gt;%</span> melt <span class="sc">%&gt;%</span> ggplot <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(member, <span class="sc">-</span> value), <span class="at">y =</span> value, <span class="at">fill =</span> <span class="fu">factor</span>(member)), <span class="at">stat =</span> <span class="st">'identity'</span>)</span>
<span id="cb148-763"><a href="#cb148-763" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-764"><a href="#cb148-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-765"><a href="#cb148-765" aria-hidden="true" tabindex="-1"></a><span class="fu"># Closer look</span></span>
<span id="cb148-766"><a href="#cb148-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-767"><a href="#cb148-767" aria-hidden="true" tabindex="-1"></a>Since the graph of 20 years doesn't give information about how K-pop collaboration has evolved so I analyzed the graph by year. There are few collaboration songs before 2005, so from here I will limit my analysis to the time span from 2005 till present (as of May 17, 2023).</span>
<span id="cb148-768"><a href="#cb148-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-771"><a href="#cb148-771" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-772"><a href="#cb148-772" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a graph for each year</span></span>
<span id="cb148-773"><a href="#cb148-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-774"><a href="#cb148-774" aria-hidden="true" tabindex="-1"></a>graph_from_data_frame_with_all_vertices <span class="ot">&lt;-</span> <span class="cf">function</span>(df, vertices) {</span>
<span id="cb148-775"><a href="#cb148-775" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with all possible edges between vertices</span></span>
<span id="cb148-776"><a href="#cb148-776" aria-hidden="true" tabindex="-1"></a>  unique_vertices <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(df<span class="sc">$</span>From, df<span class="sc">$</span>To))</span>
<span id="cb148-777"><a href="#cb148-777" aria-hidden="true" tabindex="-1"></a>  artists_period <span class="ot">&lt;-</span> artists[artists<span class="sc">$</span>id <span class="sc">%in%</span> unique_vertices, ]</span>
<span id="cb148-778"><a href="#cb148-778" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the graph with all vertices and existing edges</span></span>
<span id="cb148-779"><a href="#cb148-779" aria-hidden="true" tabindex="-1"></a>  graph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(df, <span class="at">directed =</span> <span class="cn">FALSE</span>, <span class="at">vertices =</span> artists_period)</span>
<span id="cb148-780"><a href="#cb148-780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(graph)</span>
<span id="cb148-781"><a href="#cb148-781" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb148-782"><a href="#cb148-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-783"><a href="#cb148-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-784"><a href="#cb148-784" aria-hidden="true" tabindex="-1"></a>graphs_year <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>, <span class="cf">function</span>(x) <span class="fu">graph_from_data_frame_with_all_vertices</span>(<span class="at">df =</span> edgelist[edgelist<span class="sc">$</span>release_year <span class="sc">==</span> x, ], <span class="at">vertices =</span> artists))</span>
<span id="cb148-785"><a href="#cb148-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-786"><a href="#cb148-786" aria-hidden="true" tabindex="-1"></a>periods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>)</span>
<span id="cb148-787"><a href="#cb148-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-788"><a href="#cb148-788" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:length(graphs_year)) {</span></span>
<span id="cb148-789"><a href="#cb148-789" aria-hidden="true" tabindex="-1"></a><span class="co">#   V(graphs_year[[i]])$color &lt;- V(graphs_year[[i]])$color_region_category</span></span>
<span id="cb148-790"><a href="#cb148-790" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot(graphs_year[[i]], </span></span>
<span id="cb148-791"><a href="#cb148-791" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.label = V(graphs_year[[i]])$show_kpop_top,</span></span>
<span id="cb148-792"><a href="#cb148-792" aria-hidden="true" tabindex="-1"></a><span class="co">#      arrow.mode="-",</span></span>
<span id="cb148-793"><a href="#cb148-793" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.size = log(V(graphs_year[[i]])$followers) * 0.7,</span></span>
<span id="cb148-794"><a href="#cb148-794" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.label.cex = .8,</span></span>
<span id="cb148-795"><a href="#cb148-795" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.label.color = "black",</span></span>
<span id="cb148-796"><a href="#cb148-796" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.label.dist = 0,</span></span>
<span id="cb148-797"><a href="#cb148-797" aria-hidden="true" tabindex="-1"></a><span class="co">#      frame.width = 0,</span></span>
<span id="cb148-798"><a href="#cb148-798" aria-hidden="true" tabindex="-1"></a><span class="co">#      color = V(graphs_year[[i]])$color_region_category,</span></span>
<span id="cb148-799"><a href="#cb148-799" aria-hidden="true" tabindex="-1"></a><span class="co">#      main = paste0("Collaboration by K-pop top artists ", periods[[i]])</span></span>
<span id="cb148-800"><a href="#cb148-800" aria-hidden="true" tabindex="-1"></a><span class="co">#      )</span></span>
<span id="cb148-801"><a href="#cb148-801" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-802"><a href="#cb148-802" aria-hidden="true" tabindex="-1"></a><span class="co">#   legend(</span></span>
<span id="cb148-803"><a href="#cb148-803" aria-hidden="true" tabindex="-1"></a><span class="co">#     "bottomright",</span></span>
<span id="cb148-804"><a href="#cb148-804" aria-hidden="true" tabindex="-1"></a><span class="co">#     legend = c("K-pop", "Latin", "East Asia", "South East Asia", "Europe", "US or Other", "Unknown"),</span></span>
<span id="cb148-805"><a href="#cb148-805" aria-hidden="true" tabindex="-1"></a><span class="co">#     pt.bg  = c("#FFFFE1", "darkgreen", "#920002","#FDCCCC", "#ABD7E6", "#010087", "darkgrey"),</span></span>
<span id="cb148-806"><a href="#cb148-806" aria-hidden="true" tabindex="-1"></a><span class="co">#     pch    = 21,</span></span>
<span id="cb148-807"><a href="#cb148-807" aria-hidden="true" tabindex="-1"></a><span class="co">#     cex    = 1,</span></span>
<span id="cb148-808"><a href="#cb148-808" aria-hidden="true" tabindex="-1"></a><span class="co">#     bty    = "n",</span></span>
<span id="cb148-809"><a href="#cb148-809" aria-hidden="true" tabindex="-1"></a><span class="co">#     title  = "Genre"</span></span>
<span id="cb148-810"><a href="#cb148-810" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb148-811"><a href="#cb148-811" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb148-812"><a href="#cb148-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-813"><a href="#cb148-813" aria-hidden="true" tabindex="-1"></a>graph_stats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>, </span>
<span id="cb148-814"><a href="#cb148-814" aria-hidden="true" tabindex="-1"></a>                          <span class="at">num_nodes =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>)), </span>
<span id="cb148-815"><a href="#cb148-815" aria-hidden="true" tabindex="-1"></a>                          <span class="at">num_edges =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>)), </span>
<span id="cb148-816"><a href="#cb148-816" aria-hidden="true" tabindex="-1"></a>                          <span class="at">num_songs =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>)),</span>
<span id="cb148-817"><a href="#cb148-817" aria-hidden="true" tabindex="-1"></a>                          <span class="at">artists_per_song =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>)),</span>
<span id="cb148-818"><a href="#cb148-818" aria-hidden="true" tabindex="-1"></a>                          <span class="at">centralization =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>)), </span>
<span id="cb148-819"><a href="#cb148-819" aria-hidden="true" tabindex="-1"></a>                          <span class="at">density =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>)), </span>
<span id="cb148-820"><a href="#cb148-820" aria-hidden="true" tabindex="-1"></a>                          <span class="at">transitivity =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="dv">2006</span><span class="sc">:</span><span class="dv">2023</span>))</span>
<span id="cb148-821"><a href="#cb148-821" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb148-822"><a href="#cb148-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-823"><a href="#cb148-823" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each year and calculate the desired graph statistics</span></span>
<span id="cb148-824"><a href="#cb148-824" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(graphs_year)) {</span>
<span id="cb148-825"><a href="#cb148-825" aria-hidden="true" tabindex="-1"></a>  graph <span class="ot">&lt;-</span> graphs_year[[i]]</span>
<span id="cb148-826"><a href="#cb148-826" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-827"><a href="#cb148-827" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fill in the corresponding row of the data frame with the calculated statistics</span></span>
<span id="cb148-828"><a href="#cb148-828" aria-hidden="true" tabindex="-1"></a>  graph_stats[i, <span class="st">"num_nodes"</span>] <span class="ot">&lt;-</span> <span class="fu">vcount</span>(graph)</span>
<span id="cb148-829"><a href="#cb148-829" aria-hidden="true" tabindex="-1"></a>  graph_stats[i, <span class="st">"num_edges"</span>] <span class="ot">&lt;-</span> <span class="fu">ecount</span>(graph)</span>
<span id="cb148-830"><a href="#cb148-830" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-831"><a href="#cb148-831" aria-hidden="true" tabindex="-1"></a>  song_ids <span class="ot">&lt;-</span> <span class="fu">E</span>(graph)<span class="sc">$</span>song_id</span>
<span id="cb148-832"><a href="#cb148-832" aria-hidden="true" tabindex="-1"></a>  num_unique_songs <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(song_ids))</span>
<span id="cb148-833"><a href="#cb148-833" aria-hidden="true" tabindex="-1"></a>  graph_stats[i, <span class="st">"num_songs"</span>] <span class="ot">&lt;-</span> num_unique_songs</span>
<span id="cb148-834"><a href="#cb148-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-835"><a href="#cb148-835" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-836"><a href="#cb148-836" aria-hidden="true" tabindex="-1"></a>  graph_stats[i, <span class="st">"centralization"</span>] <span class="ot">&lt;-</span> <span class="fu">centr_degree</span>(graph)<span class="sc">$</span>centralization</span>
<span id="cb148-837"><a href="#cb148-837" aria-hidden="true" tabindex="-1"></a>  graph_stats[i, <span class="st">"density"</span>] <span class="ot">&lt;-</span> <span class="fu">graph.density</span>(graph)</span>
<span id="cb148-838"><a href="#cb148-838" aria-hidden="true" tabindex="-1"></a>  graph_stats[i, <span class="st">"transitivity"</span>] <span class="ot">&lt;-</span> <span class="fu">transitivity</span>(graph, <span class="at">type =</span> <span class="st">'global'</span>)</span>
<span id="cb148-839"><a href="#cb148-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-840"><a href="#cb148-840" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-841"><a href="#cb148-841" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb148-842"><a href="#cb148-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-843"><a href="#cb148-843" aria-hidden="true" tabindex="-1"></a>collab_by_years <span class="ot">&lt;-</span> edgelist <span class="sc">%&gt;%</span></span>
<span id="cb148-844"><a href="#cb148-844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(release_year) <span class="sc">%&gt;%</span></span>
<span id="cb148-845"><a href="#cb148-845" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb148-846"><a href="#cb148-846" aria-hidden="true" tabindex="-1"></a>    <span class="at">popularity =</span> <span class="fu">mean</span>(popularity),</span>
<span id="cb148-847"><a href="#cb148-847" aria-hidden="true" tabindex="-1"></a>    <span class="at">K_Pop =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"K-pop"</span>),</span>
<span id="cb148-848"><a href="#cb148-848" aria-hidden="true" tabindex="-1"></a>    <span class="at">US_Other =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"US or Other"</span>),</span>
<span id="cb148-849"><a href="#cb148-849" aria-hidden="true" tabindex="-1"></a>    <span class="at">E_Asia =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"East Asia"</span>),</span>
<span id="cb148-850"><a href="#cb148-850" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE_Asia =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"South East Asia"</span>),</span>
<span id="cb148-851"><a href="#cb148-851" aria-hidden="true" tabindex="-1"></a>    <span class="at">Latino =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"Latino"</span>),</span>
<span id="cb148-852"><a href="#cb148-852" aria-hidden="true" tabindex="-1"></a>    <span class="at">Europe =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"Europe"</span>),</span>
<span id="cb148-853"><a href="#cb148-853" aria-hidden="true" tabindex="-1"></a>    <span class="at">Unknown =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"Unknown"</span>)</span>
<span id="cb148-854"><a href="#cb148-854" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb148-855"><a href="#cb148-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-856"><a href="#cb148-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-857"><a href="#cb148-857" aria-hidden="true" tabindex="-1"></a>graph_stats <span class="ot">&lt;-</span> graph_stats <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(collab_by_years, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"year"</span> <span class="ot">=</span> <span class="st">"release_year"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb148-858"><a href="#cb148-858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">song_per_kpop_artists =</span> num_songs<span class="sc">/</span><span class="st">`</span><span class="at">K_Pop</span><span class="st">`</span>)</span>
<span id="cb148-859"><a href="#cb148-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-860"><a href="#cb148-860" aria-hidden="true" tabindex="-1"></a>graph_stats</span>
<span id="cb148-861"><a href="#cb148-861" aria-hidden="true" tabindex="-1"></a><span class="co"># (3 years moving average range) Closer look: How does the network change every year</span></span>
<span id="cb148-862"><a href="#cb148-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-863"><a href="#cb148-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-864"><a href="#cb148-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-865"><a href="#cb148-865" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-866"><a href="#cb148-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-869"><a href="#cb148-869" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-870"><a href="#cb148-870" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a plot with a bar chart and a line chart</span></span>
<span id="cb148-871"><a href="#cb148-871" aria-hidden="true" tabindex="-1"></a>graph_stats <span class="sc">%&gt;%</span></span>
<span id="cb148-872"><a href="#cb148-872" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"K_Pop"</span>, <span class="st">"US_Other"</span>, <span class="st">"E_Asia"</span>, <span class="st">"SE_Asia"</span>, <span class="st">"Latino"</span>, <span class="st">"Europe"</span>, <span class="st">"Unknown"</span>), <span class="at">names_to =</span> <span class="st">"collab_region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb148-873"><a href="#cb148-873" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">collab_region =</span> <span class="fu">factor</span>(collab_region, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"K_Pop"</span>, <span class="st">"US_Other"</span>, <span class="st">"E_Asia"</span>, <span class="st">"SE_Asia"</span>, <span class="st">"Latino"</span>, <span class="st">"Europe"</span>, <span class="st">"Unknown"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb148-874"><a href="#cb148-874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year)) <span class="sc">+</span></span>
<span id="cb148-875"><a href="#cb148-875" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> value, <span class="at">fill =</span> collab_region), <span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb148-876"><a href="#cb148-876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Number"</span>, <span class="at">x =</span> <span class="st">"year"</span>, <span class="at">title =</span> <span class="st">"The number of K-pop collaboration songs"</span>, <span class="at">sub =</span> <span class="st">"After around 2017 the number of international collaboration songs increased."</span>)  <span class="sc">+</span></span>
<span id="cb148-877"><a href="#cb148-877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">" "</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"num_edges"</span> <span class="ot">=</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb148-878"><a href="#cb148-878" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"Collab Region"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"K_Pop"</span> <span class="ot">=</span> <span class="st">"#FFFFE1"</span>, <span class="st">"Latino"</span> <span class="ot">=</span> <span class="st">"darkgreen"</span>, <span class="st">"E_Asia"</span> <span class="ot">=</span> <span class="st">"#920002"</span>,</span>
<span id="cb148-879"><a href="#cb148-879" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">"SE_Asia"</span> <span class="ot">=</span> <span class="st">"#FDCCCC"</span>, <span class="st">"Europe"</span> <span class="ot">=</span> <span class="st">"#ABD7E6"</span>, <span class="st">"US_Other"</span> <span class="ot">=</span> <span class="st">"#010087"</span>,</span>
<span id="cb148-880"><a href="#cb148-880" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">"Unknown"</span> <span class="ot">=</span> <span class="st">"darkgrey"</span>))</span>
<span id="cb148-881"><a href="#cb148-881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb148-882"><a href="#cb148-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-883"><a href="#cb148-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-884"><a href="#cb148-884" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-885"><a href="#cb148-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-886"><a href="#cb148-886" aria-hidden="true" tabindex="-1"></a>This graph shows that around 2012, the number of collaboration songs among K-pop artists was limited, with few international collaborations. The network is sparse In 2014, the number of K-pop collaborations started increasing with more Western collaborations. Between 2015 and 2020, K-pop experienced significant growth in terms of the number and types of collaborations. The collaborations werenot limited to the US-based artists, but to small numbers of Latino, East-Asian, South East Asian, and Europe based artists. After 2021, the number of collaborations per year is decreased, and the proportion of collaborations involving K-pop artists with artists from the US or countries other than Korea has been increasing.</span>
<span id="cb148-887"><a href="#cb148-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-888"><a href="#cb148-888" aria-hidden="true" tabindex="-1"></a><span class="fu"># (By regime)</span></span>
<span id="cb148-889"><a href="#cb148-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-890"><a href="#cb148-890" aria-hidden="true" tabindex="-1"></a>The graph above illustrates that collaborations in K-pop have different characteristics depending on the era. Taking into account the aforementioned features and significant milestones in the history of K-pop, such as the 2012 breakout with "Gangnam Style" and the major advancement in the American market by BTS in 2017, I have decided to divide the period from 2005 to 2023 into four eras: 2005-2011, 2012-2016, 2017-2020, and 2021-2023.</span>
<span id="cb148-891"><a href="#cb148-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-894"><a href="#cb148-894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-895"><a href="#cb148-895" aria-hidden="true" tabindex="-1"></a>edgelist <span class="ot">&lt;-</span> edgelist <span class="sc">%&gt;%</span> </span>
<span id="cb148-896"><a href="#cb148-896" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb148-897"><a href="#cb148-897" aria-hidden="true" tabindex="-1"></a>    <span class="at">regime =</span> <span class="fu">case_when</span>(</span>
<span id="cb148-898"><a href="#cb148-898" aria-hidden="true" tabindex="-1"></a>      release_year <span class="sc">&lt;</span> <span class="dv">2012</span> <span class="sc">~</span> <span class="st">"2005-2011"</span>,</span>
<span id="cb148-899"><a href="#cb148-899" aria-hidden="true" tabindex="-1"></a>      release_year <span class="sc">&gt;=</span> <span class="dv">2012</span> <span class="sc">&amp;</span> release_year <span class="sc">&lt;</span> <span class="dv">2017</span> <span class="sc">~</span> <span class="st">"2012-2016"</span>,</span>
<span id="cb148-900"><a href="#cb148-900" aria-hidden="true" tabindex="-1"></a>      release_year <span class="sc">&gt;=</span> <span class="dv">2017</span> <span class="sc">&amp;</span> release_year <span class="sc">&lt;</span> <span class="dv">2021</span> <span class="sc">~</span> <span class="st">"2017-2020"</span>,</span>
<span id="cb148-901"><a href="#cb148-901" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"2021-"</span></span>
<span id="cb148-902"><a href="#cb148-902" aria-hidden="true" tabindex="-1"></a>    )) </span>
<span id="cb148-903"><a href="#cb148-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-904"><a href="#cb148-904" aria-hidden="true" tabindex="-1"></a>edgelist</span>
<span id="cb148-905"><a href="#cb148-905" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-906"><a href="#cb148-906" aria-hidden="true" tabindex="-1"></a><span class="co">#E(collab.net)$period &lt;- edgelist$period</span></span>
<span id="cb148-907"><a href="#cb148-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-908"><a href="#cb148-908" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-909"><a href="#cb148-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-912"><a href="#cb148-912" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-913"><a href="#cb148-913" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the edgelist dataframe into 4 groups based on "period"</span></span>
<span id="cb148-914"><a href="#cb148-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-915"><a href="#cb148-915" aria-hidden="true" tabindex="-1"></a>edgelist_list <span class="ot">&lt;-</span> <span class="fu">split</span>(edgelist, edgelist<span class="sc">$</span>regime)</span>
<span id="cb148-916"><a href="#cb148-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-917"><a href="#cb148-917" aria-hidden="true" tabindex="-1"></a><span class="co"># convert each element of the list into a separate dataframe</span></span>
<span id="cb148-918"><a href="#cb148-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-919"><a href="#cb148-919" aria-hidden="true" tabindex="-1"></a>graphs <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb148-920"><a href="#cb148-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-921"><a href="#cb148-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-922"><a href="#cb148-922" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(edgelist_list)) {</span>
<span id="cb148-923"><a href="#cb148-923" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"edgelist_"</span>, <span class="fu">names</span>(edgelist_list)[i]), edgelist_list[[i]])</span>
<span id="cb148-924"><a href="#cb148-924" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-925"><a href="#cb148-925" aria-hidden="true" tabindex="-1"></a>  unique_vertices <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(edgelist_list[[i]]<span class="sc">$</span>From, edgelist_list[[i]]<span class="sc">$</span>To))</span>
<span id="cb148-926"><a href="#cb148-926" aria-hidden="true" tabindex="-1"></a>  artists_period <span class="ot">&lt;-</span> artists[artists<span class="sc">$</span>id <span class="sc">%in%</span> unique_vertices, ]</span>
<span id="cb148-927"><a href="#cb148-927" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-928"><a href="#cb148-928" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the graph from the filtered edgelist and vertices</span></span>
<span id="cb148-929"><a href="#cb148-929" aria-hidden="true" tabindex="-1"></a>  graph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(edgelist_list[[i]], <span class="at">directed =</span> <span class="cn">FALSE</span>, <span class="at">vertices =</span> artists_period)</span>
<span id="cb148-930"><a href="#cb148-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-931"><a href="#cb148-931" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Append the graph to the list of graphs</span></span>
<span id="cb148-932"><a href="#cb148-932" aria-hidden="true" tabindex="-1"></a>  graphs[[i]] <span class="ot">&lt;-</span> graph</span>
<span id="cb148-933"><a href="#cb148-933" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb148-934"><a href="#cb148-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-935"><a href="#cb148-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-936"><a href="#cb148-936" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-937"><a href="#cb148-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-940"><a href="#cb148-940" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-941"><a href="#cb148-941" aria-hidden="true" tabindex="-1"></a><span class="co"># Assigning visualization attributes</span></span>
<span id="cb148-942"><a href="#cb148-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-943"><a href="#cb148-943" aria-hidden="true" tabindex="-1"></a>regime <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"2005-2011"</span>, <span class="st">"2012-2016"</span>, <span class="st">"2017-2020"</span>, <span class="st">"2021"</span>)</span>
<span id="cb148-944"><a href="#cb148-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-945"><a href="#cb148-945" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(graphs)) {</span>
<span id="cb148-946"><a href="#cb148-946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">V</span>(graphs[[i]])<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">V</span>(graphs[[i]])<span class="sc">$</span>color_region_category</span>
<span id="cb148-947"><a href="#cb148-947" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(graphs[[i]], </span>
<span id="cb148-948"><a href="#cb148-948" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label =</span> <span class="cn">NA</span>,</span>
<span id="cb148-949"><a href="#cb148-949" aria-hidden="true" tabindex="-1"></a>     <span class="at">arrow.mode=</span><span class="st">"-"</span>,</span>
<span id="cb148-950"><a href="#cb148-950" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size =</span> <span class="fu">log</span>(<span class="fu">V</span>(graphs[[i]])<span class="sc">$</span>followers) <span class="sc">*</span> <span class="fl">0.7</span>,</span>
<span id="cb148-951"><a href="#cb148-951" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.cex =</span> .<span class="dv">6</span>,</span>
<span id="cb148-952"><a href="#cb148-952" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.color =</span> <span class="st">"black"</span>,</span>
<span id="cb148-953"><a href="#cb148-953" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.dist =</span> <span class="dv">0</span>,</span>
<span id="cb148-954"><a href="#cb148-954" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.frame.color =</span> <span class="st">'lightgrey'</span>,</span>
<span id="cb148-955"><a href="#cb148-955" aria-hidden="true" tabindex="-1"></a>     <span class="at">frame.width =</span> <span class="dv">0</span>,</span>
<span id="cb148-956"><a href="#cb148-956" aria-hidden="true" tabindex="-1"></a>     <span class="at">color =</span> <span class="fu">V</span>(graphs[[i]])<span class="sc">$</span>color_region_category,</span>
<span id="cb148-957"><a href="#cb148-957" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"Collaboration by K-pop top artists</span><span class="sc">\n</span><span class="st">"</span>, regime[[i]])</span>
<span id="cb148-958"><a href="#cb148-958" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb148-959"><a href="#cb148-959" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-960"><a href="#cb148-960" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb148-961"><a href="#cb148-961" aria-hidden="true" tabindex="-1"></a>    <span class="st">"bottomright"</span>,</span>
<span id="cb148-962"><a href="#cb148-962" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"K-pop"</span>, <span class="st">"Latin"</span>, <span class="st">"East Asia"</span>, <span class="st">"South East Asia"</span>, <span class="st">"Europe"</span>, <span class="st">"US or Other"</span>, <span class="st">"Unknown"</span>),</span>
<span id="cb148-963"><a href="#cb148-963" aria-hidden="true" tabindex="-1"></a>    <span class="at">pt.bg  =</span> <span class="fu">c</span>(<span class="st">"#FFFFE1"</span>, <span class="st">"darkgreen"</span>, <span class="st">"#920002"</span>,<span class="st">"#FDCCCC"</span>, <span class="st">"#ABD7E6"</span>, <span class="st">"deepskyblue3"</span>, <span class="st">"darkgrey"</span>),</span>
<span id="cb148-964"><a href="#cb148-964" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch    =</span> <span class="dv">21</span>,</span>
<span id="cb148-965"><a href="#cb148-965" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex    =</span> <span class="dv">1</span>,</span>
<span id="cb148-966"><a href="#cb148-966" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty    =</span> <span class="st">"n"</span>,</span>
<span id="cb148-967"><a href="#cb148-967" aria-hidden="true" tabindex="-1"></a>    <span class="at">title  =</span> <span class="st">"Genre"</span></span>
<span id="cb148-968"><a href="#cb148-968" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb148-969"><a href="#cb148-969" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb148-970"><a href="#cb148-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-971"><a href="#cb148-971" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-972"><a href="#cb148-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-973"><a href="#cb148-973" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview: How the collaboration patterns have changed over time?</span></span>
<span id="cb148-974"><a href="#cb148-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-975"><a href="#cb148-975" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Between 2006 and 2010, the number of collaboration songs among K-pop artists was limited, with few international collaborations with artists outside of South Korea. Additionally, the network was sparse and disconnected.</span>
<span id="cb148-976"><a href="#cb148-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-977"><a href="#cb148-977" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>From 2011 to 2015, the number of collaboration songs slightly increased, with more international collaborations and a more connected network.</span>
<span id="cb148-978"><a href="#cb148-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-979"><a href="#cb148-979" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Between 2016 and 2020, K-pop experienced significant growth in terms of the number and types of collaborations. Notably, BTS, G(I)DLE, and Blackpink have a large number of international collaboration songs.</span>
<span id="cb148-980"><a href="#cb148-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-981"><a href="#cb148-981" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>In 2021, the number of collaboration songs is not as large as that of 2016-2020 due to the shorter time span, but the proportion of international collaborations appears to be higher.</span>
<span id="cb148-982"><a href="#cb148-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-985"><a href="#cb148-985" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-986"><a href="#cb148-986" aria-hidden="true" tabindex="-1"></a>collab_by_regimes <span class="ot">&lt;-</span> edgelist <span class="sc">%&gt;%</span> </span>
<span id="cb148-987"><a href="#cb148-987" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(regime) <span class="sc">%&gt;%</span></span>
<span id="cb148-988"><a href="#cb148-988" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb148-989"><a href="#cb148-989" aria-hidden="true" tabindex="-1"></a>    <span class="at">popularity =</span> <span class="fu">mean</span>(popularity),</span>
<span id="cb148-990"><a href="#cb148-990" aria-hidden="true" tabindex="-1"></a>    <span class="at">K_Pop =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"K-pop"</span>),</span>
<span id="cb148-991"><a href="#cb148-991" aria-hidden="true" tabindex="-1"></a>    <span class="at">US_Other =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"US or Other"</span>),</span>
<span id="cb148-992"><a href="#cb148-992" aria-hidden="true" tabindex="-1"></a>    <span class="at">E_Asia =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"East Asia"</span>),</span>
<span id="cb148-993"><a href="#cb148-993" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE_Asia =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"South East Asia"</span>),</span>
<span id="cb148-994"><a href="#cb148-994" aria-hidden="true" tabindex="-1"></a>    <span class="at">Latino =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"Latino"</span>),</span>
<span id="cb148-995"><a href="#cb148-995" aria-hidden="true" tabindex="-1"></a>    <span class="at">Europe =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"Europe"</span>),</span>
<span id="cb148-996"><a href="#cb148-996" aria-hidden="true" tabindex="-1"></a>    <span class="at">Unknown =</span> <span class="fu">sum</span>(Collab_region1 <span class="sc">==</span> <span class="st">"Unknown"</span>)</span>
<span id="cb148-997"><a href="#cb148-997" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb148-998"><a href="#cb148-998" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-999"><a href="#cb148-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1002"><a href="#cb148-1002" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-1003"><a href="#cb148-1003" aria-hidden="true" tabindex="-1"></a>edgelist</span>
<span id="cb148-1004"><a href="#cb148-1004" aria-hidden="true" tabindex="-1"></a>graph_stats_regimes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb148-1005"><a href="#cb148-1005" aria-hidden="true" tabindex="-1"></a>                          <span class="at">regime =</span> <span class="fu">c</span>(<span class="st">"2005-2011"</span>, <span class="st">"2012-2016"</span>, <span class="st">"2017-2020"</span>, <span class="st">"2021-"</span>),</span>
<span id="cb148-1006"><a href="#cb148-1006" aria-hidden="true" tabindex="-1"></a>                          <span class="at">start_year =</span> <span class="fu">c</span>(<span class="dv">2006</span>, <span class="dv">2013</span>, <span class="dv">2017</span>, <span class="dv">2021</span>),</span>
<span id="cb148-1007"><a href="#cb148-1007" aria-hidden="true" tabindex="-1"></a>                          <span class="at">end_year =</span> <span class="fu">c</span>(<span class="dv">2011</span>, <span class="dv">2016</span>, <span class="dv">2020</span>, <span class="dv">2023</span>),</span>
<span id="cb148-1008"><a href="#cb148-1008" aria-hidden="true" tabindex="-1"></a>                          <span class="at">num_nodes =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime)), </span>
<span id="cb148-1009"><a href="#cb148-1009" aria-hidden="true" tabindex="-1"></a>                          <span class="at">num_edges =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime)), </span>
<span id="cb148-1010"><a href="#cb148-1010" aria-hidden="true" tabindex="-1"></a>                          <span class="at">num_songs =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime)),</span>
<span id="cb148-1011"><a href="#cb148-1011" aria-hidden="true" tabindex="-1"></a>                          <span class="at">num_kpop_artists =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime)),</span>
<span id="cb148-1012"><a href="#cb148-1012" aria-hidden="true" tabindex="-1"></a>                          <span class="at">num_no_kpop_artists =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime)),</span>
<span id="cb148-1013"><a href="#cb148-1013" aria-hidden="true" tabindex="-1"></a>                          <span class="at">percent_no_kpop_artitst =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime)),</span>
<span id="cb148-1014"><a href="#cb148-1014" aria-hidden="true" tabindex="-1"></a>                          <span class="at">artists_per_song =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime)),</span>
<span id="cb148-1015"><a href="#cb148-1015" aria-hidden="true" tabindex="-1"></a>                          <span class="at">centralization =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime)), </span>
<span id="cb148-1016"><a href="#cb148-1016" aria-hidden="true" tabindex="-1"></a>                          <span class="at">density =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime)), </span>
<span id="cb148-1017"><a href="#cb148-1017" aria-hidden="true" tabindex="-1"></a>                          <span class="at">transitivity =</span> <span class="fu">numeric</span>(<span class="fu">length</span>(regime))</span>
<span id="cb148-1018"><a href="#cb148-1018" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb148-1019"><a href="#cb148-1019" aria-hidden="true" tabindex="-1"></a>graph_stats_regimes</span>
<span id="cb148-1020"><a href="#cb148-1020" aria-hidden="true" tabindex="-1"></a>regime</span>
<span id="cb148-1021"><a href="#cb148-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1022"><a href="#cb148-1022" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each year and calculate the desired graph statistics</span></span>
<span id="cb148-1023"><a href="#cb148-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1024"><a href="#cb148-1024" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(regime)) {</span>
<span id="cb148-1025"><a href="#cb148-1025" aria-hidden="true" tabindex="-1"></a>  start_year <span class="ot">&lt;-</span> graph_stats_regimes<span class="sc">$</span>start_year[i]</span>
<span id="cb148-1026"><a href="#cb148-1026" aria-hidden="true" tabindex="-1"></a>  end_year <span class="ot">&lt;-</span> graph_stats_regimes<span class="sc">$</span>end_year[i]</span>
<span id="cb148-1027"><a href="#cb148-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1028"><a href="#cb148-1028" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-1029"><a href="#cb148-1029" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the data for the current 3-year span</span></span>
<span id="cb148-1030"><a href="#cb148-1030" aria-hidden="true" tabindex="-1"></a>  subset_data <span class="ot">&lt;-</span> edgelist[edgelist<span class="sc">$</span>release_year <span class="sc">%in%</span> <span class="fu">c</span>(start_year<span class="sc">:</span>end_year), ]</span>
<span id="cb148-1031"><a href="#cb148-1031" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(start_year)</span>
<span id="cb148-1032"><a href="#cb148-1032" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(end_year)</span>
<span id="cb148-1033"><a href="#cb148-1033" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-1034"><a href="#cb148-1034" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the graph for the current 3-year span</span></span>
<span id="cb148-1035"><a href="#cb148-1035" aria-hidden="true" tabindex="-1"></a>  graph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame_with_all_vertices</span>(<span class="at">df =</span> subset_data, <span class="at">vertices =</span> artists)</span>
<span id="cb148-1036"><a href="#cb148-1036" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-1037"><a href="#cb148-1037" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fill in the corresponding row of the data frame with the calculated statistics</span></span>
<span id="cb148-1038"><a href="#cb148-1038" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"num_nodes"</span>] <span class="ot">&lt;-</span> <span class="fu">vcount</span>(graph)</span>
<span id="cb148-1039"><a href="#cb148-1039" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"num_edges"</span>] <span class="ot">&lt;-</span> <span class="fu">ecount</span>(graph)</span>
<span id="cb148-1040"><a href="#cb148-1040" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-1041"><a href="#cb148-1041" aria-hidden="true" tabindex="-1"></a>  song_ids <span class="ot">&lt;-</span> <span class="fu">E</span>(graph)<span class="sc">$</span>song_id</span>
<span id="cb148-1042"><a href="#cb148-1042" aria-hidden="true" tabindex="-1"></a>  num_unique_songs <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(song_ids))</span>
<span id="cb148-1043"><a href="#cb148-1043" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"num_songs"</span>] <span class="ot">&lt;-</span> num_unique_songs</span>
<span id="cb148-1044"><a href="#cb148-1044" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-1045"><a href="#cb148-1045" aria-hidden="true" tabindex="-1"></a>  kpop_values <span class="ot">&lt;-</span> <span class="fu">V</span>(graph)<span class="sc">$</span>kpop</span>
<span id="cb148-1046"><a href="#cb148-1046" aria-hidden="true" tabindex="-1"></a>  num_kpop <span class="ot">&lt;-</span> <span class="fu">sum</span>(kpop_values <span class="sc">==</span> <span class="st">"yes"</span>)</span>
<span id="cb148-1047"><a href="#cb148-1047" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"num_kpop_artists"</span>] <span class="ot">&lt;-</span> num_kpop</span>
<span id="cb148-1048"><a href="#cb148-1048" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-1049"><a href="#cb148-1049" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"num_no_kpop_artists"</span>] <span class="ot">&lt;-</span> <span class="fu">vcount</span>(graph) <span class="sc">-</span> num_kpop</span>
<span id="cb148-1050"><a href="#cb148-1050" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"percent_no_kpop_artitst"</span>] <span class="ot">&lt;-</span> (<span class="fu">vcount</span>(graph)<span class="sc">-</span>num_kpop)<span class="sc">/</span><span class="fu">vcount</span>(graph)</span>
<span id="cb148-1051"><a href="#cb148-1051" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-1052"><a href="#cb148-1052" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"artists_per_song"</span>] <span class="ot">&lt;-</span> <span class="fu">vcount</span>(graph)<span class="sc">/</span>num_unique_songs</span>
<span id="cb148-1053"><a href="#cb148-1053" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-1054"><a href="#cb148-1054" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"centralization"</span>] <span class="ot">&lt;-</span> <span class="fu">centr_degree</span>(graph)<span class="sc">$</span>centralization</span>
<span id="cb148-1055"><a href="#cb148-1055" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"density"</span>] <span class="ot">&lt;-</span> <span class="fu">graph.density</span>(graph)</span>
<span id="cb148-1056"><a href="#cb148-1056" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"transitivity"</span>] <span class="ot">&lt;-</span> <span class="fu">transitivity</span>(graph, <span class="at">type =</span> <span class="st">'global'</span>)</span>
<span id="cb148-1057"><a href="#cb148-1057" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-1058"><a href="#cb148-1058" aria-hidden="true" tabindex="-1"></a>  kpop_values <span class="ot">&lt;-</span> <span class="fu">V</span>(graph)<span class="sc">$</span>kpop</span>
<span id="cb148-1059"><a href="#cb148-1059" aria-hidden="true" tabindex="-1"></a>  num_kpop <span class="ot">&lt;-</span> <span class="fu">sum</span>(kpop_values <span class="sc">==</span> <span class="st">"yes"</span>)</span>
<span id="cb148-1060"><a href="#cb148-1060" aria-hidden="true" tabindex="-1"></a>  graph_stats_regimes[i, <span class="st">"num_kpop_artists"</span>] <span class="ot">&lt;-</span> num_kpop</span>
<span id="cb148-1061"><a href="#cb148-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1062"><a href="#cb148-1062" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-1063"><a href="#cb148-1063" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb148-1064"><a href="#cb148-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1065"><a href="#cb148-1065" aria-hidden="true" tabindex="-1"></a>graph_stats_regimes <span class="sc">%&gt;%</span></span>
<span id="cb148-1066"><a href="#cb148-1066" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(collab_by_regimes) <span class="sc">%&gt;%</span> </span>
<span id="cb148-1067"><a href="#cb148-1067" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">song_per_kpop_artists =</span> num_songs<span class="sc">/</span><span class="st">`</span><span class="at">K_Pop</span><span class="st">`</span>)</span>
<span id="cb148-1068"><a href="#cb148-1068" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-1069"><a href="#cb148-1069" aria-hidden="true" tabindex="-1"></a><span class="co"># #graph_stats_regimes &lt;- graph_stats_regimes %&gt;% </span></span>
<span id="cb148-1070"><a href="#cb148-1070" aria-hidden="true" tabindex="-1"></a><span class="co">#   left_join(collab_by_regimes)%&gt;%</span></span>
<span id="cb148-1071"><a href="#cb148-1071" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(song_per_kpop_artists = num_songs/`K_Pop`)</span></span>
<span id="cb148-1072"><a href="#cb148-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1073"><a href="#cb148-1073" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1074"><a href="#cb148-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1077"><a href="#cb148-1077" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-1078"><a href="#cb148-1078" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the 3-year spans</span></span>
<span id="cb148-1079"><a href="#cb148-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1080"><a href="#cb148-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1081"><a href="#cb148-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1082"><a href="#cb148-1082" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:length(end_years)) {</span></span>
<span id="cb148-1083"><a href="#cb148-1083" aria-hidden="true" tabindex="-1"></a><span class="co">#   end_year &lt;- end_years[i]</span></span>
<span id="cb148-1084"><a href="#cb148-1084" aria-hidden="true" tabindex="-1"></a><span class="co">#   start_year &lt;- end_year - 2</span></span>
<span id="cb148-1085"><a href="#cb148-1085" aria-hidden="true" tabindex="-1"></a><span class="co">#   year &lt;- end_year -1</span></span>
<span id="cb148-1086"><a href="#cb148-1086" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1087"><a href="#cb148-1087" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Subset the data for the current 3-year span</span></span>
<span id="cb148-1088"><a href="#cb148-1088" aria-hidden="true" tabindex="-1"></a><span class="co">#   subset_data &lt;- edgelist[edgelist$release_year %in% c(start_year:end_year), ]</span></span>
<span id="cb148-1089"><a href="#cb148-1089" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1090"><a href="#cb148-1090" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Create the graph for the current 3-year span</span></span>
<span id="cb148-1091"><a href="#cb148-1091" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph &lt;- graph_from_data_frame_with_all_vertices(df = subset_data, vertices = artists)</span></span>
<span id="cb148-1092"><a href="#cb148-1092" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1093"><a href="#cb148-1093" aria-hidden="true" tabindex="-1"></a><span class="co">#   V(graph)$color &lt;- V(graph)$color_region_category</span></span>
<span id="cb148-1094"><a href="#cb148-1094" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1095"><a href="#cb148-1095" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot(graph,</span></span>
<span id="cb148-1096"><a href="#cb148-1096" aria-hidden="true" tabindex="-1"></a><span class="co">#        vertex.label = V(graph)$show_kpop_top,</span></span>
<span id="cb148-1097"><a href="#cb148-1097" aria-hidden="true" tabindex="-1"></a><span class="co">#        arrow.mode = "-",</span></span>
<span id="cb148-1098"><a href="#cb148-1098" aria-hidden="true" tabindex="-1"></a><span class="co">#        vertex.size = log(V(graph)$followers) * 0.7,</span></span>
<span id="cb148-1099"><a href="#cb148-1099" aria-hidden="true" tabindex="-1"></a><span class="co">#        vertex.label.cex = 0.6,</span></span>
<span id="cb148-1100"><a href="#cb148-1100" aria-hidden="true" tabindex="-1"></a><span class="co">#        vertex.label.color = "black",</span></span>
<span id="cb148-1101"><a href="#cb148-1101" aria-hidden="true" tabindex="-1"></a><span class="co">#        vertex.frame.color = 'lightgrey',</span></span>
<span id="cb148-1102"><a href="#cb148-1102" aria-hidden="true" tabindex="-1"></a><span class="co">#        vertex.label.dist = 0,</span></span>
<span id="cb148-1103"><a href="#cb148-1103" aria-hidden="true" tabindex="-1"></a><span class="co">#        frame.width = 0,</span></span>
<span id="cb148-1104"><a href="#cb148-1104" aria-hidden="true" tabindex="-1"></a><span class="co">#        color = V(graph)$color_region_category,</span></span>
<span id="cb148-1105"><a href="#cb148-1105" aria-hidden="true" tabindex="-1"></a><span class="co">#        main = paste0("Collaboration by K-pop top artists ", start_year, "-", end_year)</span></span>
<span id="cb148-1106"><a href="#cb148-1106" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb148-1107"><a href="#cb148-1107" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-1108"><a href="#cb148-1108" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-1109"><a href="#cb148-1109" aria-hidden="true" tabindex="-1"></a><span class="co">#   legend(</span></span>
<span id="cb148-1110"><a href="#cb148-1110" aria-hidden="true" tabindex="-1"></a><span class="co">#     "bottomright",</span></span>
<span id="cb148-1111"><a href="#cb148-1111" aria-hidden="true" tabindex="-1"></a><span class="co">#     legend = c("K-pop", "Latin", "East Asia", "South East Asia", "Europe", "US or Other", "Unknown"),</span></span>
<span id="cb148-1112"><a href="#cb148-1112" aria-hidden="true" tabindex="-1"></a><span class="co">#     pt.bg  = c("#FFFFE1", "darkgreen", "#920002","#FDCCCC", "#ABD7E6", "deepskyblue3", "darkgrey"),</span></span>
<span id="cb148-1113"><a href="#cb148-1113" aria-hidden="true" tabindex="-1"></a><span class="co">#     pch    = 21,</span></span>
<span id="cb148-1114"><a href="#cb148-1114" aria-hidden="true" tabindex="-1"></a><span class="co">#     cex    = 1,</span></span>
<span id="cb148-1115"><a href="#cb148-1115" aria-hidden="true" tabindex="-1"></a><span class="co">#     bty    = "n",</span></span>
<span id="cb148-1116"><a href="#cb148-1116" aria-hidden="true" tabindex="-1"></a><span class="co">#     title  = "Genre"</span></span>
<span id="cb148-1117"><a href="#cb148-1117" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb148-1118"><a href="#cb148-1118" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb148-1119"><a href="#cb148-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1120"><a href="#cb148-1120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1121"><a href="#cb148-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1124"><a href="#cb148-1124" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-1125"><a href="#cb148-1125" aria-hidden="true" tabindex="-1"></a><span class="co"># end_years &lt;- 2008:2023</span></span>
<span id="cb148-1126"><a href="#cb148-1126" aria-hidden="true" tabindex="-1"></a><span class="co"># graph_stats_3years &lt;- data.frame(</span></span>
<span id="cb148-1127"><a href="#cb148-1127" aria-hidden="true" tabindex="-1"></a><span class="co">#                           start_year = 2006:2021,</span></span>
<span id="cb148-1128"><a href="#cb148-1128" aria-hidden="true" tabindex="-1"></a><span class="co">#                           end_year = 2008:2023, </span></span>
<span id="cb148-1129"><a href="#cb148-1129" aria-hidden="true" tabindex="-1"></a><span class="co">#                           year = 2007:2022,</span></span>
<span id="cb148-1130"><a href="#cb148-1130" aria-hidden="true" tabindex="-1"></a><span class="co">#                           num_nodes = numeric(length(2008:2023)), </span></span>
<span id="cb148-1131"><a href="#cb148-1131" aria-hidden="true" tabindex="-1"></a><span class="co">#                           num_edges = numeric(length(2008:2023)), </span></span>
<span id="cb148-1132"><a href="#cb148-1132" aria-hidden="true" tabindex="-1"></a><span class="co">#                           num_songs = numeric(length(2008:2023)),</span></span>
<span id="cb148-1133"><a href="#cb148-1133" aria-hidden="true" tabindex="-1"></a><span class="co">#                           num_kpop_artists = numeric(length(2008:2023)),</span></span>
<span id="cb148-1134"><a href="#cb148-1134" aria-hidden="true" tabindex="-1"></a><span class="co">#                           num_no_kpop_artists = numeric(length(2008:2023)),</span></span>
<span id="cb148-1135"><a href="#cb148-1135" aria-hidden="true" tabindex="-1"></a><span class="co">#                           percent_no_kpop_artitst = numeric(length(2008:2023)),</span></span>
<span id="cb148-1136"><a href="#cb148-1136" aria-hidden="true" tabindex="-1"></a><span class="co">#                           artists_per_song = numeric(length(2008:2023)),</span></span>
<span id="cb148-1137"><a href="#cb148-1137" aria-hidden="true" tabindex="-1"></a><span class="co">#                           centralization = numeric(length(2008:2023)), </span></span>
<span id="cb148-1138"><a href="#cb148-1138" aria-hidden="true" tabindex="-1"></a><span class="co">#                           density = numeric(length(2008:2023)), </span></span>
<span id="cb148-1139"><a href="#cb148-1139" aria-hidden="true" tabindex="-1"></a><span class="co">#                           transitivity = numeric(length(2008:2023))</span></span>
<span id="cb148-1140"><a href="#cb148-1140" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb148-1141"><a href="#cb148-1141" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-1142"><a href="#cb148-1142" aria-hidden="true" tabindex="-1"></a><span class="co"># # Loop through each year and calculate the desired graph statistics</span></span>
<span id="cb148-1143"><a href="#cb148-1143" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-1144"><a href="#cb148-1144" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:length(end_years)) {</span></span>
<span id="cb148-1145"><a href="#cb148-1145" aria-hidden="true" tabindex="-1"></a><span class="co">#   end_year &lt;- end_years[i]</span></span>
<span id="cb148-1146"><a href="#cb148-1146" aria-hidden="true" tabindex="-1"></a><span class="co">#   start_year &lt;- end_year - 2</span></span>
<span id="cb148-1147"><a href="#cb148-1147" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1148"><a href="#cb148-1148" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Subset the data for the current 3-year span</span></span>
<span id="cb148-1149"><a href="#cb148-1149" aria-hidden="true" tabindex="-1"></a><span class="co">#   subset_data &lt;- edgelist[edgelist$release_year %in% c(start_year:end_year), ]</span></span>
<span id="cb148-1150"><a href="#cb148-1150" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1151"><a href="#cb148-1151" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Create the graph for the current 3-year span</span></span>
<span id="cb148-1152"><a href="#cb148-1152" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph &lt;- graph_from_data_frame_with_all_vertices(df = subset_data, vertices = artists)</span></span>
<span id="cb148-1153"><a href="#cb148-1153" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1154"><a href="#cb148-1154" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Fill in the corresponding row of the data frame with the calculated statistics</span></span>
<span id="cb148-1155"><a href="#cb148-1155" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "num_nodes"] &lt;- vcount(graph)</span></span>
<span id="cb148-1156"><a href="#cb148-1156" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "num_edges"] &lt;- ecount(graph)</span></span>
<span id="cb148-1157"><a href="#cb148-1157" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1158"><a href="#cb148-1158" aria-hidden="true" tabindex="-1"></a><span class="co">#   song_ids &lt;- E(graph)$song_id</span></span>
<span id="cb148-1159"><a href="#cb148-1159" aria-hidden="true" tabindex="-1"></a><span class="co">#   num_unique_songs &lt;- length(unique(song_ids))</span></span>
<span id="cb148-1160"><a href="#cb148-1160" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "num_songs"] &lt;- num_unique_songs</span></span>
<span id="cb148-1161"><a href="#cb148-1161" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1162"><a href="#cb148-1162" aria-hidden="true" tabindex="-1"></a><span class="co">#   kpop_values &lt;- V(graph)$kpop</span></span>
<span id="cb148-1163"><a href="#cb148-1163" aria-hidden="true" tabindex="-1"></a><span class="co">#   num_kpop &lt;- sum(kpop_values == "yes")</span></span>
<span id="cb148-1164"><a href="#cb148-1164" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "num_kpop_artists"] &lt;- num_kpop</span></span>
<span id="cb148-1165"><a href="#cb148-1165" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1166"><a href="#cb148-1166" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "num_no_kpop_artists"] &lt;- vcount(graph) - num_kpop</span></span>
<span id="cb148-1167"><a href="#cb148-1167" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "percent_no_kpop_artitst"] &lt;- (vcount(graph)-num_kpop)/vcount(graph)</span></span>
<span id="cb148-1168"><a href="#cb148-1168" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1169"><a href="#cb148-1169" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "artists_per_song"] &lt;- vcount(graph)/num_unique_songs</span></span>
<span id="cb148-1170"><a href="#cb148-1170" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1171"><a href="#cb148-1171" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "centralization"] &lt;- centr_degree(graph)$centralization</span></span>
<span id="cb148-1172"><a href="#cb148-1172" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "density"] &lt;- graph.density(graph)</span></span>
<span id="cb148-1173"><a href="#cb148-1173" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "transitivity"] &lt;- transitivity(graph, type = 'global')</span></span>
<span id="cb148-1174"><a href="#cb148-1174" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1175"><a href="#cb148-1175" aria-hidden="true" tabindex="-1"></a><span class="co">#   kpop_values &lt;- V(graph)$kpop</span></span>
<span id="cb148-1176"><a href="#cb148-1176" aria-hidden="true" tabindex="-1"></a><span class="co">#   num_kpop &lt;- sum(kpop_values == "yes")</span></span>
<span id="cb148-1177"><a href="#cb148-1177" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats_3years[i, "num_kpop_artists"] &lt;- num_kpop</span></span>
<span id="cb148-1178"><a href="#cb148-1178" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1179"><a href="#cb148-1179" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1180"><a href="#cb148-1180" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1181"><a href="#cb148-1181" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb148-1182"><a href="#cb148-1182" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-1183"><a href="#cb148-1183" aria-hidden="true" tabindex="-1"></a><span class="co"># graph_stats_3years</span></span>
<span id="cb148-1184"><a href="#cb148-1184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1185"><a href="#cb148-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1186"><a href="#cb148-1186" aria-hidden="true" tabindex="-1"></a><span class="fu"># How does the nature of collaboration change between 2017-2020 and 2021-?</span></span>
<span id="cb148-1187"><a href="#cb148-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1188"><a href="#cb148-1188" aria-hidden="true" tabindex="-1"></a>As the first graph showed, the number of collaborations has decreased since 2021 after it peaked in 2020 even though the they are quite diverse with many US-based artists and a few East Asian, South East Asian, and Latino artists.</span>
<span id="cb148-1189"><a href="#cb148-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1190"><a href="#cb148-1190" aria-hidden="true" tabindex="-1"></a>Here, I will try to find out what has changed since 2021 and what caused this change.</span>
<span id="cb148-1191"><a href="#cb148-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1192"><a href="#cb148-1192" aria-hidden="true" tabindex="-1"></a>One of the hypotheses is that as K-pop had established its international popularity by 2021, there was no longer a need for as many collaborations with international artists. Instead, artists relatively less popular whose main base is not South Korea started collaborating with K-pop artists to benefit from its popularity.</span>
<span id="cb148-1193"><a href="#cb148-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1194"><a href="#cb148-1194" aria-hidden="true" tabindex="-1"></a>In Regime 3 (2017-2020) and Regime 4 (2021-), the relationship between K-pop artists and international artists in collaborations has changed. In Regime 3, K-pop artists often collaborated with internationally renowned artists. However, in Regime 4, this trend has shifted, and compared to Regime 3, there seems to be an increasing tendency for more popular K-pop artists to collaborate with relatively less famous non-Korean-based artists. This can be observed in the right graph above, where the slope becomes gentler, with the y-axis representing the popularity of international artists and the x-axis representing the popularity of K-pop artists.</span>
<span id="cb148-1195"><a href="#cb148-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1198"><a href="#cb148-1198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-1199"><a href="#cb148-1199" aria-hidden="true" tabindex="-1"></a>analysis <span class="ot">&lt;-</span> edgelist <span class="sc">%&gt;%</span> </span>
<span id="cb148-1200"><a href="#cb148-1200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(regime <span class="sc">==</span> <span class="st">"2017-2020"</span> <span class="sc">|</span> regime <span class="sc">==</span> <span class="st">"2021-"</span> <span class="sc">&amp;</span> Collab_region2 <span class="sc">==</span> <span class="st">"International"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb148-1201"><a href="#cb148-1201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"Collab_region1"</span>, <span class="st">"Collab_region2"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb148-1202"><a href="#cb148-1202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(artists <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"followers"</span>)), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"From"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb148-1203"><a href="#cb148-1203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(artists <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"followers"</span>)), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"To"</span> <span class="ot">=</span> <span class="st">"id"</span>)) </span>
<span id="cb148-1204"><a href="#cb148-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1205"><a href="#cb148-1205" aria-hidden="true" tabindex="-1"></a>analysis <span class="ot">&lt;-</span> analysis <span class="sc">%&gt;%</span> </span>
<span id="cb148-1206"><a href="#cb148-1206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Followers_of_Kpop_artists"</span> <span class="ot">=</span> <span class="st">"followers.x"</span>,</span>
<span id="cb148-1207"><a href="#cb148-1207" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Followers_of_Intl_artists"</span> <span class="ot">=</span> <span class="st">"followers.y"</span>)</span>
<span id="cb148-1208"><a href="#cb148-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1209"><a href="#cb148-1209" aria-hidden="true" tabindex="-1"></a>analysis <span class="sc">%&gt;%</span> </span>
<span id="cb148-1210"><a href="#cb148-1210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Followers_of_Kpop_artists <span class="sc">&lt;</span> <span class="dv">2000000</span> <span class="sc">&amp;</span> Followers_of_Intl_artists <span class="sc">&gt;</span> <span class="dv">1000</span> <span class="sc">&amp;</span> Followers_of_Intl_artists <span class="sc">&lt;</span> <span class="dv">4000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb148-1211"><a href="#cb148-1211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Followers_of_Kpop_artists</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Followers_of_Intl_artists</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb148-1212"><a href="#cb148-1212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb148-1213"><a href="#cb148-1213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm , <span class="at">color=</span><span class="st">"darkblue"</span>, <span class="at">fill=</span><span class="st">"#69b3a2"</span>, <span class="at">se=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb148-1214"><a href="#cb148-1214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="at">col =</span> <span class="st">"steelblue"</span>, <span class="at">alpha=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb148-1215"><a href="#cb148-1215" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb148-1216"><a href="#cb148-1216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"The number of followers of K-pop artists"</span>, <span class="at">y =</span> <span class="st">"The number of followers of International artists"</span>, <span class="at">title =</span> <span class="st">"The popularity of artists who collaborated in K-pop songs"</span>) <span class="sc">+</span></span>
<span id="cb148-1217"><a href="#cb148-1217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> regime)</span>
<span id="cb148-1218"><a href="#cb148-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1219"><a href="#cb148-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1220"><a href="#cb148-1220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1221"><a href="#cb148-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1222"><a href="#cb148-1222" aria-hidden="true" tabindex="-1"></a>In order to confirm this hypothesis more quantitatively, a regression model was used to examine the popularity of collaboration songs involving K-pop artists, the popularity of the K-pop artists themselves (measured by the number of followers on Spotify), and the popularity of international artists. (popularity of songs \~ popularity of K-pop artists who participated in the collaboration + popularity of international artists who participated in the collaboration).</span>
<span id="cb148-1223"><a href="#cb148-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1224"><a href="#cb148-1224" aria-hidden="true" tabindex="-1"></a>The results showed that the influence of the popularity of K-pop artists and international artists on the popularity of collaboration songs was 2.9 and 3.9 (significant with p = 0.05), respectively, from 2017 to 2020. However, from 2021 onwards, these values became 4.8 and 3.08 (significant with p = 0.05), respectively, indicating a reversal in the impact of the popularity of K-pop artists and international artists on the popularity of collaboration song.</span>
<span id="cb148-1225"><a href="#cb148-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1228"><a href="#cb148-1228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-1229"><a href="#cb148-1229" aria-hidden="true" tabindex="-1"></a>lm.pop_reg3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(popularity <span class="sc">~</span> Followers_of_Kpop_artists <span class="sc">+</span> Followers_of_Intl_artists, <span class="at">data =</span> analysis <span class="sc">%&gt;%</span> <span class="fu">filter</span>(regime <span class="sc">==</span> <span class="st">"2017-2020"</span>))</span>
<span id="cb148-1230"><a href="#cb148-1230" aria-hidden="true" tabindex="-1"></a>lm.pop_reg4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(popularity <span class="sc">~</span> Followers_of_Kpop_artists <span class="sc">+</span> Followers_of_Intl_artists, <span class="at">data =</span> analysis <span class="sc">%&gt;%</span> <span class="fu">filter</span>(regime <span class="sc">==</span> <span class="st">"2021-"</span>))</span>
<span id="cb148-1231"><a href="#cb148-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1232"><a href="#cb148-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1233"><a href="#cb148-1233" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(lm.pop_reg3))</span>
<span id="cb148-1234"><a href="#cb148-1234" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(lm.pop_reg4))</span>
<span id="cb148-1235"><a href="#cb148-1235" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1236"><a href="#cb148-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1237"><a href="#cb148-1237" aria-hidden="true" tabindex="-1"></a><span class="fu"># Summary of evoluation of K-pop collaborations for last 20 years.</span></span>
<span id="cb148-1238"><a href="#cb148-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1239"><a href="#cb148-1239" aria-hidden="true" tabindex="-1"></a>In summary, K-pop artists gained international popularity and a global audience partially due to collaborations with international artists starting in the mid-2010s. Since 2021,the number of collaboration songs has decreased. Besides, there has been a shift where artists outside of Korea are now collaborating with K-pop artists, leveraging their global popularity, to reach a broader audience.</span>
<span id="cb148-1240"><a href="#cb148-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1241"><a href="#cb148-1241" aria-hidden="true" tabindex="-1"></a><span class="fu"># Additional analysis</span></span>
<span id="cb148-1242"><a href="#cb148-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1243"><a href="#cb148-1243" aria-hidden="true" tabindex="-1"></a><span class="fu">## (Artists-based analysis) Who are the key artists?</span></span>
<span id="cb148-1244"><a href="#cb148-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1245"><a href="#cb148-1245" aria-hidden="true" tabindex="-1"></a>The below are the top 10 artists with the highest eigenvector centrality. It is interesting that they are not necessarily the most popular artists. For example BTS, BLACKPINK, or other more popular K-pop artists are not listed here. 8 of them are K-Pop artists and the rest of them are Yultron, DJ based in Los Angeles, and Gray, a New York base band.</span>
<span id="cb148-1246"><a href="#cb148-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1249"><a href="#cb148-1249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-1250"><a href="#cb148-1250" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb148-1251"><a href="#cb148-1251" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">V</span>(collab.net)<span class="sc">$</span>name,</span>
<span id="cb148-1252"><a href="#cb148-1252" aria-hidden="true" tabindex="-1"></a>  <span class="at">followers =</span> <span class="fu">V</span>(collab.net)<span class="sc">$</span>followers,</span>
<span id="cb148-1253"><a href="#cb148-1253" aria-hidden="true" tabindex="-1"></a>  <span class="at">region_category =</span> <span class="fu">V</span>(collab.net)<span class="sc">$</span>region_category,</span>
<span id="cb148-1254"><a href="#cb148-1254" aria-hidden="true" tabindex="-1"></a>  <span class="at">kpop =</span> <span class="fu">V</span>(collab.net)<span class="sc">$</span>kpop,</span>
<span id="cb148-1255"><a href="#cb148-1255" aria-hidden="true" tabindex="-1"></a>  <span class="at">degree =</span> <span class="fu">degree</span>(collab.net, <span class="at">mode =</span> <span class="st">'total'</span>),</span>
<span id="cb148-1256"><a href="#cb148-1256" aria-hidden="true" tabindex="-1"></a>  <span class="at">transitivity =</span> <span class="fu">transitivity</span>(collab.net, <span class="at">type =</span> <span class="st">'local'</span>),</span>
<span id="cb148-1257"><a href="#cb148-1257" aria-hidden="true" tabindex="-1"></a>  <span class="at">betweenness =</span> <span class="fu">betweenness</span>(collab.net),</span>
<span id="cb148-1258"><a href="#cb148-1258" aria-hidden="true" tabindex="-1"></a>  <span class="at">eigen_cent =</span> <span class="fu">eigen_centrality</span>(collab.net, <span class="at">directed =</span> F, <span class="at">scale =</span> F)<span class="sc">$</span>vector)</span>
<span id="cb148-1259"><a href="#cb148-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1260"><a href="#cb148-1260" aria-hidden="true" tabindex="-1"></a>nodes <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(eigen_cent)) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb148-1261"><a href="#cb148-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1262"><a href="#cb148-1262" aria-hidden="true" tabindex="-1"></a><span class="co">#nodes_stat_regime_list &lt;- list()  # Create an empty list to store the dataframes</span></span>
<span id="cb148-1263"><a href="#cb148-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1264"><a href="#cb148-1264" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:length(graphs)) {</span></span>
<span id="cb148-1265"><a href="#cb148-1265" aria-hidden="true" tabindex="-1"></a><span class="co">#   nodes_stat_regime &lt;- data.frame(</span></span>
<span id="cb148-1266"><a href="#cb148-1266" aria-hidden="true" tabindex="-1"></a><span class="co">#     genre = V(graphs[[i]])$genre,</span></span>
<span id="cb148-1267"><a href="#cb148-1267" aria-hidden="true" tabindex="-1"></a><span class="co">#     followers = V(graphs[[i]])$followers,</span></span>
<span id="cb148-1268"><a href="#cb148-1268" aria-hidden="true" tabindex="-1"></a><span class="co">#     region_category = V(graphs[[i]])$region_category,</span></span>
<span id="cb148-1269"><a href="#cb148-1269" aria-hidden="true" tabindex="-1"></a><span class="co">#     kpop = V(graphs[[i]])$kpop,</span></span>
<span id="cb148-1270"><a href="#cb148-1270" aria-hidden="true" tabindex="-1"></a><span class="co">#     degree = degree(graphs[[i]]),</span></span>
<span id="cb148-1271"><a href="#cb148-1271" aria-hidden="true" tabindex="-1"></a><span class="co">#     transitivity = transitivity(graphs[[i]], type = 'local'),</span></span>
<span id="cb148-1272"><a href="#cb148-1272" aria-hidden="true" tabindex="-1"></a><span class="co">#     betweenness = betweenness(graphs[[i]]),</span></span>
<span id="cb148-1273"><a href="#cb148-1273" aria-hidden="true" tabindex="-1"></a><span class="co">#     eigen_cent = eigen_centrality(graphs[[i]], directed = F, scale = F)$vector</span></span>
<span id="cb148-1274"><a href="#cb148-1274" aria-hidden="true" tabindex="-1"></a><span class="co">#     </span></span>
<span id="cb148-1275"><a href="#cb148-1275" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb148-1276"><a href="#cb148-1276" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1277"><a href="#cb148-1277" aria-hidden="true" tabindex="-1"></a><span class="co">#   nodes_stat_regime_list[[i]] &lt;- nodes_stat_regime  # Store the dataframe in the list</span></span>
<span id="cb148-1278"><a href="#cb148-1278" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb148-1279"><a href="#cb148-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1280"><a href="#cb148-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1281"><a href="#cb148-1281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1282"><a href="#cb148-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1283"><a href="#cb148-1283" aria-hidden="true" tabindex="-1"></a>Most nodes have a small eigenvector centrality, whch is less than 0.1. The nodes with a relatively bigger eigenvector centrality are K-pop artists and do not have many followers.</span>
<span id="cb148-1284"><a href="#cb148-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1287"><a href="#cb148-1287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-1288"><a href="#cb148-1288" aria-hidden="true" tabindex="-1"></a>nodes <span class="sc">%&gt;%</span> </span>
<span id="cb148-1289"><a href="#cb148-1289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(eigen_cent <span class="sc">&lt;</span> <span class="fl">0.4</span> <span class="sc">&amp;</span> followers <span class="sc">&lt;</span> <span class="dv">4000000</span>) <span class="sc">%&gt;%</span> <span class="co">#excluding outliers</span></span>
<span id="cb148-1290"><a href="#cb148-1290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>followers, <span class="at">y=</span>eigen_cent, <span class="at">color=</span>region_category)) <span class="sc">+</span></span>
<span id="cb148-1291"><a href="#cb148-1291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb148-1292"><a href="#cb148-1292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"region_category"</span>, </span>
<span id="cb148-1293"><a href="#cb148-1293" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"K-pop"</span> <span class="ot">=</span> <span class="st">"#FFFFE1"</span>, </span>
<span id="cb148-1294"><a href="#cb148-1294" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Latino"</span> <span class="ot">=</span> <span class="st">"darkgreen"</span>, </span>
<span id="cb148-1295"><a href="#cb148-1295" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"East Asia"</span> <span class="ot">=</span> <span class="st">"#920002"</span>,</span>
<span id="cb148-1296"><a href="#cb148-1296" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Southeast Asia"</span> <span class="ot">=</span> <span class="st">"#FDCCCC"</span>, </span>
<span id="cb148-1297"><a href="#cb148-1297" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Europe"</span> <span class="ot">=</span> <span class="st">"#ABD7E6"</span>, </span>
<span id="cb148-1298"><a href="#cb148-1298" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"US or Other"</span> <span class="ot">=</span> <span class="st">"#010087"</span>,                                      <span class="st">"Unknown"</span> <span class="ot">=</span> <span class="st">"darkgrey"</span>))</span>
<span id="cb148-1299"><a href="#cb148-1299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1300"><a href="#cb148-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1301"><a href="#cb148-1301" aria-hidden="true" tabindex="-1"></a>There is not a clear correlation between the number of collaboration songs and the artist's popularity.</span>
<span id="cb148-1302"><a href="#cb148-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1305"><a href="#cb148-1305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-1306"><a href="#cb148-1306" aria-hidden="true" tabindex="-1"></a>nodes <span class="sc">%&gt;%</span> </span>
<span id="cb148-1307"><a href="#cb148-1307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(followers <span class="sc">&lt;</span> <span class="dv">4000000</span>) <span class="sc">%&gt;%</span> <span class="co">#excluding outliers</span></span>
<span id="cb148-1308"><a href="#cb148-1308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>followers, <span class="at">y=</span>degree, <span class="at">color=</span>region_category)) <span class="sc">+</span></span>
<span id="cb148-1309"><a href="#cb148-1309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb148-1310"><a href="#cb148-1310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">"region_category"</span>, </span>
<span id="cb148-1311"><a href="#cb148-1311" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"K-pop"</span> <span class="ot">=</span> <span class="st">"#FFFFE1"</span>, </span>
<span id="cb148-1312"><a href="#cb148-1312" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Latino"</span> <span class="ot">=</span> <span class="st">"darkgreen"</span>, </span>
<span id="cb148-1313"><a href="#cb148-1313" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"East Asia"</span> <span class="ot">=</span> <span class="st">"#920002"</span>,</span>
<span id="cb148-1314"><a href="#cb148-1314" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Southeast Asia"</span> <span class="ot">=</span> <span class="st">"#FDCCCC"</span>, </span>
<span id="cb148-1315"><a href="#cb148-1315" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Europe"</span> <span class="ot">=</span> <span class="st">"#ABD7E6"</span>, </span>
<span id="cb148-1316"><a href="#cb148-1316" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"US or Other"</span> <span class="ot">=</span> <span class="st">"#010087"</span>,                                      <span class="st">"Unknown"</span> <span class="ot">=</span> <span class="st">"darkgrey"</span>))</span>
<span id="cb148-1317"><a href="#cb148-1317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1318"><a href="#cb148-1318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1321"><a href="#cb148-1321" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-1322"><a href="#cb148-1322" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a graph for each year</span></span>
<span id="cb148-1323"><a href="#cb148-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1324"><a href="#cb148-1324" aria-hidden="true" tabindex="-1"></a><span class="co"># graph_from_data_frame_with_all_vertices &lt;- function(df, vertices) {</span></span>
<span id="cb148-1325"><a href="#cb148-1325" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Create a data frame with all possible edges between vertices</span></span>
<span id="cb148-1326"><a href="#cb148-1326" aria-hidden="true" tabindex="-1"></a><span class="co">#   unique_vertices &lt;- unique(c(df$From, df$To))</span></span>
<span id="cb148-1327"><a href="#cb148-1327" aria-hidden="true" tabindex="-1"></a><span class="co">#   artists_period &lt;- artists[artists$id %in% unique_vertices, ]</span></span>
<span id="cb148-1328"><a href="#cb148-1328" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Create the graph with all vertices and existing edges</span></span>
<span id="cb148-1329"><a href="#cb148-1329" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph &lt;- graph_from_data_frame(df, directed = FALSE, vertices = artists_period)</span></span>
<span id="cb148-1330"><a href="#cb148-1330" aria-hidden="true" tabindex="-1"></a><span class="co">#   return(graph)</span></span>
<span id="cb148-1331"><a href="#cb148-1331" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb148-1332"><a href="#cb148-1332" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-1333"><a href="#cb148-1333" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-1334"><a href="#cb148-1334" aria-hidden="true" tabindex="-1"></a><span class="co"># graphs_year &lt;- lapply(2006:2023, function(x) graph_from_data_frame_with_all_vertices(df = edgelist[edgelist$release_year == x, ], vertices = artists))</span></span>
<span id="cb148-1335"><a href="#cb148-1335" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-1336"><a href="#cb148-1336" aria-hidden="true" tabindex="-1"></a><span class="co"># periods &lt;- c(2006:2023)</span></span>
<span id="cb148-1337"><a href="#cb148-1337" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-1338"><a href="#cb148-1338" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:length(graphs_year)) {</span></span>
<span id="cb148-1339"><a href="#cb148-1339" aria-hidden="true" tabindex="-1"></a><span class="co">#   V(graphs_year[[i]])$color &lt;- V(graphs_year[[i]])$color_region_category</span></span>
<span id="cb148-1340"><a href="#cb148-1340" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot(graphs_year[[i]], </span></span>
<span id="cb148-1341"><a href="#cb148-1341" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.label = V(graphs_year[[i]])$show_kpop_top,</span></span>
<span id="cb148-1342"><a href="#cb148-1342" aria-hidden="true" tabindex="-1"></a><span class="co">#      arrow.mode="-",</span></span>
<span id="cb148-1343"><a href="#cb148-1343" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.size = log(V(graphs_year[[i]])$followers) * 0.7,</span></span>
<span id="cb148-1344"><a href="#cb148-1344" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.label.cex = .8,</span></span>
<span id="cb148-1345"><a href="#cb148-1345" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.label.color = "black",</span></span>
<span id="cb148-1346"><a href="#cb148-1346" aria-hidden="true" tabindex="-1"></a><span class="co">#      vertex.label.dist = 0,</span></span>
<span id="cb148-1347"><a href="#cb148-1347" aria-hidden="true" tabindex="-1"></a><span class="co">#      frame.width = 0,</span></span>
<span id="cb148-1348"><a href="#cb148-1348" aria-hidden="true" tabindex="-1"></a><span class="co">#      color = V(graphs_year[[i]])$color_region_category,</span></span>
<span id="cb148-1349"><a href="#cb148-1349" aria-hidden="true" tabindex="-1"></a><span class="co">#      main = paste0("Collaboration by K-pop top artists ", periods[[i]])</span></span>
<span id="cb148-1350"><a href="#cb148-1350" aria-hidden="true" tabindex="-1"></a><span class="co">#      )</span></span>
<span id="cb148-1351"><a href="#cb148-1351" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-1352"><a href="#cb148-1352" aria-hidden="true" tabindex="-1"></a><span class="co">#   legend(</span></span>
<span id="cb148-1353"><a href="#cb148-1353" aria-hidden="true" tabindex="-1"></a><span class="co">#     "bottomright",</span></span>
<span id="cb148-1354"><a href="#cb148-1354" aria-hidden="true" tabindex="-1"></a><span class="co">#     legend = c("K-pop", "Latin", "East Asia", "South East Asia", "Europe", "US or Other", "Unknown"),</span></span>
<span id="cb148-1355"><a href="#cb148-1355" aria-hidden="true" tabindex="-1"></a><span class="co">#     pt.bg  = c("#FFFFE1", "darkgreen", "#920002","#FDCCCC", "#ABD7E6", "#010087", "darkgrey"),</span></span>
<span id="cb148-1356"><a href="#cb148-1356" aria-hidden="true" tabindex="-1"></a><span class="co">#     pch    = 21,</span></span>
<span id="cb148-1357"><a href="#cb148-1357" aria-hidden="true" tabindex="-1"></a><span class="co">#     cex    = 1,</span></span>
<span id="cb148-1358"><a href="#cb148-1358" aria-hidden="true" tabindex="-1"></a><span class="co">#     bty    = "n",</span></span>
<span id="cb148-1359"><a href="#cb148-1359" aria-hidden="true" tabindex="-1"></a><span class="co">#     title  = "Genre"</span></span>
<span id="cb148-1360"><a href="#cb148-1360" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb148-1361"><a href="#cb148-1361" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb148-1362"><a href="#cb148-1362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1363"><a href="#cb148-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1366"><a href="#cb148-1366" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-1367"><a href="#cb148-1367" aria-hidden="true" tabindex="-1"></a><span class="co"># collab_by_years &lt;- edgelist %&gt;% </span></span>
<span id="cb148-1368"><a href="#cb148-1368" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(release_year) %&gt;%</span></span>
<span id="cb148-1369"><a href="#cb148-1369" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(</span></span>
<span id="cb148-1370"><a href="#cb148-1370" aria-hidden="true" tabindex="-1"></a><span class="co">#     popularity = mean(popularity),</span></span>
<span id="cb148-1371"><a href="#cb148-1371" aria-hidden="true" tabindex="-1"></a><span class="co">#     K_Pop = sum(Collab_region1 == "K-pop"),</span></span>
<span id="cb148-1372"><a href="#cb148-1372" aria-hidden="true" tabindex="-1"></a><span class="co">#     US_Other = sum(Collab_region1 == "US or Other"),</span></span>
<span id="cb148-1373"><a href="#cb148-1373" aria-hidden="true" tabindex="-1"></a><span class="co">#     E_Asia = sum(Collab_region1 == "East Asia"),</span></span>
<span id="cb148-1374"><a href="#cb148-1374" aria-hidden="true" tabindex="-1"></a><span class="co">#     SE_Asia = sum(Collab_region1 == "South East Asia"),</span></span>
<span id="cb148-1375"><a href="#cb148-1375" aria-hidden="true" tabindex="-1"></a><span class="co">#     Latino = sum(Collab_region1 == "Latino"),</span></span>
<span id="cb148-1376"><a href="#cb148-1376" aria-hidden="true" tabindex="-1"></a><span class="co">#     Europe = sum(Collab_region1 == "Europe"),</span></span>
<span id="cb148-1377"><a href="#cb148-1377" aria-hidden="true" tabindex="-1"></a><span class="co">#     Unknown = sum(Collab_region1 == "Unknown")</span></span>
<span id="cb148-1378"><a href="#cb148-1378" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb148-1379"><a href="#cb148-1379" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-1380"><a href="#cb148-1380" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(collab_by_years)</span></span>
<span id="cb148-1381"><a href="#cb148-1381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1382"><a href="#cb148-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1385"><a href="#cb148-1385" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-1386"><a href="#cb148-1386" aria-hidden="true" tabindex="-1"></a><span class="co"># graph_stats &lt;- data.frame(year = 2006:2023, </span></span>
<span id="cb148-1387"><a href="#cb148-1387" aria-hidden="true" tabindex="-1"></a><span class="co">#                           num_nodes = numeric(length(2006:2023)), </span></span>
<span id="cb148-1388"><a href="#cb148-1388" aria-hidden="true" tabindex="-1"></a><span class="co">#                           num_edges = numeric(length(2006:2023)), </span></span>
<span id="cb148-1389"><a href="#cb148-1389" aria-hidden="true" tabindex="-1"></a><span class="co">#                           num_songs = numeric(length(2006:2023)),</span></span>
<span id="cb148-1390"><a href="#cb148-1390" aria-hidden="true" tabindex="-1"></a><span class="co">#                           artists_per_song = numeric(length(2006:2023)),</span></span>
<span id="cb148-1391"><a href="#cb148-1391" aria-hidden="true" tabindex="-1"></a><span class="co">#                           centralization = numeric(length(2006:2023)), </span></span>
<span id="cb148-1392"><a href="#cb148-1392" aria-hidden="true" tabindex="-1"></a><span class="co">#                           density = numeric(length(2006:2023)), </span></span>
<span id="cb148-1393"><a href="#cb148-1393" aria-hidden="true" tabindex="-1"></a><span class="co">#                           transitivity = numeric(length(2006:2023))</span></span>
<span id="cb148-1394"><a href="#cb148-1394" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb148-1395"><a href="#cb148-1395" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-1396"><a href="#cb148-1396" aria-hidden="true" tabindex="-1"></a><span class="co"># # Loop through each year and calculate the desired graph statistics</span></span>
<span id="cb148-1397"><a href="#cb148-1397" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:length(graphs_year)) {</span></span>
<span id="cb148-1398"><a href="#cb148-1398" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph &lt;- graphs_year[[i]]</span></span>
<span id="cb148-1399"><a href="#cb148-1399" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1400"><a href="#cb148-1400" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Fill in the corresponding row of the data frame with the calculated statistics</span></span>
<span id="cb148-1401"><a href="#cb148-1401" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats[i, "num_nodes"] &lt;- vcount(graph)</span></span>
<span id="cb148-1402"><a href="#cb148-1402" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats[i, "num_edges"] &lt;- ecount(graph)</span></span>
<span id="cb148-1403"><a href="#cb148-1403" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1404"><a href="#cb148-1404" aria-hidden="true" tabindex="-1"></a><span class="co">#   song_ids &lt;- E(graph)$song_id</span></span>
<span id="cb148-1405"><a href="#cb148-1405" aria-hidden="true" tabindex="-1"></a><span class="co">#   num_unique_songs &lt;- length(unique(song_ids))</span></span>
<span id="cb148-1406"><a href="#cb148-1406" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats[i, "num_songs"] &lt;- num_unique_songs</span></span>
<span id="cb148-1407"><a href="#cb148-1407" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-1408"><a href="#cb148-1408" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1409"><a href="#cb148-1409" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats[i, "centralization"] &lt;- centr_degree(graph)$centralization</span></span>
<span id="cb148-1410"><a href="#cb148-1410" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats[i, "density"] &lt;- graph.density(graph)</span></span>
<span id="cb148-1411"><a href="#cb148-1411" aria-hidden="true" tabindex="-1"></a><span class="co">#   graph_stats[i, "transitivity"] &lt;- transitivity(graph, type = 'global')</span></span>
<span id="cb148-1412"><a href="#cb148-1412" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-1413"><a href="#cb148-1413" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb148-1414"><a href="#cb148-1414" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb148-1415"><a href="#cb148-1415" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-1416"><a href="#cb148-1416" aria-hidden="true" tabindex="-1"></a><span class="co"># graph_stats &lt;- graph_stats %&gt;% left_join(collab_by_years, by = c("year" = "release_year"))%&gt;%</span></span>
<span id="cb148-1417"><a href="#cb148-1417" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(song_per_kpop_artists = num_songs/`K_Pop`)</span></span>
<span id="cb148-1418"><a href="#cb148-1418" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb148-1419"><a href="#cb148-1419" aria-hidden="true" tabindex="-1"></a><span class="co"># graph_stats</span></span>
<span id="cb148-1420"><a href="#cb148-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1421"><a href="#cb148-1421" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1422"><a href="#cb148-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1423"><a href="#cb148-1423" aria-hidden="true" tabindex="-1"></a><span class="fu"># Discussion</span></span>
<span id="cb148-1424"><a href="#cb148-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1425"><a href="#cb148-1425" aria-hidden="true" tabindex="-1"></a>This network analysis was conducted to illustrate the general characteristics and changes in K-pop over the past roughly 20 years. The analysis revealed that K-pop has increased the number of collaborations, particularly with Western artists, since the mid-2010s. In the late 2010s, K-pop expanded its collaborations to include a diverse range of artists from Asia, Europe, and Latin America, reaching its peak in the number of collaborations in 2020. This suggests that K-pop aimed to approach markets outside of Asia and increase its international popularity, especially after the massive success of "Gangnam Style" in 2012. There is no evidence to prove, however, the increase in the number of collaborations with Latino artists after 2018 may be due to the huge hit of "Despacito" by Luis Fonsi in 2017.</span>
<span id="cb148-1426"><a href="#cb148-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1427"><a href="#cb148-1427" aria-hidden="true" tabindex="-1"></a>From 2021, the number of collaborations decreased, but the proportion of international collaborations surpassed collaborations between K-pop artists themselves. This indicates the presence of relatively less popular artists who are not based in Korea, but collaborate with internationally renowned K-pop artists to reach a wider audience.</span>
<span id="cb148-1428"><a href="#cb148-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1429"><a href="#cb148-1429" aria-hidden="true" tabindex="-1"></a>According to the linear regression model, the popularity of collaborative songs between 2017 and 2020 was influenced by the popularity of the international artists involved in the collaborations. However, from 2021 onwards, it was found that the popularity of K-pop artists had a greater impact.</span>
<span id="cb148-1430"><a href="#cb148-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1431"><a href="#cb148-1431" aria-hidden="true" tabindex="-1"></a>While this analysis represents one factor that can explain the recent prominence of K-pop, it lacks detailed analysis in terms of network analysis and has certain limitations in the data. For instance, community identification is limited. Due to the reliance on limited data primarily obtained from the Spotify API, it was not possible to analyze based on meaningful information such as the artists' affiliations with agencies. Additionally, the data used in this analysis reflects the popularity of songs and artists as of May 2023, as current and retrospective information is unavailable from the Spotify API.</span>
<span id="cb148-1432"><a href="#cb148-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1433"><a href="#cb148-1433" aria-hidden="true" tabindex="-1"></a>The findings proposed by this analysis are believed to be worth researching further based on detailed data and analysis in the future.</span>
<span id="cb148-1434"><a href="#cb148-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1435"><a href="#cb148-1435" aria-hidden="true" tabindex="-1"></a><span class="fu"># Source</span></span>
<span id="cb148-1436"><a href="#cb148-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1437"><a href="#cb148-1437" aria-hidden="true" tabindex="-1"></a>KIM, K. H. (2021). Short History of K-Pop, K-Cinema, and K-Television. In Hegemonic Mimicry: Korean Popular Culture of the Twenty-First Century (pp. 35--84). Duke University Press. https://doi.org/10.2307/j.ctv1xrb6s6.5</span>
<span id="cb148-1438"><a href="#cb148-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1439"><a href="#cb148-1439" aria-hidden="true" tabindex="-1"></a>Shin, H. (2009). Have you ever seen the Rain? And who'll stop the Rain?: The globalizing project of Korean pop (K-pop). Inter-Asia Cultural Studies, 10(4), 507--523.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>