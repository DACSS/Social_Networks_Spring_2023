<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Cynthia Hester">
<meta name="dcterms.date" content="2023-05-20">
<meta name="description" content="DACSS 697E Social Networks Analysis Final Project">

<title>A Network Analysis of Global Preferential Trade Agreements (PTAs)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<meta name="twitter:title" content="A Network Analysis of Global Preferential Trade Agreements (PTAs)">
<meta name="twitter:description" content="DACSS 697E Social Networks Analysis Final Project">
<meta name="twitter:image" content="https://dacss.github.io/Social_Networks_Spring_2023/posts/CynthiaHester_Final_Project_Social_Networks_Spring_23_files/figure-html/unnamed-chunk-17-1.png">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:site" content="@UMassDACSS">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/UMass White Wordmark Horiz.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://dacss.github.io/Social_Networks_Spring_2023/" rel="" target="">
 <span class="menu-text">Spring 2023 Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">Contributors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss" rel="" target="">
 <span class="menu-text">DACSS</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://dacss.github.io/Social_Networks_Spring_2023/" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#research-question" id="toc-research-question" class="nav-link active" data-scroll-target="#research-question">Research Question:</a>
  <ul class="collapse">
  <li><a href="#hypothesis" id="toc-hypothesis" class="nav-link" data-scroll-target="#hypothesis">Hypothesis:</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction:</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#wrangling-and-exploration" id="toc-wrangling-and-exploration" class="nav-link" data-scroll-target="#wrangling-and-exploration">Wrangling and Exploration</a></li>
  <li><a href="#inspect-pta-trade-agreement-data-descriptive-statistics" id="toc-inspect-pta-trade-agreement-data-descriptive-statistics" class="nav-link" data-scroll-target="#inspect-pta-trade-agreement-data-descriptive-statistics">Inspect PTA trade agreement data/ Descriptive Statistics</a></li>
  <li><a href="#dyad-and-triad-census" id="toc-dyad-and-triad-census" class="nav-link" data-scroll-target="#dyad-and-triad-census">Dyad and Triad Census</a></li>
  <li><a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration">Data Exploration</a></li>
  <li><a href="#centrality" id="toc-centrality" class="nav-link" data-scroll-target="#centrality">Centrality</a></li>
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#creating-a-network-of-intercontinental-regions" id="toc-creating-a-network-of-intercontinental-regions" class="nav-link" data-scroll-target="#creating-a-network-of-intercontinental-regions">Creating a Network of Intercontinental Regions</a></li>
  <li><a href="#network-visualizations" id="toc-network-visualizations" class="nav-link" data-scroll-target="#network-visualizations">Network Visualizations</a></li>
  <li><a href="#density-and-transitivity" id="toc-density-and-transitivity" class="nav-link" data-scroll-target="#density-and-transitivity">Density and Transitivity</a></li>
  <li><a href="#community" id="toc-community" class="nav-link" data-scroll-target="#community">Community</a></li>
  <li><a href="#density" id="toc-density" class="nav-link" data-scroll-target="#density">Density</a></li>
  <li><a href="#transitivity" id="toc-transitivity" class="nav-link" data-scroll-target="#transitivity">Transitivity</a></li>
  <li><a href="#dendrogram" id="toc-dendrogram" class="nav-link" data-scroll-target="#dendrogram">Dendrogram</a></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  <li><a href="#conclusionreflection" id="toc-conclusionreflection" class="nav-link" data-scroll-target="#conclusionreflection">Conclusion/Reflection</a></li>
  <li><a href="#referencesresources" id="toc-referencesresources" class="nav-link" data-scroll-target="#referencesresources">References/Resources</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">A Network Analysis of Global Preferential Trade Agreements (PTAs)</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">Cynthia Hester</div>
    <div class="quarto-category">Final_Project</div>
    <div class="quarto-category">Preferential Trade Agreements (PTAs)</div>
    <div class="quarto-category">Network of International Trade Agreements</div>
  </div>
  </div>

<div>
  <div class="description">
    DACSS 697E Social Networks Analysis Final Project
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Cynthia Hester </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 20, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="research-question" class="level1">
<h1>Research Question:</h1>
<p>How does the network structure of Preferential Trade Agreements (PTAs) influence international trade patterns and economic integration among participating countries?</p>
<section id="hypothesis" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis">Hypothesis:</h2>
<p>H1: A more dense network structure in Preferential Trade Agreements (PTAs) leads to increased trade flow and economic integration among participating countries.</p>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction:</h2>
<p>In our Social Network Analysis course, Professor Rolfe highlighted the breadth of applications and emphasized the flexibility to examine any scenario that involved interactive systems. Taking this into account, I chose to focus my project on an area that piqued my personal interest - the intersection of travel and global trade.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p><strong>What is the source of the data?</strong></p>
<p>The data utilized for this project are derived from the Design of Trade Agreements (DESTA) database https://www.designoftradeagreements.org/project-description/, a comprehensive resource documenting numerous aspects of Preferential Trade Agreements (PTAs) globally, which was found via the World Trade Organization(WTO). With data spanning PTAs ratified since 1945, the DESTA database offers an examination of the various provisions and areas encompassed by these agreements. Utilizing this dataset was key in bringing the theories and methodologies of Social Network Analysis into practice in a real-world context.</p>
<p><strong>What is being measured</strong></p>
<p>The <strong>Preferential Trade Agreement</strong> (PTA) data measures the bilateral agreements between countries that provide preferential access to certain products from the countries involved, reducing tariffs or duties below the level that each country charges other members of the World Trade Organization (WTO).</p>
<p>The data includes variables, such as the (nodes) countries/regions involved, the type of agreement (free trade agreement, customs union, etc.), the date the agreement came into effect, and trade parameters. *************************************************************************************</p>
<p><strong>Data Format</strong></p>
<p>It is provided as a matrix, where countries are listed both in rows and columns, and each cell in the matrix indicates whether a trade agreement exists between the two countries. Alternatively, it could be provided as an edgelist, where each row represents an agreement with two columns for the two countries involved. Sometimes, it might also be in the form of an affiliation network, representing memberships of different countries in different agreements. For the purposes of this project it is presented as a matrix.</p>
</section>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<p>As previously stated the data for this project was derived from the Design of Trade Agreements database (DESTA). The data utilized are a universe of cases.</p>
</section>
<section id="wrangling-and-exploration" class="level2">
<h2 class="anchored" data-anchor-id="wrangling-and-exploration">Wrangling and Exploration</h2>
<section id="import-desta-data" class="level4">
<h4 class="anchored" data-anchor-id="import-desta-data">Import DESTA data</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#preferential trade agreement data (pta)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#DESTA List of Treaties</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>excel_file <span class="ot">&lt;-</span> <span class="st">"C:/Users/Bud/Downloads/desta_list_of_treaties_02_01_dyads.xlsx"</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>desta_list <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(excel_file, <span class="at">sheet =</span> <span class="st">"data"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>pta_data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path =</span> excel_file, <span class="at">sheet =</span> <span class="dv">2</span>) </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>pta_data<span class="sc">$</span>regioncon <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pta_data<span class="sc">$</span>regioncon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
</section>
<section id="inspect-pta-trade-agreement-data-descriptive-statistics" class="level2">
<h2 class="anchored" data-anchor-id="inspect-pta-trade-agreement-data-descriptive-statistics">Inspect PTA trade agreement data/ Descriptive Statistics</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pta_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#first few rows of the data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pta_data) <span class="co">#look at the structure of the data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#inspect the data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(pta_data) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>missing_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(pta_data, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>missing_values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows with missing values in country1 or country2 columns</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>pta_data <span class="ot">&lt;-</span> pta_data[<span class="fu">complete.cases</span>(pta_data<span class="sc">$</span>country1, pta_data<span class="sc">$</span>country2), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values in country1 and country2 columns</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>missing_country1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(pta_data<span class="sc">$</span>country1))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>missing_country2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(pta_data<span class="sc">$</span>country2))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the number of missing values</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of missing values in country1 column:"</span>, missing_country1, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of missing values in country2 column:"</span>, missing_country2, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<section id="adjacency-matrix-for-entire-dataset" class="level4">
<h4 class="anchored" data-anchor-id="adjacency-matrix-for-entire-dataset">Adjacency Matrix for entire dataset</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pta_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>  pta_data[<span class="dv">1</span> <span class="sc">:</span> <span class="dv">16</span>, <span class="dv">1</span> <span class="sc">:</span> <span class="dv">16</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install and load the igraph package</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(igraph)) {</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"igraph"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(igraph)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>graph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> pta_data, <span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the adjacency matrix</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>adj_matrix <span class="ot">&lt;-</span> <span class="fu">as_adjacency_matrix</span>(graph)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the adjacency matrix</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(adj_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>  [[ suppressing 204 column names 'Afghanistan', 'Algeria', 'Egypt' ... ]]</code></pre>
</div>
</div>
<p>nodes(countries)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vcount</span>(graph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>edges(trade ties)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ecount</span>(graph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Calculating proportion of nodes</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the number of nodes</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">V</span>(graph)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the proportion of non-zero entries</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>prop_nonzero <span class="ot">&lt;-</span> <span class="fu">sum</span>(adj_matrix[] <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">/</span> <span class="fu">length</span>(nodes) <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the proportion</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(prop_nonzero)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<p><strong>Analysis</strong></p>
<p>The output value 0.3540465 indicates that, based on the <strong>pta_data</strong>, approximately 35.4% of all potential bilateral Preferential Trade Agreements (PTAs) among countries are in place. This shows a considerable degree of interconnectedness in global trade. It also suggests substantial room for more PTAs, as 64.6% of potential agreements are unexplored.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> <span class="fu">V</span>(graph)<span class="sc">$</span>name,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">all.degree =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(graph), </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">out.degree =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(graph, <span class="at">mode =</span> <span class="st">'out'</span>),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">in.degree =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(graph, <span class="at">mode =</span> <span class="st">'in'</span>), </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">total.degree =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(graph, <span class="at">mode =</span> <span class="st">'total'</span>),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">eigen.centrality =</span> igraph<span class="sc">::</span><span class="fu">eigen_centrality</span>(graph)<span class="sc">$</span>vector)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<p><strong>Distribution</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram for all_degree</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nodes, <span class="fu">aes</span>(<span class="at">x=</span>all.degree)) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">1</span>, <span class="at">fill=</span><span class="st">"steelblue"</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of All Degree"</span>) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"All Degree"</span>) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="CynthiaHester_Final_Project_Social_Networks_Spring_23_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram for out_degree</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nodes, <span class="fu">aes</span>(<span class="at">x=</span>out.degree)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">1</span>, <span class="at">fill=</span><span class="st">"steelblue"</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of Out Degree"</span>) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Out Degree"</span>) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="CynthiaHester_Final_Project_Social_Networks_Spring_23_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram for in_degree</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nodes, <span class="fu">aes</span>(<span class="at">x=</span>in.degree)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">1</span>, <span class="at">fill=</span><span class="st">"steelblue"</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of In Degree"</span>) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"In Degree"</span>) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="CynthiaHester_Final_Project_Social_Networks_Spring_23_files/figure-html/unnamed-chunk-17-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram for eigen_centrality</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nodes, <span class="fu">aes</span>(<span class="at">x=</span>eigen.centrality)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="fl">0.1</span>, <span class="at">fill=</span><span class="st">"steelblue"</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of Eigen Centrality"</span>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Eigen Centrality"</span>) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="CynthiaHester_Final_Project_Social_Networks_Spring_23_files/figure-html/unnamed-chunk-17-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Analysis</strong></p>
<p>This distribution reveals how nations in the PTA network interact. High degree centrality indicates a country’s extensive trade relationships. High out-degree signifies proactive trade agreement initiation, while high in-degree suggests a country’s attractiveness as a trade partner. Lastly, elevated eigenvector centrality reveals a nation’s importance within major trade blocs or networks.</p>
<hr>
</section>
</section>
<section id="dyad-and-triad-census" class="level2">
<h2 class="anchored" data-anchor-id="dyad-and-triad-census">Dyad and Triad Census</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dyad.census</span>(nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in intcalc(dat): NAs introduced by coercion</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">triad.census</span>(nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in triad.census(nodes): NAs introduced by coercion</code></pre>
</div>
</div>
</section>
<section id="data-exploration" class="level2">
<h2 class="anchored" data-anchor-id="data-exploration">Data Exploration</h2>
<p>This is a large dataset so I will focus on two variables; <strong>year and region</strong>. To better understand the data I will visualize it using the ggplot package from the tidyverse.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># counts the frequency of ties between any two countries formed by year and region.</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>pta_data_count <span class="ot">&lt;-</span> pta_data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(year, regioncon) <span class="sc">%&gt;%</span> <span class="fu">count</span>(name) </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>pta_data_count <span class="ot">&lt;-</span> pta_data_count <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(pta_data_count), <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Region"</span>, <span class="st">"Agreement name"</span>, <span class="st">"Number of Ties"</span>),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Frequency of Ties Table"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
<section id="centrality" class="level2">
<h2 class="anchored" data-anchor-id="centrality">Centrality</h2>
<p>Intercontinental Region</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>pta_intercon <span class="ot">&lt;-</span> pta_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(regioncon <span class="sc">==</span> <span class="st">"Intercontinental"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>pta_intercon_net <span class="ot">&lt;-</span> <span class="fu">graph_from_edgelist</span>(<span class="fu">cbind</span>(pta_intercon<span class="sc">$</span>country1, pta_intercon<span class="sc">$</span>country2), <span class="at">directed =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Degree Centrality Intercontinental Region</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a graph from the pta_data</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>pta_net <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> pta_data_count, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the degree centrality</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>degree_centrality <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">degree</span>(pta_net, <span class="at">mode =</span> <span class="st">"all"</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the degree centrality values</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(degree_centrality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            1991             2000             1988             2018 
              21               26               10               22 
            1989             2003             1984             1979 
               9               55               12                6 
            1975             2008             2007             2015 
               9               25               20               15 
            1994             1982             1993             1981 
              59                5               28                7 
            2016             2012             2005             1997 
               8               10               41               36 
            2019             1971             1963             1969 
              30                3                4                8 
            2009             2001             1992             2011 
              26               34               43               39 
            1973             1986             1968             1980 
              11               14                4                5 
            1996             2004             2020             1983 
              38               34               20               11 
            1998             2006             2013             2014 
              30               35               17               13 
            2017             2010             1953             1959 
              14               10                2                2 
            1960             1966             1972             1985 
               6                5               12               31 
            2002             1951             1957             1961 
              33                2                4                7 
            1962             1995             1999             1976 
               5               46               24               10 
            1958             1964             1967             1977 
               4                3                5                6 
            1987             1970             1990             1965 
               4                5                7                5 
            2021             1948             1949             1954 
               9                1                1                2 
            1955             1974             1978           Africa 
               2                5                1               91 
Intercontinental           Europe         Americas             Asia 
             382              260              231              140 
         Oceania 
              12 </code></pre>
</div>
</div>
<p><strong>Degree Centrality Analysis</strong></p>
<p>In the context of degree centrality, the nodes with the highest degree centrality values can be considered the most important or influential nodes in the network. These nodes have a large number of connections (edges) with other nodes in the network.</p>
<p>Nodes(regions) with the highest degree centrality values are:</p>
<ul>
<li>Europe: 260</li>
<li>Americas: 231</li>
<li>Asia: 140</li>
<li>Intercontinental: 382</li>
</ul>
<p>These nodes represent regions or continents and have the highest number of connections with other nodes in the network. Therefore, they can be considered the most significant or influential network connectivity.</p>
<p><strong>Betweenness Centrality</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># graph from the pta_data_count</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>pta_net <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> pta_data_count, <span class="at">directed =</span> F)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># betweenness centrality</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>betweenness_centrality <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">betweenness</span>(pta_net, <span class="at">directed =</span> F)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the betweenness centrality values</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(betweenness_centrality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            1991             2000             1988             2018 
    7.494461e+00     4.716374e+00     3.692614e+00     6.556118e+00 
            1989             2003             1984             1979 
    1.198995e+00     1.883398e+01     1.444299e+00     5.948588e-02 
            1975             2008             2007             2015 
    9.325719e-01     9.906810e+00     4.108716e+00     2.540474e+00 
            1994             1982             1993             1981 
    2.672258e+01     4.095292e-01     1.105058e+01     7.440072e-01 
            2016             2012             2005             1997 
    1.192980e-01     7.843512e-01     1.716253e+01     1.852355e+01 
            2019             1971             1963             1969 
    6.054483e+00     8.100132e-02     2.444396e-01     6.984590e-01 
            2009             2001             1992             2011 
    8.044566e+00     1.631060e+01     1.282501e+01     7.360925e+00 
            1973             1986             1968             1980 
    1.822063e+00     1.438660e+00     5.112771e-02     4.165937e-01 
            1996             2004             2020             1983 
    2.640890e+01     1.486621e+01     9.292370e-01     3.903573e+00 
            1998             2006             2013             2014 
    1.979985e+01     1.038072e+01     1.763910e+00     6.035179e-01 
            2017             2010             1953             1959 
    1.266956e+00     1.994557e-01     2.624046e-02     0.000000e+00 
            1960             1966             1972             1985 
    1.257798e-01     5.312405e-01     5.051379e-01     5.197904e+00 
            2002             1951             1957             1961 
    1.581869e+01     1.023883e-02     9.589339e-02     8.118623e-01 
            1962             1995             1999             1976 
    5.798910e-01     2.751133e+01     7.211283e+00     3.790315e+00 
            1958             1964             1967             1977 
    5.754305e-02     0.000000e+00     4.638906e-01     2.099237e-01 
            1987             1970             1990             1965 
    0.000000e+00     8.100096e-02     9.855898e-01     9.423750e-01 
            2021             1948             1949             1954 
    4.846182e-01     0.000000e+00     0.000000e+00     0.000000e+00 
            1955             1974             1978           Africa 
    2.624046e-02     6.143295e-02     0.000000e+00     3.292609e+02 
Intercontinental           Europe         Americas             Asia 
    1.071777e+03     3.835651e+02     6.806068e+02     3.412115e+02 
         Oceania 
    1.578892e+00 </code></pre>
</div>
</div>
<p><strong>Betweenness Analysis</strong></p>
<p>Egypt, Jordan, and Morocco are identified as nodes with high betweenness centrality. These countries serve as key intermediaries in facilitating trade relationships and information exchange between other countries within the network.</p>
<p>On the other hand, nodes with lower betweenness centrality values, such as Albania or Armenia, have less influence in connecting different parts of the network. While they still contribute to the network structure, their impact on information flow and communication may be comparatively lower.</p>
<hr>
<p><strong>Summary of Preferential Trade Agreement data</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">summary</span>(pta_data_count), <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Region"</span>, <span class="st">"Agreement name"</span>, <span class="st">"Number of Ties"</span>), </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"A Summary of the Frequency of Ties Data"</span>) <span class="co">#summary() provide a summary of the data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>An overview of the data reveals six distinct categories: Africa, Americas, Asia, Europe, Oceania, and Intercontinental. Interestingly, most PTAs are Intercontinental, tallying 382 agreements, while Oceania, given the limited number of nations in the region, has only 12 intra-regional agreements.</p>
<p>The next stage of my exploration will involve identifying patterns of multilateral and bilateral PTA formation among different countries.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#filter the new data: which countries tend to form multilateral PTAs and which countries tend to form bilateral PTAs</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>pta_data_count <span class="ot">&lt;-</span> pta_data_count <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">bilat =</span> <span class="fu">ifelse</span>(n <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"bilateral"</span>, <span class="st">"multilateral"</span>)) <span class="co">#creating a new variable to see if a tie belongs to a bilateral or multilateral treaty</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co">#png(filename = "network1.png") # save as png</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>pta_data_count<span class="sc">$</span>bilat <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pta_data_count<span class="sc">$</span>bilat)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>region_count <span class="ot">&lt;-</span> pta_data_count <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(regioncon, bilat) <span class="sc">%&gt;%</span> <span class="fu">count</span>(regioncon)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(region_count, <span class="fu">aes</span>(<span class="at">x=</span> regioncon, <span class="at">y =</span> n, <span class="at">color =</span> bilat, <span class="at">fill =</span> bilat)) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="CynthiaHester_Final_Project_Social_Networks_Spring_23_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It’s observed that African nations exhibit a preference for multilateral <strong>PTAs</strong> as opposed to bilateral ones. Conversely, countries in the Americas and Asia predominantly lean towards bilateral <strong>PTAs</strong>. Europe and Oceania display an almost equal inclination towards both bilateral and multilateral <strong>PTAs</strong>. Of note when it comes to inter-regional PTAs, there appears to be no clear preference between bilateral and multilateral arrangements.</p>
<hr>
<p>Creating a plot to visualize the number of ties formed annually by region reinforces indicates thats Africa is particularly prominent in terms of the number of ties established, as well as in forming intra-regional PTAs, with Europe following closely. Meanwhile, Asia, the Americas, and Oceania demonstrate a preference for forming bilateral agreements.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualizing ties formed annually by global region</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">#png(filename = "network2.png") # save as png</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pta_data_count, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> n, <span class="at">color =</span> regioncon, <span class="at">fill =</span> regioncon)) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>regioncon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="CynthiaHester_Final_Project_Social_Networks_Spring_23_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Indegree/ Outdegree of PTAs Intercontinental Region</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># indegree and outdegree</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>indegree <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(pta_intercon_net)))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>outdegree <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(<span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(pta_intercon_net)))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># data frame with indegree and outdegree values</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>degree_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">country =</span> <span class="fu">V</span>(pta_intercon_net)<span class="sc">$</span>name, <span class="at">indegree =</span> indegree, <span class="at">outdegree =</span> outdegree)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the degree information</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(degree_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                          country indegree
Egypt                                                       Egypt      174
Jordan                                                     Jordan      109
Morocco                                                   Morocco      145
Tunisia                                                   Tunisia      159
Albania                                                   Albania        1
Turkey                                                     Turkey      109
Algeria                                                   Algeria      128
Belgium                                                   Belgium      435
Denmark                                                   Denmark      388
France                                                     France      436
Germany                                                   Germany      435
Ireland                                                   Ireland      388
Italy                                                       Italy      435
Luxembourg                                             Luxembourg      435
Netherlands                                           Netherlands      435
United Kingdom                                     United Kingdom      448
Portugal                                                 Portugal      218
Spain                                                       Spain      233
Austria                                                   Austria      151
Finland                                                   Finland      151
Sweden                                                     Sweden      152
Greece                                                     Greece      290
Cyprus                                                     Cyprus      142
Czechia                                                   Czechia      144
Estonia                                                   Estonia      144
Hungary                                                   Hungary      144
Latvia                                                     Latvia      143
Lithuania                                               Lithuania      143
Malta                                                       Malta      142
Poland                                                     Poland      144
Slovakia                                                 Slovakia      144
Slovenia                                                 Slovenia      144
Bulgaria                                                 Bulgaria      144
Romania                                                   Romania      191
Croatia                                                   Croatia      120
Iraq                                                         Iraq       99
Syria                                                       Syria       91
Libya                                                       Libya       90
Armenia                                                   Armenia       59
Belarus                                                   Belarus       49
Moldova                                                   Moldova       30
Russia                                                     Russia       52
Ukraine                                                   Ukraine       64
Kenya                                                       Kenya       81
Tanzania                                                 Tanzania      127
Uganda                                                     Uganda       80
Australia                                               Australia       78
Brunei                                                     Brunei       31
Cambodia                                                 Cambodia        7
Indonesia                                               Indonesia       68
Laos                                                         Laos        8
Malaysia                                                 Malaysia       85
Myanmar (Burma)                                   Myanmar (Burma)        7
Philippines                                           Philippines       73
Singapore                                               Singapore      148
Thailand                                                 Thailand       58
Vietnam                                                   Vietnam      137
New Zealand                                           New Zealand       62
Canada                                                     Canada       63
Chile                                                       Chile      131
United States                                       United States       21
Azerbaijan                                             Azerbaijan       18
Bahrain                                                   Bahrain       42
Kazakhstan                                             Kazakhstan       78
Kyrgyzstan                                             Kyrgyzstan       43
Tajikistan                                             Tajikistan       36
Bosnia &amp; Herzegovina                         Bosnia &amp; Herzegovina        2
Israel                                                     Israel       90
Iceland                                                   Iceland       34
Liechtenstein                                       Liechtenstein       33
Norway                                                     Norway       33
Switzerland                                           Switzerland       35
Antigua &amp; Barbuda                               Antigua &amp; Barbuda       78
Bahamas                                                   Bahamas       96
Barbados                                                 Barbados       96
Belize                                                     Belize       78
Dominica                                                 Dominica       87
Dominican Republic                             Dominican Republic       68
Grenada                                                   Grenada       96
Guyana                                                     Guyana      143
Haiti                                                       Haiti      115
Jamaica                                                   Jamaica       96
St. Kitts &amp; Nevis                               St. Kitts &amp; Nevis       78
St. Lucia                                               St. Lucia       87
St. Vincent &amp; Grenadines                 St. Vincent &amp; Grenadines       78
Suriname                                                 Suriname       88
Trinidad &amp; Tobago                               Trinidad &amp; Tobago      143
China                                                       China       20
India                                                       India       70
Japan                                                       Japan       65
South Korea                                           South Korea      118
Peru                                                         Peru      124
Colombia                                                 Colombia       84
Georgia                                                   Georgia       60
Turkmenistan                                         Turkmenistan       14
Uzbekistan                                             Uzbekistan       28
Côte d’Ivoire                                       Côte d’Ivoire      108
Angola                                                     Angola       87
Benin                                                       Benin      127
Botswana                                                 Botswana      110
Burkina Faso                                         Burkina Faso       80
Burundi                                                   Burundi       80
Cameroon                                                 Cameroon      128
Cape Verde                                             Cape Verde       59
Central African Republic                 Central African Republic       80
Chad                                                         Chad       80
Comoros                                                   Comoros       87
Congo - Brazzaville                           Congo - Brazzaville       80
Congo - Kinshasa                                 Congo - Kinshasa      127
Cook Islands                                         Cook Islands       39
Djibouti                                                 Djibouti       78
Equatorial Guinea                               Equatorial Guinea       68
Eritrea                                                   Eritrea       28
Eswatini                                                 Eswatini      110
Ethiopia                                                 Ethiopia       68
Fiji                                                         Fiji      111
Gabon                                                       Gabon       80
Gambia                                                     Gambia       68
Ghana                                                       Ghana      116
Guinea                                                     Guinea      115
Guinea-Bissau                                       Guinea-Bissau       68
Kiribati                                                 Kiribati       70
Lesotho                                                   Lesotho      110
Liberia                                                   Liberia       68
Madagascar                                             Madagascar      109
Malawi                                                     Malawi       68
Mali                                                         Mali       80
Marshall Islands                                 Marshall Islands       29
Mauritania                                             Mauritania       99
Mauritius                                               Mauritius      100
Micronesia (Federated States of) Micronesia (Federated States of)       29
Mozambique                                             Mozambique      126
Namibia                                                   Namibia       70
Nauru                                                       Nauru       29
Niger                                                       Niger       80
Nigeria                                                   Nigeria      122
Niue                                                         Niue       39
Palau                                                       Palau       29
Papua New Guinea                                 Papua New Guinea      103
Rwanda                                                     Rwanda       80
Samoa                                                       Samoa      114
São Tomé &amp; Príncipe                           São Tomé &amp; Príncipe       59
Senegal                                                   Senegal       80
Seychelles                                             Seychelles       88
Sierra Leone                                         Sierra Leone       68
Solomon Islands                                   Solomon Islands      105
South Africa                                         South Africa       98
Sudan                                                       Sudan      157
Togo                                                         Togo       80
Tonga                                                       Tonga       79
Tuvalu                                                     Tuvalu       70
Vanuatu                                                   Vanuatu       51
Zambia                                                     Zambia       69
Zimbabwe                                                 Zimbabwe      126
Timor-Leste                                           Timor-Leste       28
Somalia                                                   Somalia      117
Bangladesh                                             Bangladesh       54
Iran                                                         Iran       59
Pakistan                                                 Pakistan       70
Lebanon                                                   Lebanon      101
Mexico                                                     Mexico      118
Kuwait                                                     Kuwait       48
Oman                                                         Oman       42
Qatar                                                       Qatar       88
Saudi Arabia                                         Saudi Arabia       50
United Arab Emirates                         United Arab Emirates       42
Palestinian Territories                   Palestinian Territories       38
El Salvador                                           El Salvador       31
Honduras                                                 Honduras       31
Taiwan                                                     Taiwan        6
Argentina                                               Argentina       60
Bolivia                                                   Bolivia       47
Brazil                                                     Brazil       75
Cuba                                                         Cuba       47
Ecuador                                                   Ecuador       82
Nicaragua                                               Nicaragua       76
North Korea                                           North Korea       47
Serbia                                                     Serbia       71
Sri Lanka                                               Sri Lanka       48
Uruguay                                                   Uruguay       75
Venezuela                                               Venezuela       53
Yemen                                                       Yemen       37
Guatemala                                               Guatemala       33
Paraguay                                                 Paraguay       14
North Macedonia                                   North Macedonia        1
Montenegro                                             Montenegro        1
Panama                                                     Panama       36
Greenland                                               Greenland        1
Costa Rica                                             Costa Rica       35
Hong Kong SAR China                           Hong Kong SAR China        6
Kosovo                                                     Kosovo        1
                                 outdegree
Egypt                                  174
Jordan                                 109
Morocco                                145
Tunisia                                159
Albania                                  1
Turkey                                 109
Algeria                                128
Belgium                                435
Denmark                                388
France                                 436
Germany                                435
Ireland                                388
Italy                                  435
Luxembourg                             435
Netherlands                            435
United Kingdom                         448
Portugal                               218
Spain                                  233
Austria                                151
Finland                                151
Sweden                                 152
Greece                                 290
Cyprus                                 142
Czechia                                144
Estonia                                144
Hungary                                144
Latvia                                 143
Lithuania                              143
Malta                                  142
Poland                                 144
Slovakia                               144
Slovenia                               144
Bulgaria                               144
Romania                                191
Croatia                                120
Iraq                                    99
Syria                                   91
Libya                                   90
Armenia                                 59
Belarus                                 49
Moldova                                 30
Russia                                  52
Ukraine                                 64
Kenya                                   81
Tanzania                               127
Uganda                                  80
Australia                               78
Brunei                                  31
Cambodia                                 7
Indonesia                               68
Laos                                     8
Malaysia                                85
Myanmar (Burma)                          7
Philippines                             73
Singapore                              148
Thailand                                58
Vietnam                                137
New Zealand                             62
Canada                                  63
Chile                                  131
United States                           21
Azerbaijan                              18
Bahrain                                 42
Kazakhstan                              78
Kyrgyzstan                              43
Tajikistan                              36
Bosnia &amp; Herzegovina                     2
Israel                                  90
Iceland                                 34
Liechtenstein                           33
Norway                                  33
Switzerland                             35
Antigua &amp; Barbuda                       78
Bahamas                                 96
Barbados                                96
Belize                                  78
Dominica                                87
Dominican Republic                      68
Grenada                                 96
Guyana                                 143
Haiti                                  115
Jamaica                                 96
St. Kitts &amp; Nevis                       78
St. Lucia                               87
St. Vincent &amp; Grenadines                78
Suriname                                88
Trinidad &amp; Tobago                      143
China                                   20
India                                   70
Japan                                   65
South Korea                            118
Peru                                   124
Colombia                                84
Georgia                                 60
Turkmenistan                            14
Uzbekistan                              28
Côte d’Ivoire                          108
Angola                                  87
Benin                                  127
Botswana                               110
Burkina Faso                            80
Burundi                                 80
Cameroon                               128
Cape Verde                              59
Central African Republic                80
Chad                                    80
Comoros                                 87
Congo - Brazzaville                     80
Congo - Kinshasa                       127
Cook Islands                            39
Djibouti                                78
Equatorial Guinea                       68
Eritrea                                 28
Eswatini                               110
Ethiopia                                68
Fiji                                   111
Gabon                                   80
Gambia                                  68
Ghana                                  116
Guinea                                 115
Guinea-Bissau                           68
Kiribati                                70
Lesotho                                110
Liberia                                 68
Madagascar                             109
Malawi                                  68
Mali                                    80
Marshall Islands                        29
Mauritania                              99
Mauritius                              100
Micronesia (Federated States of)        29
Mozambique                             126
Namibia                                 70
Nauru                                   29
Niger                                   80
Nigeria                                122
Niue                                    39
Palau                                   29
Papua New Guinea                       103
Rwanda                                  80
Samoa                                  114
São Tomé &amp; Príncipe                     59
Senegal                                 80
Seychelles                              88
Sierra Leone                            68
Solomon Islands                        105
South Africa                            98
Sudan                                  157
Togo                                    80
Tonga                                   79
Tuvalu                                  70
Vanuatu                                 51
Zambia                                  69
Zimbabwe                               126
Timor-Leste                             28
Somalia                                117
Bangladesh                              54
Iran                                    59
Pakistan                                70
Lebanon                                101
Mexico                                 118
Kuwait                                  48
Oman                                    42
Qatar                                   88
Saudi Arabia                            50
United Arab Emirates                    42
Palestinian Territories                 38
El Salvador                             31
Honduras                                31
Taiwan                                   6
Argentina                               60
Bolivia                                 47
Brazil                                  75
Cuba                                    47
Ecuador                                 82
Nicaragua                               76
North Korea                             47
Serbia                                  71
Sri Lanka                               48
Uruguay                                 75
Venezuela                               53
Yemen                                   37
Guatemala                               33
Paraguay                                14
North Macedonia                          1
Montenegro                               1
Panama                                  36
Greenland                                1
Costa Rica                              35
Hong Kong SAR China                      6
Kosovo                                   1</code></pre>
</div>
</div>
<p><strong>Analysis</strong></p>
<p>We see that countries like Egypt, Jordan, Morocco, and Tunisia have relatively high indegree values, indicating that they receive a substantial number of connections from other countries.</p>
<p>On the other hand, outdegree represents the number of outgoing connections or links originating from a particular country. Higher outdegree values suggest that the country has more connections with other countries in the network. Countries like Belgium, Denmark, France, and Turkey have notable outdegree values, indicating that they have numerous connections with other countries.</p>
<hr>
</section>
<section id="creating-a-network-of-intercontinental-regions" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-network-of-intercontinental-regions">Creating a Network of Intercontinental Regions</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rechecking the first 6 rows of the data</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pta_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We create a network using an edgelist as the data structure, allowing us to visualize the connections between global regions and the formation of PTAs. This approach enables us to analyze the structural patterns within the global PTA landscape.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>temp_graph <span class="ot">&lt;-</span> <span class="fu">graph_from_edgelist</span>(<span class="fu">cbind</span>(<span class="fu">head</span>(pta_data<span class="sc">$</span>country1), <span class="fu">head</span>(pta_data<span class="sc">$</span>country2)), <span class="at">directed =</span> F)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get.adjacency</span>(temp_graph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Edgelist</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">head</span>(pta_data<span class="sc">$</span>country1), <span class="fu">head</span>(pta_data<span class="sc">$</span>country2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using the igraph package to create an edgelist</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>edge_net <span class="ot">&lt;-</span> <span class="fu">graph_from_edgelist</span>(<span class="fu">cbind</span>(<span class="fu">head</span>(pta_data<span class="sc">$</span>country1), <span class="fu">head</span>(pta_data<span class="sc">$</span>country2)),</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="at">directed =</span> <span class="cn">FALSE</span>) </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co">#png(filename = "network3.png") # save as png</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co">#randomizes the configuration of the plot</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.igraph</span>(edge_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="CynthiaHester_Final_Project_Social_Networks_Spring_23_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Subset of Adjacency matrix</strong></p>
<p>The adjacency matrix of the Preferential Trade Agreement (PTA) dataset provides a representation of the bilateral trade relationships between countries participating in trade agreements. Each entry in the matrix indicates whether a specific pair of countries has established a preferential trade agreement or not. This binary representation allows us to identify the specific countries that are directly connected through these agreements.</p>
<p>By examining the adjacency matrix, we can observe the clustering and groupings of countries that have formed preferential trade agreements. These clusters indicate the presence of regional trade blocs or alliances, where countries within each cluster have established closer trade ties among themselves. Conversely, countries that are not connected in the adjacency matrix may have limited or no preferential trade agreements with other countries in the dataset.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get.adjacency</span>(edge_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>matrix_net <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(<span class="fu">get.adjacency</span>(edge_net), <span class="at">mode =</span> <span class="st">"undirected"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.igraph</span>(matrix_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="CynthiaHester_Final_Project_Social_Networks_Spring_23_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here we see that both graphs appear identical. This is attributed to the edge list and adjacency matrix representing an undirected network. In an undirected network, the connections between nodes are symmetric and bidirectional.</p>
<p>Network representation of countries based on their inter-regional Preferential Trade Agreements (PTAs)</p>
<hr>
<p>This code enhances the Preferential Trade Agreement(PTA) network graph by attributing each trade agreement with its respective name and the year it was established.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The edges of the network are referred to as E$agt_name, representing the names of the PTAs, and E$year, representing the respective years of these PTAs.</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(pta_intercon_net)<span class="sc">$</span>agt_name <span class="ot">&lt;-</span> pta_intercon<span class="sc">$</span>name</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(pta_intercon_net)<span class="sc">$</span>year <span class="ot">&lt;-</span> pta_intercon<span class="sc">$</span>year</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Analysis</strong></p>
<p>Of note, there may be duplicate edges between pairs of countries, indicating multiple PTAs formed between them. To address this, I assign a weight to each pair based on the number of shared PTAs. To simplify the network by removing loops and consolidating duplicate edges, I utilize the simplify() function from the igraph package. This process entails aggregating the weights of duplicate edges, ensuring a streamlined representation of the network.</p>
<p><strong>Weights</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assigning weight 1 to all edges</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(pta_intercon_net)<span class="sc">$</span>weight <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>pta_intercon_simp <span class="ot">&lt;-</span> <span class="fu">graph.strength</span>(pta_intercon_net, <span class="at">mode =</span> <span class="st">"all"</span>, <span class="at">loops =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Weights Discussion</strong></p>
<p>I first normalize the relationships within the Preferential Trade Agreement (PTA) interconnection network. I do this by assigning a uniform weight of 1 to all edges, effectively treating all connections as equal. Following this, I calculate the strength, or degree, of each node in the network, which gives me the number of connections each node, or country, has within this network. In this calculation, I treat the network as undirected and exclude any loops. The resulting data offers a straightforward view of the interconnectedness of each country within the PTA network, under the assumption that all trade agreements hold the same importance or weight.</p>
<section id="vertices-and-edges" class="level4">
<h4 class="anchored" data-anchor-id="vertices-and-edges">Vertices and Edges</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">V</span>(pta_intercon_net)<span class="sc">$</span>name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Vertices and Edges</strong></p>
<p>number of vertices,and edges in the network</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pta_intercon_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">vcount</span>(pta_intercon_net))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 191</code></pre>
</div>
</div>
<p>The summary indicates the number of <strong>vertices(nodes or countries)</strong> <strong>(191)</strong> and edges <strong>(9316)</strong> in the graph. The following line presents a list of attributes categorized by their kind (g for graph, v for vertex, and e for edge).</p>
<hr>
</section>
</section>
<section id="network-visualizations" class="level2">
<h2 class="anchored" data-anchor-id="network-visualizations">Network Visualizations</h2>
<p>We will generate two separate plots: one depicting the Inter-regional PTA network consisting exclusively of Inter-regional PTAs, and another illustrating the Bilateral PTA network that includes Bilateral agreements regardless of whether they are Inter-regional or regional in nature.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>pta_bilat <span class="ot">&lt;-</span> pta_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(typememb <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>pta_bilat_net <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> pta_bilat, <span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(pta_bilat_net)<span class="sc">$</span>agt_name <span class="ot">&lt;-</span> pta_bilat<span class="sc">$</span>name</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(pta_bilat_net)<span class="sc">$</span>year <span class="ot">&lt;-</span> pta_bilat<span class="sc">$</span>year</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(pta_bilat_net)<span class="sc">$</span>weight <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>pta_bilat_simp <span class="ot">&lt;-</span> <span class="fu">simplify</span>(pta_bilat_net)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Network depiction of Inter-regional Preferential Trade Agreements (PTA)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.igraph</span>(pta_intercon_net,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.size =</span> <span class="dv">5</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.color =</span> <span class="st">"red"</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.label =</span> <span class="fu">V</span>(pta_intercon_net)<span class="sc">$</span>name,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.label.cex =</span> .<span class="dv">5</span>,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.frame.color =</span> <span class="cn">NA</span>,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> layout.fruchterman.reingold,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">"Network of Inter-regional Preferential Trade Agreements(PTA)"</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="CynthiaHester_Final_Project_Social_Networks_Spring_23_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Using all of the data depicts a “hairball” I will therefore use a subset of the data for more comprehensible data representation.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(pta_bilat_simp)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">E</span>(pta_bilat_simp)<span class="sc">$</span>weight <span class="sc">&gt;</span> <span class="dv">1</span>,<span class="st">'blue'</span>, <span class="st">'grey'</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.igraph</span>(pta_bilat_simp,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.size =</span> <span class="dv">5</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.color =</span> <span class="st">"red"</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">vekrtex.label =</span> <span class="fu">V</span>(pta_bilat_simp)<span class="sc">$</span>name,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.label.cex =</span> .<span class="dv">5</span>,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.frame.color =</span> <span class="cn">NA</span>,</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> layout.fruchterman.reingold,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">edge.width =</span> <span class="fu">E</span>(pta_bilat_simp)<span class="sc">$</span>weight,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">"Network of Bilateral Preferential Trade Agreements(PTA)"</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="CynthiaHester_Final_Project_Social_Networks_Spring_23_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot of Bilateral network</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(pta_intercon_net)<span class="sc">$</span>bilateral <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pta_intercon<span class="sc">$</span>typememb <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>bilateral_var <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">E</span>(pta_intercon_net)<span class="sc">$</span>bilateral)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bilateral_var, <span class="fu">aes</span>(<span class="at">x =</span><span class="fu">E</span>(pta_intercon_net)<span class="sc">$</span>bilateral)) <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Bilateral/Multilateral Inter-Regional Preferential Trade Agreements (PTA)"</span>, <span class="at">y =</span> <span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="CynthiaHester_Final_Project_Social_Networks_Spring_23_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#png(filename = "network4.png") # save as png</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The bar plot shows the distribution and relative importance of bilateral and multilateral Preferential Trade Agreements (PTAs) within the framework of social network analysis applied to inter-regional trade relationships. Notably, the left bar exhibits a considerably higher frequency of PTAs compared to the right bar, indicating a distinct prevalence of bilateral PTAs in the network. Conversely,the lower frequency of multilateral PTAs on the right bar signifies a relatively reduced presence of agreements involving multiple nations in the network. Multilateral PTAs typically require more extensive negotiations and coordination among a larger number of countries. The scarcity of such agreements suggests a less pronounced emphasis on broader inter-regional collaboration within the analyzed trade network.</p>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#bilateral inter-regional PTAs</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>pta_intercon_bilat <span class="ot">&lt;-</span> <span class="fu">subgraph.edges</span>(pta_intercon_net,<span class="fu">which</span>(<span class="fu">E</span>(pta_intercon_net)<span class="sc">$</span>bilateral <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pta_intercon_bilat,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size =</span> <span class="dv">5</span>,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="st">"red"</span>,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label =</span> <span class="fu">V</span>(pta_intercon_bilat)<span class="sc">$</span>name,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.cex =</span> .<span class="dv">5</span>,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.frame.color =</span> <span class="cn">NA</span>,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">layout =</span> layout.fruchterman.reingold,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Network of Bilateral Inter-regional PTAs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="CynthiaHester_Final_Project_Social_Networks_Spring_23_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(filename = "network5.png") # save as png</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Eigen Centrality Intercontinental Region</strong></p>
<p>I plot an Eigen centrality for the intercontinetal region which quantifies a country’s influence by factoring both the quantity and quality of its trade agreements.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># eigen centrality </span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(pta_intercon_bilat)<span class="sc">$</span>eigen_cen <span class="ot">&lt;-</span> <span class="fu">eigen_centrality</span>(pta_intercon_bilat)<span class="sc">$</span>vector</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>((<span class="fu">V</span>(pta_intercon_bilat)))</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>eigen_cen <span class="ot">&lt;-</span> <span class="fu">eigen_centrality</span>(pta_intercon_bilat)<span class="sc">$</span>vector</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co"># bar plot</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(eigen_cen, <span class="at">names.arg =</span> <span class="fu">V</span>(pta_intercon_bilat)<span class="sc">$</span>name, <span class="at">xlab =</span> <span class="st">"Country"</span>, <span class="at">ylab =</span> <span class="st">"Eigen Centrality"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">"Eigen Centrality of Countries in PTA Intercontinental Bilateral Network"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="CynthiaHester_Final_Project_Social_Networks_Spring_23_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#png(filename = "network8.png") # save as png</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Analysis</strong></p>
<p>This bar plot represents the eigen centrality values of countries in the PTA Intercontinental Bilateral network. This visualization helps to analyze and interpret the relative importance of countries based on their connections within the network. Countries with higher eigen centrality scores are considered more influential and have stronger trade relationships, while those with lower scores have less impact. This helps identify key players and the distribution of power within the PTA network.</p>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(pta_intercon_bilat)<span class="sc">$</span>weight <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>pta_intercon_bilat_sim <span class="ot">&lt;-</span> pta_intercon_bilat <span class="sc">%&gt;%</span> <span class="fu">simplify</span>(<span class="at">edge.attr.comb =</span> <span class="fu">list</span>(<span class="at">weight =</span> <span class="st">"sum"</span>))</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pta_intercon_bilat_sim,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size =</span> <span class="dv">5</span>,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="st">"blue"</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label =</span> <span class="fu">V</span>(pta_intercon_bilat_sim)<span class="sc">$</span>name,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.cex =</span> .<span class="dv">5</span>,</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.frame.color =</span> <span class="cn">NA</span>,</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">edge.width =</span> <span class="fu">E</span>(pta_intercon_bilat_sim)<span class="sc">$</span>weight,</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">layout =</span> layout.fruchterman.reingold,</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Network of Bilateral Inter-regional Preferential Trade Agreements(PTAs)</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="st">     "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="CynthiaHester_Final_Project_Social_Networks_Spring_23_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#png(filename = "network6.png") # save as png</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
<section id="density-and-transitivity" class="level2">
<h2 class="anchored" data-anchor-id="density-and-transitivity">Density and Transitivity</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>bilat_density <span class="ot">&lt;-</span> <span class="fu">edge_density</span>(pta_intercon_bilat)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>bilat_transitivity <span class="ot">&lt;-</span> <span class="fu">transitivity</span>(pta_intercon_bilat)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co">#density</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>pta_density <span class="ot">&lt;-</span> <span class="fu">edge_density</span>(pta_intercon_net)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>pta_transitivity <span class="ot">&lt;-</span> <span class="fu">transitivity</span>(pta_intercon_net)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>bilat_density</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>pta_bilat_2 <span class="ot">&lt;-</span>  <span class="fu">subgraph.edges</span>(pta_bilat_simp,<span class="fu">which</span>(<span class="fu">E</span>(pta_bilat_simp)<span class="sc">$</span>weight <span class="sc">&gt;</span> <span class="dv">1</span>))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.igraph</span>(pta_bilat_2,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.size =</span> <span class="dv">5</span>,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.color =</span> <span class="st">"green"</span>,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">vekrtex.label =</span> <span class="fu">V</span>(pta_bilat_2)<span class="sc">$</span>name,</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.label.cex =</span> .<span class="dv">5</span>,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.frame.color =</span> <span class="cn">NA</span>,</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> layout.fruchterman.reingold,</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">edge.width =</span> <span class="fu">E</span>(pta_bilat_2)<span class="sc">$</span>weight,</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">"Countries with more than One Bilateral PTAs"</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="CynthiaHester_Final_Project_Social_Networks_Spring_23_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">filename =</span> <span class="st">"network11.png"</span>) <span class="co"># save as png</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
<section id="community" class="level2">
<h2 class="anchored" data-anchor-id="community">Community</h2>
<p><strong>Walktrap Algorithim</strong></p>
<p>For this project examining the Preferential Trade Agreement (PTA) network, I use the Walktrap algorithm, we examined in the 7th tutorial. This approach seeks to find communities within this complex trade network by employing random walks. The guiding principle behind this method is that shorter, random walks will likely stay within the confines of a single community. By applying the Walktrap algorithm to the PTA network, I aim to discern the community structures present within this global trade landscape, thereby shedding light on the intricate dynamics and patterns that shape international trade agreements.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>intercon_bilat_walktrap <span class="ot">&lt;-</span> <span class="fu">cluster_walktrap</span>(pta_intercon_bilat_sim)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">membership</span>(intercon_bilat_walktrap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#bilateral walktrap</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sizes</span>(intercon_bilat_walktrap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># walktrap algorithim output data is in a vector named "output"</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">18</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">20</span>, <span class="dv">3</span>, <span class="dv">12</span>, <span class="dv">2</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># data frame</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Community"</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"Community_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(output)),</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Size"</span> <span class="ot">=</span> output</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the data frame</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(output_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Preferential Trade Agreement(PTA) Walktrap Analysis</strong></p>
<p>The Walktrap algorithm’s output portrays the distribution of nodes across various communities in the Preferential Trade Agreement (PTA) network. Each community number is paired with a value that signifies the count of nodes (or countries) within that specific community.</p>
<p>Here is what we can infer:</p>
<ul>
<li>Community 1 consists of 11 nodes.</li>
<li>Community 2 has 14 nodes.</li>
<li>Community 3 comprises 18 nodes.</li>
<li>Community 4 includes 4 nodes.</li>
<li>Community 5 houses 2 nodes.</li>
<li>Community 6 holds 20 nodes.</li>
<li>Community 7 encapsulates 3 nodes.</li>
<li>Community 8 encompasses 12 nodes.</li>
<li>Community 9 shelters 2 nodes.</li>
</ul>
<p>This distribution provides a snapshot of the diverse interconnectedness among global trade relationships in the PTA network. Communities with larger node counts might represent robustly interconnected trading partnerships, while smaller communities may indicate more specific or self-contained trade relationships.</p>
</section>
<section id="density" class="level2">
<h2 class="anchored" data-anchor-id="density">Density</h2>
<p><strong>PTA Bilateral Density Analysis</strong></p>
<p>The value 0.04924761 represents the bilateral density in the context of the Preferential Trade Agreement (PTA) dataset. Network density measures the actual connections in a network relative to the total possible connections.</p>
<p>Here, a density of 0.04924761 suggests that nearly 4.92% of all potential bilateral trade agreements among countries are realized. This means, on an average, a country in the network has a trade agreement with approximately 4.92% of all other potential trading partners. Given that this value is relatively low, it indicates that the bilateral trade network is sparsely connected, suggesting the potential for many more trade agreements to be formed.</p>
</section>
<section id="transitivity" class="level2">
<h2 class="anchored" data-anchor-id="transitivity">Transitivity</h2>
<p><strong>PTA Bilateral Transitivity</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>bilat_transitivity</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Analysis</strong></p>
<p>In the context of the Preferential Trade Agreement (PTA) dataset, a bilateral transitivity of 0.1098987 signifies that about 11% of the potential triangular trade relationships among countries are realized. This implies that if two countries both have a PTA with a third one, there is an approximately 11% probability that these two countries will also have a trade agreement directly with each other.</p>
<p>This relatively low transitivity index suggests that the formation of PTAs is not extensively based on the principle of transitivity. Rather, it underscores that the establishment of PTAs among countries may be influenced by a multitude of factors, including geographical proximity and political or economic dynamics.</p>
</section>
<section id="dendrogram" class="level2">
<h2 class="anchored" data-anchor-id="dendrogram">Dendrogram</h2>
<p><strong>Dendrogram</strong></p>
<p>In the context of the Preferential Trade Agreement (PTA) dataset focusing on the variables, the dendrogram emerged as an influential graphical representation. It conveys the nested arrangement of relationships among countries or corresponding trade agreements, an arrangement that is guided by specified attributes or significant performance indicators. This hierarchical classification reveals nuanced patterns in international trade interactions, which contributes to a better understanding of intricate PTAs.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>dist_matrix <span class="ot">&lt;-</span> <span class="fu">dist</span>(pta_data) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dist(pta_data): NAs introduced by coercion</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hierarchical clustering using complete linkage</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist_matrix, <span class="at">method =</span> <span class="st">"complete"</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot dendrogram</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.6</span>, <span class="at">main =</span> <span class="st">"Dendrogram for PTA Data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="CynthiaHester_Final_Project_Social_Networks_Spring_23_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#png(filename = "network9.png") # save as png</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<p>The Preferential Trade Agreement (PTA) dataset, spanning from 1958 to 2021, offers a comprehensive view into the evolution of global trade relationships. Delving into this dataset has afforded me a richer understanding of social network analysis in the context of international trade. This journey, albeit marked by a steep learning curve, has been an enlightening one.</p>
<p>The dominance of bilateral PTAs suggests that countries in the network tend to engage in preferential trade arrangements on a bilateral basis, forming direct connections with specific trading partners. This finding underscores the significance of bilateral relationships in shaping the overall structure of the inter-regional trade network. Bilateral PTAs are often favored due to their simplicity in negotiation and implementation, enabling countries to establish tailored agreements that cater to their specific needs and preferences.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> These agreements facilitate focused interactions between pairs of countries, fostering closer economic ties and potentially enhancing trade efficiency and cooperation.</p>
<hr>
</section>
<section id="conclusionreflection" class="level2">
<h2 class="anchored" data-anchor-id="conclusionreflection">Conclusion/Reflection</h2>
<p>Prior to this project, the critical role that variable selection plays in shaping network interpretation was an aspect I hadn’t fully appreciated. Now, I understand that even with the PTA dataset, or for any social network analysis, significant effort can be poured into understanding the relationships between just a couple of variables to derive meaningful insights. Upon reflection, the prospect of analyzing data from more recent years to assess how key features like <strong>node centrality,transitivity,density</strong> and community structure have evolved in the midst of global challenges like the COVID-19 pandemic would merit future study, especially considering recent challenges in global trade and supply chain restrictions.</p>
<p>Despite the hurdles encountered, the process of dissecting this dataset has been rewarding. Every decision made echoed in the analysis outcomes, underscoring the potential for subtle shifts to lead to major interpretation changes. I plan to continue my exploration of the PTA data and branch out to related projects to enhance my understanding of Social Network Analysis.</p>
<hr>
</section>
<section id="referencesresources" class="level2">
<h2 class="anchored" data-anchor-id="referencesresources">References/Resources</h2>


<!-- -->

</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>https://www.designoftradeagreements.org/project-description/<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>https://www.wto.org/<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/Social_Networks_Spring_2023" data-repo-id="R_kgDOI9d_OA" data-category="Announcements" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb69" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "A Network Analysis of Global Preferential Trade Agreements (PTAs)"</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Cynthia Hester"</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "DACSS 697E Social Networks Analysis Final Project"</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "05/20/2023"</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> </span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - Cynthia Hester</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - Final_Project</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - Preferential Trade Agreements (PTAs)  </span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a><span class="co">  - Network of International Trade Agreements</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,include=FALSE}</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,include=FALSE}</span></span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a><span class="do">### Load necessary libraries</span></span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(intergraph)</span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statnet)</span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sna)</span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(network)</span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quarto)</span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true" tabindex="-1"></a><span class="fu"># Research Question:</span></span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-51"><a href="#cb69-51" aria-hidden="true" tabindex="-1"></a>How does the network structure of Preferential Trade Agreements (PTAs) influence international trade patterns and economic integration among participating countries?</span>
<span id="cb69-52"><a href="#cb69-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-53"><a href="#cb69-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-54"><a href="#cb69-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-55"><a href="#cb69-55" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hypothesis:</span></span>
<span id="cb69-56"><a href="#cb69-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-57"><a href="#cb69-57" aria-hidden="true" tabindex="-1"></a>H1: A more dense network structure in Preferential Trade Agreements (PTAs) leads to increased trade flow and economic integration among participating countries.</span>
<span id="cb69-58"><a href="#cb69-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-59"><a href="#cb69-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-60"><a href="#cb69-60" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction:</span></span>
<span id="cb69-61"><a href="#cb69-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-62"><a href="#cb69-62" aria-hidden="true" tabindex="-1"></a>In our Social Network Analysis course, Professor Rolfe highlighted the breadth of applications and emphasized the flexibility to examine any scenario that involved interactive systems. Taking this into account, I chose to focus my project on an area that piqued my personal interest - the intersection of travel and global trade.<span class="ot">[^1]</span></span>
<span id="cb69-63"><a href="#cb69-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-64"><a href="#cb69-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-65"><a href="#cb69-65" aria-hidden="true" tabindex="-1"></a>**What is the source of the data?**</span>
<span id="cb69-66"><a href="#cb69-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-67"><a href="#cb69-67" aria-hidden="true" tabindex="-1"></a>The data utilized for this project are derived from the Design of Trade Agreements (DESTA) database https://www.designoftradeagreements.org/project-description/, a comprehensive resource documenting numerous aspects of Preferential Trade Agreements (PTAs) globally, which was found via the World Trade Organization(WTO). With data spanning PTAs ratified since 1945, the DESTA database offers an examination of the various provisions and areas encompassed by these agreements. Utilizing this dataset was key in bringing the theories and methodologies of Social Network Analysis into practice in a real-world context.</span>
<span id="cb69-68"><a href="#cb69-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-69"><a href="#cb69-69" aria-hidden="true" tabindex="-1"></a>**What is being measured**</span>
<span id="cb69-70"><a href="#cb69-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-71"><a href="#cb69-71" aria-hidden="true" tabindex="-1"></a>The **Preferential Trade Agreement** (PTA) data measures the bilateral agreements between countries that provide preferential access to certain products from the countries involved, reducing tariffs or duties below the level that each country charges other members of the World Trade Organization (WTO).</span>
<span id="cb69-72"><a href="#cb69-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-73"><a href="#cb69-73" aria-hidden="true" tabindex="-1"></a>The data includes variables, such as the (nodes) countries/regions involved, the type of agreement (free trade agreement, customs union, etc.), the date the agreement came into effect, and trade parameters.</span>
<span id="cb69-74"><a href="#cb69-74" aria-hidden="true" tabindex="-1"></a>*************************************************************************************</span>
<span id="cb69-75"><a href="#cb69-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-76"><a href="#cb69-76" aria-hidden="true" tabindex="-1"></a>**Data Format**</span>
<span id="cb69-77"><a href="#cb69-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-78"><a href="#cb69-78" aria-hidden="true" tabindex="-1"></a>It is provided as a matrix, where countries are listed both in rows and columns, and each cell in the matrix indicates whether a trade agreement exists between the two countries. Alternatively, it could be provided as an edgelist, where each row represents an agreement with two columns for the two countries involved. Sometimes, it might also be in the form of an affiliation network, representing memberships of different countries in different agreements. For the purposes of this project it is presented as a matrix.</span>
<span id="cb69-79"><a href="#cb69-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-80"><a href="#cb69-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-81"><a href="#cb69-81" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data</span></span>
<span id="cb69-82"><a href="#cb69-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-83"><a href="#cb69-83" aria-hidden="true" tabindex="-1"></a>As previously stated the data for this project was derived from the Design of Trade Agreements database (DESTA). The data utilized are a universe of cases.</span>
<span id="cb69-84"><a href="#cb69-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-85"><a href="#cb69-85" aria-hidden="true" tabindex="-1"></a><span class="fu">## Wrangling and Exploration</span></span>
<span id="cb69-86"><a href="#cb69-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-87"><a href="#cb69-87" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Import DESTA data</span></span>
<span id="cb69-88"><a href="#cb69-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-89"><a href="#cb69-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-90"><a href="#cb69-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-91"><a href="#cb69-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-92"><a href="#cb69-92" aria-hidden="true" tabindex="-1"></a><span class="co">#preferential trade agreement data (pta)</span></span>
<span id="cb69-93"><a href="#cb69-93" aria-hidden="true" tabindex="-1"></a><span class="co">#DESTA List of Treaties</span></span>
<span id="cb69-94"><a href="#cb69-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-95"><a href="#cb69-95" aria-hidden="true" tabindex="-1"></a>excel_file <span class="ot">&lt;-</span> <span class="st">"C:/Users/Bud/Downloads/desta_list_of_treaties_02_01_dyads.xlsx"</span></span>
<span id="cb69-96"><a href="#cb69-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-97"><a href="#cb69-97" aria-hidden="true" tabindex="-1"></a>desta_list <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(excel_file, <span class="at">sheet =</span> <span class="st">"data"</span>)</span>
<span id="cb69-98"><a href="#cb69-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-99"><a href="#cb69-99" aria-hidden="true" tabindex="-1"></a>pta_data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path =</span> excel_file, <span class="at">sheet =</span> <span class="dv">2</span>) </span>
<span id="cb69-100"><a href="#cb69-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-101"><a href="#cb69-101" aria-hidden="true" tabindex="-1"></a>pta_data<span class="sc">$</span>regioncon <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pta_data<span class="sc">$</span>regioncon)</span>
<span id="cb69-102"><a href="#cb69-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-103"><a href="#cb69-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-104"><a href="#cb69-104" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-105"><a href="#cb69-105" aria-hidden="true" tabindex="-1"></a>*************************************************************************************</span>
<span id="cb69-106"><a href="#cb69-106" aria-hidden="true" tabindex="-1"></a><span class="fu">## Inspect PTA trade agreement data/ Descriptive Statistics</span></span>
<span id="cb69-107"><a href="#cb69-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-108"><a href="#cb69-108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-109"><a href="#cb69-109" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pta_data)</span>
<span id="cb69-110"><a href="#cb69-110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-111"><a href="#cb69-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-112"><a href="#cb69-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-113"><a href="#cb69-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-114"><a href="#cb69-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-115"><a href="#cb69-115" aria-hidden="true" tabindex="-1"></a><span class="co">#first few rows of the data</span></span>
<span id="cb69-116"><a href="#cb69-116" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pta_data) <span class="co">#look at the structure of the data</span></span>
<span id="cb69-117"><a href="#cb69-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-118"><a href="#cb69-118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-119"><a href="#cb69-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-120"><a href="#cb69-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-121"><a href="#cb69-121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-122"><a href="#cb69-122" aria-hidden="true" tabindex="-1"></a><span class="co">#inspect the data</span></span>
<span id="cb69-123"><a href="#cb69-123" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(pta_data) </span>
<span id="cb69-124"><a href="#cb69-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-125"><a href="#cb69-125" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-126"><a href="#cb69-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-127"><a href="#cb69-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-128"><a href="#cb69-128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-129"><a href="#cb69-129" aria-hidden="true" tabindex="-1"></a>missing_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(pta_data, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb69-130"><a href="#cb69-130" aria-hidden="true" tabindex="-1"></a>missing_values</span>
<span id="cb69-131"><a href="#cb69-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-132"><a href="#cb69-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-133"><a href="#cb69-133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-134"><a href="#cb69-134" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows with missing values in country1 or country2 columns</span></span>
<span id="cb69-135"><a href="#cb69-135" aria-hidden="true" tabindex="-1"></a>pta_data <span class="ot">&lt;-</span> pta_data[<span class="fu">complete.cases</span>(pta_data<span class="sc">$</span>country1, pta_data<span class="sc">$</span>country2), ]</span>
<span id="cb69-136"><a href="#cb69-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-137"><a href="#cb69-137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-138"><a href="#cb69-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-139"><a href="#cb69-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-140"><a href="#cb69-140" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values in country1 and country2 columns</span></span>
<span id="cb69-141"><a href="#cb69-141" aria-hidden="true" tabindex="-1"></a>missing_country1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(pta_data<span class="sc">$</span>country1))</span>
<span id="cb69-142"><a href="#cb69-142" aria-hidden="true" tabindex="-1"></a>missing_country2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(pta_data<span class="sc">$</span>country2))</span>
<span id="cb69-143"><a href="#cb69-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-144"><a href="#cb69-144" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the number of missing values</span></span>
<span id="cb69-145"><a href="#cb69-145" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of missing values in country1 column:"</span>, missing_country1, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb69-146"><a href="#cb69-146" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of missing values in country2 column:"</span>, missing_country2, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb69-147"><a href="#cb69-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-148"><a href="#cb69-148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-149"><a href="#cb69-149" aria-hidden="true" tabindex="-1"></a>***********************************************************************************</span>
<span id="cb69-150"><a href="#cb69-150" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Adjacency Matrix for entire dataset</span></span>
<span id="cb69-151"><a href="#cb69-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-152"><a href="#cb69-152" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-153"><a href="#cb69-153" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pta_data)</span>
<span id="cb69-154"><a href="#cb69-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-155"><a href="#cb69-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-156"><a href="#cb69-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-157"><a href="#cb69-157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-158"><a href="#cb69-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-159"><a href="#cb69-159" aria-hidden="true" tabindex="-1"></a>  pta_data[<span class="dv">1</span> <span class="sc">:</span> <span class="dv">16</span>, <span class="dv">1</span> <span class="sc">:</span> <span class="dv">16</span>]</span>
<span id="cb69-160"><a href="#cb69-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-161"><a href="#cb69-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-162"><a href="#cb69-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-163"><a href="#cb69-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-164"><a href="#cb69-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-165"><a href="#cb69-165" aria-hidden="true" tabindex="-1"></a><span class="co">#install and load the igraph package</span></span>
<span id="cb69-166"><a href="#cb69-166" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(igraph)) {</span>
<span id="cb69-167"><a href="#cb69-167" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"igraph"</span>)</span>
<span id="cb69-168"><a href="#cb69-168" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(igraph)</span>
<span id="cb69-169"><a href="#cb69-169" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-170"><a href="#cb69-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-171"><a href="#cb69-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-172"><a href="#cb69-172" aria-hidden="true" tabindex="-1"></a>graph <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> pta_data, <span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb69-173"><a href="#cb69-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-174"><a href="#cb69-174" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the adjacency matrix</span></span>
<span id="cb69-175"><a href="#cb69-175" aria-hidden="true" tabindex="-1"></a>adj_matrix <span class="ot">&lt;-</span> <span class="fu">as_adjacency_matrix</span>(graph)</span>
<span id="cb69-176"><a href="#cb69-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-177"><a href="#cb69-177" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the adjacency matrix</span></span>
<span id="cb69-178"><a href="#cb69-178" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(adj_matrix)</span>
<span id="cb69-179"><a href="#cb69-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-180"><a href="#cb69-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-181"><a href="#cb69-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-182"><a href="#cb69-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-183"><a href="#cb69-183" aria-hidden="true" tabindex="-1"></a>nodes(countries)</span>
<span id="cb69-184"><a href="#cb69-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-185"><a href="#cb69-185" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-186"><a href="#cb69-186" aria-hidden="true" tabindex="-1"></a><span class="fu">vcount</span>(graph)</span>
<span id="cb69-187"><a href="#cb69-187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-188"><a href="#cb69-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-189"><a href="#cb69-189" aria-hidden="true" tabindex="-1"></a>edges(trade ties)</span>
<span id="cb69-190"><a href="#cb69-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-191"><a href="#cb69-191" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-192"><a href="#cb69-192" aria-hidden="true" tabindex="-1"></a><span class="fu">ecount</span>(graph)</span>
<span id="cb69-193"><a href="#cb69-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-194"><a href="#cb69-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-195"><a href="#cb69-195" aria-hidden="true" tabindex="-1"></a>Calculating proportion of nodes </span>
<span id="cb69-196"><a href="#cb69-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-197"><a href="#cb69-197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-198"><a href="#cb69-198" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the number of nodes</span></span>
<span id="cb69-199"><a href="#cb69-199" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">V</span>(graph)</span>
<span id="cb69-200"><a href="#cb69-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-201"><a href="#cb69-201" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the proportion of non-zero entries</span></span>
<span id="cb69-202"><a href="#cb69-202" aria-hidden="true" tabindex="-1"></a>prop_nonzero <span class="ot">&lt;-</span> <span class="fu">sum</span>(adj_matrix[] <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">/</span> <span class="fu">length</span>(nodes) <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb69-203"><a href="#cb69-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-204"><a href="#cb69-204" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the proportion</span></span>
<span id="cb69-205"><a href="#cb69-205" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(prop_nonzero)</span>
<span id="cb69-206"><a href="#cb69-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-207"><a href="#cb69-207" aria-hidden="true" tabindex="-1"></a>*******************************************************************************</span>
<span id="cb69-208"><a href="#cb69-208" aria-hidden="true" tabindex="-1"></a>**Analysis**</span>
<span id="cb69-209"><a href="#cb69-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-210"><a href="#cb69-210" aria-hidden="true" tabindex="-1"></a>The output value 0.3540465 indicates that, based on the **pta_data**, approximately 35.4% of all potential bilateral Preferential Trade Agreements (PTAs) among countries are in place. This shows a considerable degree of interconnectedness in global trade. It also suggests substantial room for more PTAs, as 64.6% of potential agreements are unexplored.</span>
<span id="cb69-211"><a href="#cb69-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-212"><a href="#cb69-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-213"><a href="#cb69-213" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-214"><a href="#cb69-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-215"><a href="#cb69-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-216"><a href="#cb69-216" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> <span class="fu">V</span>(graph)<span class="sc">$</span>name,</span>
<span id="cb69-217"><a href="#cb69-217" aria-hidden="true" tabindex="-1"></a>                    <span class="at">all.degree =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(graph), </span>
<span id="cb69-218"><a href="#cb69-218" aria-hidden="true" tabindex="-1"></a>                    <span class="at">out.degree =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(graph, <span class="at">mode =</span> <span class="st">'out'</span>),</span>
<span id="cb69-219"><a href="#cb69-219" aria-hidden="true" tabindex="-1"></a>                    <span class="at">in.degree =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(graph, <span class="at">mode =</span> <span class="st">'in'</span>), </span>
<span id="cb69-220"><a href="#cb69-220" aria-hidden="true" tabindex="-1"></a>                    <span class="at">total.degree =</span> igraph<span class="sc">::</span><span class="fu">degree</span>(graph, <span class="at">mode =</span> <span class="st">'total'</span>),</span>
<span id="cb69-221"><a href="#cb69-221" aria-hidden="true" tabindex="-1"></a>                    <span class="at">eigen.centrality =</span> igraph<span class="sc">::</span><span class="fu">eigen_centrality</span>(graph)<span class="sc">$</span>vector)</span>
<span id="cb69-222"><a href="#cb69-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-223"><a href="#cb69-223" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nodes)</span>
<span id="cb69-224"><a href="#cb69-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-225"><a href="#cb69-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-226"><a href="#cb69-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-227"><a href="#cb69-227" aria-hidden="true" tabindex="-1"></a>**********************************************************************************</span>
<span id="cb69-228"><a href="#cb69-228" aria-hidden="true" tabindex="-1"></a>**Distribution**</span>
<span id="cb69-229"><a href="#cb69-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-230"><a href="#cb69-230" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-231"><a href="#cb69-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-232"><a href="#cb69-232" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb69-233"><a href="#cb69-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-234"><a href="#cb69-234" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram for all_degree</span></span>
<span id="cb69-235"><a href="#cb69-235" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nodes, <span class="fu">aes</span>(<span class="at">x=</span>all.degree)) <span class="sc">+</span></span>
<span id="cb69-236"><a href="#cb69-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">1</span>, <span class="at">fill=</span><span class="st">"steelblue"</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb69-237"><a href="#cb69-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of All Degree"</span>) <span class="sc">+</span></span>
<span id="cb69-238"><a href="#cb69-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"All Degree"</span>) <span class="sc">+</span></span>
<span id="cb69-239"><a href="#cb69-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Count"</span>)</span>
<span id="cb69-240"><a href="#cb69-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-241"><a href="#cb69-241" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram for out_degree</span></span>
<span id="cb69-242"><a href="#cb69-242" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nodes, <span class="fu">aes</span>(<span class="at">x=</span>out.degree)) <span class="sc">+</span></span>
<span id="cb69-243"><a href="#cb69-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">1</span>, <span class="at">fill=</span><span class="st">"steelblue"</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb69-244"><a href="#cb69-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of Out Degree"</span>) <span class="sc">+</span></span>
<span id="cb69-245"><a href="#cb69-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Out Degree"</span>) <span class="sc">+</span></span>
<span id="cb69-246"><a href="#cb69-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Count"</span>)</span>
<span id="cb69-247"><a href="#cb69-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-248"><a href="#cb69-248" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram for in_degree</span></span>
<span id="cb69-249"><a href="#cb69-249" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nodes, <span class="fu">aes</span>(<span class="at">x=</span>in.degree)) <span class="sc">+</span></span>
<span id="cb69-250"><a href="#cb69-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">1</span>, <span class="at">fill=</span><span class="st">"steelblue"</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb69-251"><a href="#cb69-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of In Degree"</span>) <span class="sc">+</span></span>
<span id="cb69-252"><a href="#cb69-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"In Degree"</span>) <span class="sc">+</span></span>
<span id="cb69-253"><a href="#cb69-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Count"</span>)</span>
<span id="cb69-254"><a href="#cb69-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-255"><a href="#cb69-255" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram for eigen_centrality</span></span>
<span id="cb69-256"><a href="#cb69-256" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nodes, <span class="fu">aes</span>(<span class="at">x=</span>eigen.centrality)) <span class="sc">+</span></span>
<span id="cb69-257"><a href="#cb69-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="fl">0.1</span>, <span class="at">fill=</span><span class="st">"steelblue"</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb69-258"><a href="#cb69-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of Eigen Centrality"</span>) <span class="sc">+</span></span>
<span id="cb69-259"><a href="#cb69-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Eigen Centrality"</span>) <span class="sc">+</span></span>
<span id="cb69-260"><a href="#cb69-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Count"</span>)</span>
<span id="cb69-261"><a href="#cb69-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-262"><a href="#cb69-262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-263"><a href="#cb69-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-264"><a href="#cb69-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-265"><a href="#cb69-265" aria-hidden="true" tabindex="-1"></a>**Analysis**</span>
<span id="cb69-266"><a href="#cb69-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-267"><a href="#cb69-267" aria-hidden="true" tabindex="-1"></a>This distribution reveals how nations in the PTA network interact. High degree centrality indicates a country's extensive trade relationships. High out-degree signifies proactive trade agreement initiation, while high in-degree suggests a country's attractiveness as a trade partner. Lastly, elevated eigenvector centrality reveals a nation's importance within major trade blocs or networks.</span>
<span id="cb69-268"><a href="#cb69-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-269"><a href="#cb69-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-270"><a href="#cb69-270" aria-hidden="true" tabindex="-1"></a>*************************************************************************************</span>
<span id="cb69-271"><a href="#cb69-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-272"><a href="#cb69-272" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dyad and Triad Census</span></span>
<span id="cb69-273"><a href="#cb69-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-274"><a href="#cb69-274" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-275"><a href="#cb69-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-276"><a href="#cb69-276" aria-hidden="true" tabindex="-1"></a><span class="fu">dyad.census</span>(nodes)</span>
<span id="cb69-277"><a href="#cb69-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-278"><a href="#cb69-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-279"><a href="#cb69-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-280"><a href="#cb69-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-281"><a href="#cb69-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-282"><a href="#cb69-282" aria-hidden="true" tabindex="-1"></a><span class="fu">triad.census</span>(nodes)</span>
<span id="cb69-283"><a href="#cb69-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-284"><a href="#cb69-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-285"><a href="#cb69-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-286"><a href="#cb69-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-287"><a href="#cb69-287" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Exploration</span></span>
<span id="cb69-288"><a href="#cb69-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-289"><a href="#cb69-289" aria-hidden="true" tabindex="-1"></a>This is a large dataset so I will focus on two variables; **year and region**. To better understand the data I will visualize it using the ggplot package from the tidyverse.</span>
<span id="cb69-290"><a href="#cb69-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-291"><a href="#cb69-291" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-292"><a href="#cb69-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-293"><a href="#cb69-293" aria-hidden="true" tabindex="-1"></a><span class="co"># counts the frequency of ties between any two countries formed by year and region.</span></span>
<span id="cb69-294"><a href="#cb69-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-295"><a href="#cb69-295" aria-hidden="true" tabindex="-1"></a>pta_data_count <span class="ot">&lt;-</span> pta_data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(year, regioncon) <span class="sc">%&gt;%</span> <span class="fu">count</span>(name) </span>
<span id="cb69-296"><a href="#cb69-296" aria-hidden="true" tabindex="-1"></a>pta_data_count <span class="ot">&lt;-</span> pta_data_count <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb69-297"><a href="#cb69-297" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(pta_data_count), <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Region"</span>, <span class="st">"Agreement name"</span>, <span class="st">"Number of Ties"</span>),</span>
<span id="cb69-298"><a href="#cb69-298" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Frequency of Ties Table"</span>)</span>
<span id="cb69-299"><a href="#cb69-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-300"><a href="#cb69-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-301"><a href="#cb69-301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-302"><a href="#cb69-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-303"><a href="#cb69-303" aria-hidden="true" tabindex="-1"></a>*******************************************************************************</span>
<span id="cb69-304"><a href="#cb69-304" aria-hidden="true" tabindex="-1"></a><span class="fu">## Centrality</span></span>
<span id="cb69-305"><a href="#cb69-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-306"><a href="#cb69-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-307"><a href="#cb69-307" aria-hidden="true" tabindex="-1"></a>Intercontinental Region</span>
<span id="cb69-308"><a href="#cb69-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-309"><a href="#cb69-309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-310"><a href="#cb69-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-311"><a href="#cb69-311" aria-hidden="true" tabindex="-1"></a>pta_intercon <span class="ot">&lt;-</span> pta_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(regioncon <span class="sc">==</span> <span class="st">"Intercontinental"</span>)</span>
<span id="cb69-312"><a href="#cb69-312" aria-hidden="true" tabindex="-1"></a>pta_intercon_net <span class="ot">&lt;-</span> <span class="fu">graph_from_edgelist</span>(<span class="fu">cbind</span>(pta_intercon<span class="sc">$</span>country1, pta_intercon<span class="sc">$</span>country2), <span class="at">directed =</span> F)</span>
<span id="cb69-313"><a href="#cb69-313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-314"><a href="#cb69-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-315"><a href="#cb69-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-316"><a href="#cb69-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-317"><a href="#cb69-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-318"><a href="#cb69-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-319"><a href="#cb69-319" aria-hidden="true" tabindex="-1"></a> **Degree Centrality Intercontinental Region**</span>
<span id="cb69-320"><a href="#cb69-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-323"><a href="#cb69-323" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb69-324"><a href="#cb69-324" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb69-325"><a href="#cb69-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-326"><a href="#cb69-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-327"><a href="#cb69-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-328"><a href="#cb69-328" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a graph from the pta_data</span></span>
<span id="cb69-329"><a href="#cb69-329" aria-hidden="true" tabindex="-1"></a>pta_net <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> pta_data_count, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb69-330"><a href="#cb69-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-331"><a href="#cb69-331" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the degree centrality</span></span>
<span id="cb69-332"><a href="#cb69-332" aria-hidden="true" tabindex="-1"></a>degree_centrality <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">degree</span>(pta_net, <span class="at">mode =</span> <span class="st">"all"</span>)</span>
<span id="cb69-333"><a href="#cb69-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-334"><a href="#cb69-334" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the degree centrality values</span></span>
<span id="cb69-335"><a href="#cb69-335" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(degree_centrality)</span>
<span id="cb69-336"><a href="#cb69-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-337"><a href="#cb69-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-338"><a href="#cb69-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-339"><a href="#cb69-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-340"><a href="#cb69-340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-341"><a href="#cb69-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-342"><a href="#cb69-342" aria-hidden="true" tabindex="-1"></a>**Degree Centrality Analysis**</span>
<span id="cb69-343"><a href="#cb69-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-344"><a href="#cb69-344" aria-hidden="true" tabindex="-1"></a>In the context of degree centrality, the nodes with the highest degree centrality values can be considered the most important or influential nodes in the network. These nodes have a large number of connections (edges) with other nodes in the network. </span>
<span id="cb69-345"><a href="#cb69-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-346"><a href="#cb69-346" aria-hidden="true" tabindex="-1"></a>Nodes(regions) with the highest degree centrality values are:</span>
<span id="cb69-347"><a href="#cb69-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-348"><a href="#cb69-348" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Europe: 260</span>
<span id="cb69-349"><a href="#cb69-349" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Americas: 231</span>
<span id="cb69-350"><a href="#cb69-350" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Asia: 140</span>
<span id="cb69-351"><a href="#cb69-351" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Intercontinental: 382</span>
<span id="cb69-352"><a href="#cb69-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-353"><a href="#cb69-353" aria-hidden="true" tabindex="-1"></a>These nodes represent regions or continents and have the highest number of connections with other nodes in the network. Therefore, they can be considered the most significant or influential  network connectivity.</span>
<span id="cb69-354"><a href="#cb69-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-355"><a href="#cb69-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-356"><a href="#cb69-356" aria-hidden="true" tabindex="-1"></a>**Betweenness Centrality**</span>
<span id="cb69-357"><a href="#cb69-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-360"><a href="#cb69-360" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb69-361"><a href="#cb69-361" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb69-362"><a href="#cb69-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-363"><a href="#cb69-363" aria-hidden="true" tabindex="-1"></a><span class="co"># graph from the pta_data_count</span></span>
<span id="cb69-364"><a href="#cb69-364" aria-hidden="true" tabindex="-1"></a>pta_net <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> pta_data_count, <span class="at">directed =</span> F)</span>
<span id="cb69-365"><a href="#cb69-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-366"><a href="#cb69-366" aria-hidden="true" tabindex="-1"></a><span class="co"># betweenness centrality</span></span>
<span id="cb69-367"><a href="#cb69-367" aria-hidden="true" tabindex="-1"></a>betweenness_centrality <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">betweenness</span>(pta_net, <span class="at">directed =</span> F)</span>
<span id="cb69-368"><a href="#cb69-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-369"><a href="#cb69-369" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the betweenness centrality values</span></span>
<span id="cb69-370"><a href="#cb69-370" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(betweenness_centrality)</span>
<span id="cb69-371"><a href="#cb69-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-372"><a href="#cb69-372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-373"><a href="#cb69-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-374"><a href="#cb69-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-375"><a href="#cb69-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-376"><a href="#cb69-376" aria-hidden="true" tabindex="-1"></a>**Betweenness Analysis**</span>
<span id="cb69-377"><a href="#cb69-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-378"><a href="#cb69-378" aria-hidden="true" tabindex="-1"></a>Egypt, Jordan, and Morocco are identified as nodes with high betweenness centrality. These countries serve as key intermediaries in facilitating trade relationships and information exchange between other countries within the network.</span>
<span id="cb69-379"><a href="#cb69-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-380"><a href="#cb69-380" aria-hidden="true" tabindex="-1"></a>On the other hand, nodes with lower betweenness centrality values, such as Albania or Armenia, have less influence in connecting different parts of the network. While they still contribute to the network structure, their impact on information flow and communication may be comparatively lower.</span>
<span id="cb69-381"><a href="#cb69-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-382"><a href="#cb69-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-383"><a href="#cb69-383" aria-hidden="true" tabindex="-1"></a>*******************************************************************************</span>
<span id="cb69-384"><a href="#cb69-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-385"><a href="#cb69-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-386"><a href="#cb69-386" aria-hidden="true" tabindex="-1"></a>**Summary of Preferential Trade Agreement data**</span>
<span id="cb69-387"><a href="#cb69-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-388"><a href="#cb69-388" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-389"><a href="#cb69-389" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">summary</span>(pta_data_count), <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Region"</span>, <span class="st">"Agreement name"</span>, <span class="st">"Number of Ties"</span>), </span>
<span id="cb69-390"><a href="#cb69-390" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"A Summary of the Frequency of Ties Data"</span>) <span class="co">#summary() provide a summary of the data</span></span>
<span id="cb69-391"><a href="#cb69-391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-392"><a href="#cb69-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-393"><a href="#cb69-393" aria-hidden="true" tabindex="-1"></a><span class="fu">##  Overview</span></span>
<span id="cb69-394"><a href="#cb69-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-395"><a href="#cb69-395" aria-hidden="true" tabindex="-1"></a>An overview of the data reveals six distinct categories: Africa, Americas, Asia, Europe, Oceania, and Intercontinental. Interestingly, most PTAs are Intercontinental, tallying 382 agreements, while Oceania, given the limited number of nations in the region, has only  12 intra-regional agreements.</span>
<span id="cb69-396"><a href="#cb69-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-397"><a href="#cb69-397" aria-hidden="true" tabindex="-1"></a>The next stage of my exploration will involve identifying patterns of multilateral and bilateral PTA formation among different countries.</span>
<span id="cb69-398"><a href="#cb69-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-399"><a href="#cb69-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-400"><a href="#cb69-400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-401"><a href="#cb69-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-402"><a href="#cb69-402" aria-hidden="true" tabindex="-1"></a><span class="co">#filter the new data: which countries tend to form multilateral PTAs and which countries tend to form bilateral PTAs</span></span>
<span id="cb69-403"><a href="#cb69-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-404"><a href="#cb69-404" aria-hidden="true" tabindex="-1"></a>pta_data_count <span class="ot">&lt;-</span> pta_data_count <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">bilat =</span> <span class="fu">ifelse</span>(n <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"bilateral"</span>, <span class="st">"multilateral"</span>)) <span class="co">#creating a new variable to see if a tie belongs to a bilateral or multilateral treaty</span></span>
<span id="cb69-405"><a href="#cb69-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-406"><a href="#cb69-406" aria-hidden="true" tabindex="-1"></a><span class="co">#png(filename = "network1.png") # save as png</span></span>
<span id="cb69-407"><a href="#cb69-407" aria-hidden="true" tabindex="-1"></a>pta_data_count<span class="sc">$</span>bilat <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pta_data_count<span class="sc">$</span>bilat)</span>
<span id="cb69-408"><a href="#cb69-408" aria-hidden="true" tabindex="-1"></a>region_count <span class="ot">&lt;-</span> pta_data_count <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(regioncon, bilat) <span class="sc">%&gt;%</span> <span class="fu">count</span>(regioncon)</span>
<span id="cb69-409"><a href="#cb69-409" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(region_count, <span class="fu">aes</span>(<span class="at">x=</span> regioncon, <span class="at">y =</span> n, <span class="at">color =</span> bilat, <span class="at">fill =</span> bilat)) <span class="sc">+</span></span>
<span id="cb69-410"><a href="#cb69-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span>
<span id="cb69-411"><a href="#cb69-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-412"><a href="#cb69-412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-413"><a href="#cb69-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-414"><a href="#cb69-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-415"><a href="#cb69-415" aria-hidden="true" tabindex="-1"></a>It's observed that African nations exhibit a preference for multilateral **PTAs** as opposed to bilateral ones. Conversely, countries in the Americas and Asia predominantly lean towards bilateral **PTAs**. Europe and Oceania display an almost equal inclination towards both bilateral and multilateral **PTAs**. Of note when it comes to inter-regional PTAs, there appears to be no clear preference between bilateral and multilateral arrangements.</span>
<span id="cb69-416"><a href="#cb69-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-417"><a href="#cb69-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-418"><a href="#cb69-418" aria-hidden="true" tabindex="-1"></a>*******************************************************************************</span>
<span id="cb69-419"><a href="#cb69-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-420"><a href="#cb69-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-421"><a href="#cb69-421" aria-hidden="true" tabindex="-1"></a>Creating a plot to visualize the number of ties formed annually by region reinforces indicates thats Africa is particularly prominent in terms of the number of ties established, as well as in forming intra-regional PTAs, with Europe following closely. Meanwhile, Asia, the Americas, and Oceania demonstrate a preference for forming bilateral agreements.</span>
<span id="cb69-422"><a href="#cb69-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-423"><a href="#cb69-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-424"><a href="#cb69-424" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-425"><a href="#cb69-425" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualizing ties formed annually by global region</span></span>
<span id="cb69-426"><a href="#cb69-426" aria-hidden="true" tabindex="-1"></a><span class="co">#png(filename = "network2.png") # save as png</span></span>
<span id="cb69-427"><a href="#cb69-427" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pta_data_count, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> n, <span class="at">color =</span> regioncon, <span class="at">fill =</span> regioncon)) <span class="sc">+</span></span>
<span id="cb69-428"><a href="#cb69-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>regioncon)</span>
<span id="cb69-429"><a href="#cb69-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-430"><a href="#cb69-430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-431"><a href="#cb69-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-432"><a href="#cb69-432" aria-hidden="true" tabindex="-1"></a>Indegree/ Outdegree of PTAs Intercontinental Region</span>
<span id="cb69-433"><a href="#cb69-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-436"><a href="#cb69-436" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb69-437"><a href="#cb69-437" aria-hidden="true" tabindex="-1"></a><span class="co"># indegree and outdegree</span></span>
<span id="cb69-438"><a href="#cb69-438" aria-hidden="true" tabindex="-1"></a>indegree <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(pta_intercon_net)))</span>
<span id="cb69-439"><a href="#cb69-439" aria-hidden="true" tabindex="-1"></a>outdegree <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(<span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(pta_intercon_net)))</span>
<span id="cb69-440"><a href="#cb69-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-441"><a href="#cb69-441" aria-hidden="true" tabindex="-1"></a><span class="co"># data frame with indegree and outdegree values</span></span>
<span id="cb69-442"><a href="#cb69-442" aria-hidden="true" tabindex="-1"></a>degree_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">country =</span> <span class="fu">V</span>(pta_intercon_net)<span class="sc">$</span>name, <span class="at">indegree =</span> indegree, <span class="at">outdegree =</span> outdegree)</span>
<span id="cb69-443"><a href="#cb69-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-444"><a href="#cb69-444" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the degree information</span></span>
<span id="cb69-445"><a href="#cb69-445" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(degree_df)</span>
<span id="cb69-446"><a href="#cb69-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-447"><a href="#cb69-447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-448"><a href="#cb69-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-449"><a href="#cb69-449" aria-hidden="true" tabindex="-1"></a>**Analysis**</span>
<span id="cb69-450"><a href="#cb69-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-451"><a href="#cb69-451" aria-hidden="true" tabindex="-1"></a>We see that countries like Egypt, Jordan, Morocco, and Tunisia have relatively high indegree values, indicating that they receive a substantial number of connections from other countries.</span>
<span id="cb69-452"><a href="#cb69-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-453"><a href="#cb69-453" aria-hidden="true" tabindex="-1"></a>On the other hand, outdegree represents the number of outgoing connections or links originating from a particular country. Higher outdegree values suggest that the country has more connections with other countries in the network. Countries like Belgium, Denmark, France, and Turkey have notable outdegree values, indicating that they have numerous connections with other countries.</span>
<span id="cb69-454"><a href="#cb69-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-455"><a href="#cb69-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-456"><a href="#cb69-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-457"><a href="#cb69-457" aria-hidden="true" tabindex="-1"></a>*******************************************************************************</span>
<span id="cb69-458"><a href="#cb69-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-459"><a href="#cb69-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-460"><a href="#cb69-460" aria-hidden="true" tabindex="-1"></a><span class="fu">## Creating a Network of Intercontinental Regions</span></span>
<span id="cb69-461"><a href="#cb69-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-462"><a href="#cb69-462" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-463"><a href="#cb69-463" aria-hidden="true" tabindex="-1"></a><span class="co"># rechecking the first 6 rows of the data</span></span>
<span id="cb69-464"><a href="#cb69-464" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pta_data)</span>
<span id="cb69-465"><a href="#cb69-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-466"><a href="#cb69-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-467"><a href="#cb69-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-468"><a href="#cb69-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-469"><a href="#cb69-469" aria-hidden="true" tabindex="-1"></a>We create a network using an edgelist as the data structure, allowing us to visualize the connections between global regions and the formation of PTAs. This approach enables us to analyze the structural patterns within the global PTA landscape.</span>
<span id="cb69-470"><a href="#cb69-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-471"><a href="#cb69-471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-472"><a href="#cb69-472" aria-hidden="true" tabindex="-1"></a>temp_graph <span class="ot">&lt;-</span> <span class="fu">graph_from_edgelist</span>(<span class="fu">cbind</span>(<span class="fu">head</span>(pta_data<span class="sc">$</span>country1), <span class="fu">head</span>(pta_data<span class="sc">$</span>country2)), <span class="at">directed =</span> F)</span>
<span id="cb69-473"><a href="#cb69-473" aria-hidden="true" tabindex="-1"></a><span class="fu">get.adjacency</span>(temp_graph)</span>
<span id="cb69-474"><a href="#cb69-474" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-475"><a href="#cb69-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-476"><a href="#cb69-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-477"><a href="#cb69-477" aria-hidden="true" tabindex="-1"></a>**Edgelist**</span>
<span id="cb69-478"><a href="#cb69-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-479"><a href="#cb69-479" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-480"><a href="#cb69-480" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">head</span>(pta_data<span class="sc">$</span>country1), <span class="fu">head</span>(pta_data<span class="sc">$</span>country2))</span>
<span id="cb69-481"><a href="#cb69-481" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-482"><a href="#cb69-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-483"><a href="#cb69-483" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-484"><a href="#cb69-484" aria-hidden="true" tabindex="-1"></a><span class="co"># using the igraph package to create an edgelist</span></span>
<span id="cb69-485"><a href="#cb69-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-486"><a href="#cb69-486" aria-hidden="true" tabindex="-1"></a>edge_net <span class="ot">&lt;-</span> <span class="fu">graph_from_edgelist</span>(<span class="fu">cbind</span>(<span class="fu">head</span>(pta_data<span class="sc">$</span>country1), <span class="fu">head</span>(pta_data<span class="sc">$</span>country2)),</span>
<span id="cb69-487"><a href="#cb69-487" aria-hidden="true" tabindex="-1"></a><span class="at">directed =</span> <span class="cn">FALSE</span>) </span>
<span id="cb69-488"><a href="#cb69-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-489"><a href="#cb69-489" aria-hidden="true" tabindex="-1"></a><span class="co">#png(filename = "network3.png") # save as png</span></span>
<span id="cb69-490"><a href="#cb69-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-491"><a href="#cb69-491" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co">#randomizes the configuration of the plot</span></span>
<span id="cb69-492"><a href="#cb69-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-493"><a href="#cb69-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-494"><a href="#cb69-494" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.igraph</span>(edge_net)</span>
<span id="cb69-495"><a href="#cb69-495" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-496"><a href="#cb69-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-497"><a href="#cb69-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-498"><a href="#cb69-498" aria-hidden="true" tabindex="-1"></a>**Subset of Adjacency matrix**</span>
<span id="cb69-499"><a href="#cb69-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-500"><a href="#cb69-500" aria-hidden="true" tabindex="-1"></a>The adjacency matrix of the Preferential Trade Agreement (PTA) dataset provides a  representation of the bilateral trade relationships between countries participating in trade agreements. Each entry in the matrix indicates whether a specific pair of countries has established a preferential trade agreement or not. This binary representation allows us to identify the specific countries that are directly connected through these agreements.</span>
<span id="cb69-501"><a href="#cb69-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-502"><a href="#cb69-502" aria-hidden="true" tabindex="-1"></a>By examining the adjacency matrix, we can observe the clustering and groupings of countries that have formed preferential trade agreements. These clusters indicate the presence of regional trade blocs or alliances, where countries within each cluster have established closer trade ties among themselves. Conversely, countries that are not connected in the adjacency matrix may have limited or no preferential trade agreements with other countries in the dataset.</span>
<span id="cb69-503"><a href="#cb69-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-504"><a href="#cb69-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-505"><a href="#cb69-505" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-506"><a href="#cb69-506" aria-hidden="true" tabindex="-1"></a><span class="fu">get.adjacency</span>(edge_net)</span>
<span id="cb69-507"><a href="#cb69-507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-508"><a href="#cb69-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-509"><a href="#cb69-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-510"><a href="#cb69-510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-511"><a href="#cb69-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-512"><a href="#cb69-512" aria-hidden="true" tabindex="-1"></a>matrix_net <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(<span class="fu">get.adjacency</span>(edge_net), <span class="at">mode =</span> <span class="st">"undirected"</span>)</span>
<span id="cb69-513"><a href="#cb69-513" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb69-514"><a href="#cb69-514" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.igraph</span>(matrix_net)</span>
<span id="cb69-515"><a href="#cb69-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-516"><a href="#cb69-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-517"><a href="#cb69-517" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-518"><a href="#cb69-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-519"><a href="#cb69-519" aria-hidden="true" tabindex="-1"></a>Here we see that both graphs appear identical. This is attributed to the edge list and adjacency matrix representing an undirected network. In an undirected network, the connections between nodes are symmetric and bidirectional.</span>
<span id="cb69-520"><a href="#cb69-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-521"><a href="#cb69-521" aria-hidden="true" tabindex="-1"></a>Network representation of countries based on their inter-regional Preferential Trade Agreements (PTAs)</span>
<span id="cb69-522"><a href="#cb69-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-523"><a href="#cb69-523" aria-hidden="true" tabindex="-1"></a>*********************************************************************************</span>
<span id="cb69-524"><a href="#cb69-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-525"><a href="#cb69-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-526"><a href="#cb69-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-527"><a href="#cb69-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-528"><a href="#cb69-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-529"><a href="#cb69-529" aria-hidden="true" tabindex="-1"></a>This code enhances the Preferential Trade Agreement(PTA) network graph by attributing each trade agreement with its respective name and the year it was established.</span>
<span id="cb69-530"><a href="#cb69-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-531"><a href="#cb69-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-532"><a href="#cb69-532" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-533"><a href="#cb69-533" aria-hidden="true" tabindex="-1"></a><span class="co">#The edges of the network are referred to as E$agt_name, representing the names of the PTAs, and E$year, representing the respective years of these PTAs.</span></span>
<span id="cb69-534"><a href="#cb69-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-535"><a href="#cb69-535" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(pta_intercon_net)<span class="sc">$</span>agt_name <span class="ot">&lt;-</span> pta_intercon<span class="sc">$</span>name</span>
<span id="cb69-536"><a href="#cb69-536" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(pta_intercon_net)<span class="sc">$</span>year <span class="ot">&lt;-</span> pta_intercon<span class="sc">$</span>year</span>
<span id="cb69-537"><a href="#cb69-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-538"><a href="#cb69-538" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-539"><a href="#cb69-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-540"><a href="#cb69-540" aria-hidden="true" tabindex="-1"></a>**Analysis**</span>
<span id="cb69-541"><a href="#cb69-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-542"><a href="#cb69-542" aria-hidden="true" tabindex="-1"></a>Of note, there may be duplicate edges between pairs of countries, indicating multiple PTAs formed between them. To address this, I assign a weight to each pair based on the number of shared PTAs. To simplify the network by removing loops and consolidating duplicate edges, I utilize the simplify() function from the igraph package. This process entails aggregating the weights of duplicate edges, ensuring a streamlined representation of the network.</span>
<span id="cb69-543"><a href="#cb69-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-544"><a href="#cb69-544" aria-hidden="true" tabindex="-1"></a>**Weights**</span>
<span id="cb69-545"><a href="#cb69-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-546"><a href="#cb69-546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-547"><a href="#cb69-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-548"><a href="#cb69-548" aria-hidden="true" tabindex="-1"></a><span class="co"># Assigning weight 1 to all edges</span></span>
<span id="cb69-549"><a href="#cb69-549" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(pta_intercon_net)<span class="sc">$</span>weight <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb69-550"><a href="#cb69-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-551"><a href="#cb69-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-552"><a href="#cb69-552" aria-hidden="true" tabindex="-1"></a>pta_intercon_simp <span class="ot">&lt;-</span> <span class="fu">graph.strength</span>(pta_intercon_net, <span class="at">mode =</span> <span class="st">"all"</span>, <span class="at">loops =</span> <span class="cn">FALSE</span>)</span>
<span id="cb69-553"><a href="#cb69-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-554"><a href="#cb69-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-555"><a href="#cb69-555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-556"><a href="#cb69-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-557"><a href="#cb69-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-558"><a href="#cb69-558" aria-hidden="true" tabindex="-1"></a>**Weights Discussion**</span>
<span id="cb69-559"><a href="#cb69-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-560"><a href="#cb69-560" aria-hidden="true" tabindex="-1"></a>I first normalize the relationships within the Preferential Trade Agreement (PTA) interconnection network. I do this by assigning a uniform weight of 1 to all edges, effectively treating all connections as equal. Following this, I calculate the strength, or degree, of each node in the network, which gives me the number of connections each node, or country, has within this network. In this calculation, I treat the network as undirected and exclude any loops. The resulting data offers a straightforward view of the interconnectedness of each country within the PTA network, under the assumption that all trade agreements hold the same importance or weight.</span>
<span id="cb69-561"><a href="#cb69-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-562"><a href="#cb69-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-563"><a href="#cb69-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-564"><a href="#cb69-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-565"><a href="#cb69-565" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Vertices and Edges</span></span>
<span id="cb69-566"><a href="#cb69-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-567"><a href="#cb69-567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-568"><a href="#cb69-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-569"><a href="#cb69-569" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">V</span>(pta_intercon_net)<span class="sc">$</span>name)</span>
<span id="cb69-570"><a href="#cb69-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-571"><a href="#cb69-571" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-572"><a href="#cb69-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-573"><a href="#cb69-573" aria-hidden="true" tabindex="-1"></a>**Vertices and Edges**</span>
<span id="cb69-574"><a href="#cb69-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-575"><a href="#cb69-575" aria-hidden="true" tabindex="-1"></a>number of vertices,and edges in the network</span>
<span id="cb69-576"><a href="#cb69-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-577"><a href="#cb69-577" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-578"><a href="#cb69-578" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pta_intercon_net)</span>
<span id="cb69-579"><a href="#cb69-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-580"><a href="#cb69-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-581"><a href="#cb69-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-584"><a href="#cb69-584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb69-585"><a href="#cb69-585" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">vcount</span>(pta_intercon_net))</span>
<span id="cb69-586"><a href="#cb69-586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-587"><a href="#cb69-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-588"><a href="#cb69-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-589"><a href="#cb69-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-590"><a href="#cb69-590" aria-hidden="true" tabindex="-1"></a>The summary indicates the number of **vertices(nodes or countries)** **(191)** and edges **(9316)** in the graph. The following line presents a list of attributes categorized by their kind (g for graph, v for vertex, and e for edge).</span>
<span id="cb69-591"><a href="#cb69-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-592"><a href="#cb69-592" aria-hidden="true" tabindex="-1"></a>********************************************************************************</span>
<span id="cb69-593"><a href="#cb69-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-594"><a href="#cb69-594" aria-hidden="true" tabindex="-1"></a><span class="fu">## Network Visualizations</span></span>
<span id="cb69-595"><a href="#cb69-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-596"><a href="#cb69-596" aria-hidden="true" tabindex="-1"></a>We will generate two separate plots: one depicting the Inter-regional PTA network consisting exclusively of Inter-regional PTAs, and another illustrating the Bilateral PTA network that includes Bilateral agreements regardless of whether they are Inter-regional or regional in nature.</span>
<span id="cb69-597"><a href="#cb69-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-598"><a href="#cb69-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-599"><a href="#cb69-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-600"><a href="#cb69-600" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-601"><a href="#cb69-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-602"><a href="#cb69-602" aria-hidden="true" tabindex="-1"></a>pta_bilat <span class="ot">&lt;-</span> pta_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(typememb <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb69-603"><a href="#cb69-603" aria-hidden="true" tabindex="-1"></a>pta_bilat_net <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> pta_bilat, <span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb69-604"><a href="#cb69-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-605"><a href="#cb69-605" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(pta_bilat_net)<span class="sc">$</span>agt_name <span class="ot">&lt;-</span> pta_bilat<span class="sc">$</span>name</span>
<span id="cb69-606"><a href="#cb69-606" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(pta_bilat_net)<span class="sc">$</span>year <span class="ot">&lt;-</span> pta_bilat<span class="sc">$</span>year</span>
<span id="cb69-607"><a href="#cb69-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-608"><a href="#cb69-608" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(pta_bilat_net)<span class="sc">$</span>weight <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb69-609"><a href="#cb69-609" aria-hidden="true" tabindex="-1"></a>pta_bilat_simp <span class="ot">&lt;-</span> <span class="fu">simplify</span>(pta_bilat_net)</span>
<span id="cb69-610"><a href="#cb69-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-611"><a href="#cb69-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-612"><a href="#cb69-612" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-613"><a href="#cb69-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-614"><a href="#cb69-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-615"><a href="#cb69-615" aria-hidden="true" tabindex="-1"></a>Network depiction of Inter-regional Preferential Trade Agreements (PTA)</span>
<span id="cb69-616"><a href="#cb69-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-617"><a href="#cb69-617" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-618"><a href="#cb69-618" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb69-619"><a href="#cb69-619" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.igraph</span>(pta_intercon_net,</span>
<span id="cb69-620"><a href="#cb69-620" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.size =</span> <span class="dv">5</span>,</span>
<span id="cb69-621"><a href="#cb69-621" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.color =</span> <span class="st">"red"</span>,</span>
<span id="cb69-622"><a href="#cb69-622" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.label =</span> <span class="fu">V</span>(pta_intercon_net)<span class="sc">$</span>name,</span>
<span id="cb69-623"><a href="#cb69-623" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.label.cex =</span> .<span class="dv">5</span>,</span>
<span id="cb69-624"><a href="#cb69-624" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.frame.color =</span> <span class="cn">NA</span>,</span>
<span id="cb69-625"><a href="#cb69-625" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> layout.fruchterman.reingold,</span>
<span id="cb69-626"><a href="#cb69-626" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">"Network of Inter-regional Preferential Trade Agreements(PTA)"</span></span>
<span id="cb69-627"><a href="#cb69-627" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb69-628"><a href="#cb69-628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-629"><a href="#cb69-629" aria-hidden="true" tabindex="-1"></a>Using all of the data depicts a "hairball" I will therefore use a subset of the data for more comprehensible data representation.</span>
<span id="cb69-630"><a href="#cb69-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-631"><a href="#cb69-631" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-632"><a href="#cb69-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-633"><a href="#cb69-633" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(pta_bilat_simp)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">E</span>(pta_bilat_simp)<span class="sc">$</span>weight <span class="sc">&gt;</span> <span class="dv">1</span>,<span class="st">'blue'</span>, <span class="st">'grey'</span>)</span>
<span id="cb69-634"><a href="#cb69-634" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.igraph</span>(pta_bilat_simp,</span>
<span id="cb69-635"><a href="#cb69-635" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.size =</span> <span class="dv">5</span>,</span>
<span id="cb69-636"><a href="#cb69-636" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.color =</span> <span class="st">"red"</span>,</span>
<span id="cb69-637"><a href="#cb69-637" aria-hidden="true" tabindex="-1"></a>            <span class="at">vekrtex.label =</span> <span class="fu">V</span>(pta_bilat_simp)<span class="sc">$</span>name,</span>
<span id="cb69-638"><a href="#cb69-638" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.label.cex =</span> .<span class="dv">5</span>,</span>
<span id="cb69-639"><a href="#cb69-639" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.frame.color =</span> <span class="cn">NA</span>,</span>
<span id="cb69-640"><a href="#cb69-640" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> layout.fruchterman.reingold,</span>
<span id="cb69-641"><a href="#cb69-641" aria-hidden="true" tabindex="-1"></a>            <span class="at">edge.width =</span> <span class="fu">E</span>(pta_bilat_simp)<span class="sc">$</span>weight,</span>
<span id="cb69-642"><a href="#cb69-642" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">"Network of Bilateral Preferential Trade Agreements(PTA)"</span></span>
<span id="cb69-643"><a href="#cb69-643" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb69-644"><a href="#cb69-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-645"><a href="#cb69-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-646"><a href="#cb69-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-647"><a href="#cb69-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-648"><a href="#cb69-648" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-649"><a href="#cb69-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-650"><a href="#cb69-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-651"><a href="#cb69-651" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-652"><a href="#cb69-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-653"><a href="#cb69-653" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot of Bilateral network</span></span>
<span id="cb69-654"><a href="#cb69-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-655"><a href="#cb69-655" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(pta_intercon_net)<span class="sc">$</span>bilateral <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pta_intercon<span class="sc">$</span>typememb <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb69-656"><a href="#cb69-656" aria-hidden="true" tabindex="-1"></a>bilateral_var <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">E</span>(pta_intercon_net)<span class="sc">$</span>bilateral)</span>
<span id="cb69-657"><a href="#cb69-657" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bilateral_var, <span class="fu">aes</span>(<span class="at">x =</span><span class="fu">E</span>(pta_intercon_net)<span class="sc">$</span>bilateral)) <span class="sc">+</span></span>
<span id="cb69-658"><a href="#cb69-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb69-659"><a href="#cb69-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb69-660"><a href="#cb69-660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Bilateral/Multilateral Inter-Regional Preferential Trade Agreements (PTA)"</span>, <span class="at">y =</span> <span class="st">"Count"</span>)</span>
<span id="cb69-661"><a href="#cb69-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-662"><a href="#cb69-662" aria-hidden="true" tabindex="-1"></a><span class="co">#png(filename = "network4.png") # save as png</span></span>
<span id="cb69-663"><a href="#cb69-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-664"><a href="#cb69-664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-665"><a href="#cb69-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-666"><a href="#cb69-666" aria-hidden="true" tabindex="-1"></a>The bar plot shows the distribution and relative importance of bilateral and multilateral Preferential Trade Agreements (PTAs) within the framework of social network analysis applied to inter-regional trade relationships. Notably, the left bar exhibits a considerably higher frequency of PTAs compared to the right bar, indicating a distinct prevalence of bilateral PTAs in the network.</span>
<span id="cb69-667"><a href="#cb69-667" aria-hidden="true" tabindex="-1"></a>Conversely,the lower frequency of multilateral PTAs on the right bar signifies a relatively reduced presence of agreements involving multiple nations in the network. Multilateral PTAs typically require more extensive negotiations and coordination among a larger number of countries. The scarcity of such agreements suggests a less pronounced emphasis on broader inter-regional collaboration within the analyzed trade network.</span>
<span id="cb69-668"><a href="#cb69-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-669"><a href="#cb69-669" aria-hidden="true" tabindex="-1"></a>******************************************************************************</span>
<span id="cb69-670"><a href="#cb69-670" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-671"><a href="#cb69-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-672"><a href="#cb69-672" aria-hidden="true" tabindex="-1"></a><span class="co">#bilateral inter-regional PTAs</span></span>
<span id="cb69-673"><a href="#cb69-673" aria-hidden="true" tabindex="-1"></a>pta_intercon_bilat <span class="ot">&lt;-</span> <span class="fu">subgraph.edges</span>(pta_intercon_net,<span class="fu">which</span>(<span class="fu">E</span>(pta_intercon_net)<span class="sc">$</span>bilateral <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb69-674"><a href="#cb69-674" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pta_intercon_bilat,</span>
<span id="cb69-675"><a href="#cb69-675" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size =</span> <span class="dv">5</span>,</span>
<span id="cb69-676"><a href="#cb69-676" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="st">"red"</span>,</span>
<span id="cb69-677"><a href="#cb69-677" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label =</span> <span class="fu">V</span>(pta_intercon_bilat)<span class="sc">$</span>name,</span>
<span id="cb69-678"><a href="#cb69-678" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.cex =</span> .<span class="dv">5</span>,</span>
<span id="cb69-679"><a href="#cb69-679" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.frame.color =</span> <span class="cn">NA</span>,</span>
<span id="cb69-680"><a href="#cb69-680" aria-hidden="true" tabindex="-1"></a>     <span class="at">layout =</span> layout.fruchterman.reingold,</span>
<span id="cb69-681"><a href="#cb69-681" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Network of Bilateral Inter-regional PTAs"</span>)</span>
<span id="cb69-682"><a href="#cb69-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-683"><a href="#cb69-683" aria-hidden="true" tabindex="-1"></a><span class="co">#(filename = "network5.png") # save as png</span></span>
<span id="cb69-684"><a href="#cb69-684" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-685"><a href="#cb69-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-686"><a href="#cb69-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-687"><a href="#cb69-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-688"><a href="#cb69-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-689"><a href="#cb69-689" aria-hidden="true" tabindex="-1"></a>**Eigen Centrality Intercontinental Region**</span>
<span id="cb69-690"><a href="#cb69-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-691"><a href="#cb69-691" aria-hidden="true" tabindex="-1"></a>I plot an Eigen centrality for the intercontinetal region which quantifies a country's influence by factoring both the quantity and quality of its trade agreements.</span>
<span id="cb69-692"><a href="#cb69-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-693"><a href="#cb69-693" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-694"><a href="#cb69-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-695"><a href="#cb69-695" aria-hidden="true" tabindex="-1"></a><span class="co"># eigen centrality </span></span>
<span id="cb69-696"><a href="#cb69-696" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(pta_intercon_bilat)<span class="sc">$</span>eigen_cen <span class="ot">&lt;-</span> <span class="fu">eigen_centrality</span>(pta_intercon_bilat)<span class="sc">$</span>vector</span>
<span id="cb69-697"><a href="#cb69-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-698"><a href="#cb69-698" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>((<span class="fu">V</span>(pta_intercon_bilat)))</span>
<span id="cb69-699"><a href="#cb69-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-700"><a href="#cb69-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-701"><a href="#cb69-701" aria-hidden="true" tabindex="-1"></a>eigen_cen <span class="ot">&lt;-</span> <span class="fu">eigen_centrality</span>(pta_intercon_bilat)<span class="sc">$</span>vector</span>
<span id="cb69-702"><a href="#cb69-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-703"><a href="#cb69-703" aria-hidden="true" tabindex="-1"></a><span class="co"># bar plot</span></span>
<span id="cb69-704"><a href="#cb69-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-705"><a href="#cb69-705" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(eigen_cen, <span class="at">names.arg =</span> <span class="fu">V</span>(pta_intercon_bilat)<span class="sc">$</span>name, <span class="at">xlab =</span> <span class="st">"Country"</span>, <span class="at">ylab =</span> <span class="st">"Eigen Centrality"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb69-706"><a href="#cb69-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-707"><a href="#cb69-707" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">"Eigen Centrality of Countries in PTA Intercontinental Bilateral Network"</span>)</span>
<span id="cb69-708"><a href="#cb69-708" aria-hidden="true" tabindex="-1"></a><span class="co">#png(filename = "network8.png") # save as png</span></span>
<span id="cb69-709"><a href="#cb69-709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-710"><a href="#cb69-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-711"><a href="#cb69-711" aria-hidden="true" tabindex="-1"></a>**Analysis**</span>
<span id="cb69-712"><a href="#cb69-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-713"><a href="#cb69-713" aria-hidden="true" tabindex="-1"></a>This bar plot represents the eigen centrality values of countries in the PTA Intercontinental Bilateral network. This visualization helps to analyze and interpret the relative importance of countries based on their connections within the network. Countries with higher eigen centrality scores are considered more influential and have stronger trade relationships, while those with lower scores have less impact. This helps identify key players and the distribution of power within the PTA network.</span>
<span id="cb69-714"><a href="#cb69-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-715"><a href="#cb69-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-716"><a href="#cb69-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-717"><a href="#cb69-717" aria-hidden="true" tabindex="-1"></a>********************************************************************************</span>
<span id="cb69-718"><a href="#cb69-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-719"><a href="#cb69-719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-720"><a href="#cb69-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-721"><a href="#cb69-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-722"><a href="#cb69-722" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(pta_intercon_bilat)<span class="sc">$</span>weight <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb69-723"><a href="#cb69-723" aria-hidden="true" tabindex="-1"></a>pta_intercon_bilat_sim <span class="ot">&lt;-</span> pta_intercon_bilat <span class="sc">%&gt;%</span> <span class="fu">simplify</span>(<span class="at">edge.attr.comb =</span> <span class="fu">list</span>(<span class="at">weight =</span> <span class="st">"sum"</span>))</span>
<span id="cb69-724"><a href="#cb69-724" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pta_intercon_bilat_sim,</span>
<span id="cb69-725"><a href="#cb69-725" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size =</span> <span class="dv">5</span>,</span>
<span id="cb69-726"><a href="#cb69-726" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="st">"blue"</span>,</span>
<span id="cb69-727"><a href="#cb69-727" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label =</span> <span class="fu">V</span>(pta_intercon_bilat_sim)<span class="sc">$</span>name,</span>
<span id="cb69-728"><a href="#cb69-728" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label.cex =</span> .<span class="dv">5</span>,</span>
<span id="cb69-729"><a href="#cb69-729" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.frame.color =</span> <span class="cn">NA</span>,</span>
<span id="cb69-730"><a href="#cb69-730" aria-hidden="true" tabindex="-1"></a>     <span class="at">edge.width =</span> <span class="fu">E</span>(pta_intercon_bilat_sim)<span class="sc">$</span>weight,</span>
<span id="cb69-731"><a href="#cb69-731" aria-hidden="true" tabindex="-1"></a>     <span class="at">layout =</span> layout.fruchterman.reingold,</span>
<span id="cb69-732"><a href="#cb69-732" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Network of Bilateral Inter-regional Preferential Trade Agreements(PTAs)</span></span>
<span id="cb69-733"><a href="#cb69-733" aria-hidden="true" tabindex="-1"></a><span class="st">     "</span>)</span>
<span id="cb69-734"><a href="#cb69-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-735"><a href="#cb69-735" aria-hidden="true" tabindex="-1"></a><span class="co">#png(filename = "network6.png") # save as png</span></span>
<span id="cb69-736"><a href="#cb69-736" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-737"><a href="#cb69-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-738"><a href="#cb69-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-739"><a href="#cb69-739" aria-hidden="true" tabindex="-1"></a>*******************************************************************************</span>
<span id="cb69-740"><a href="#cb69-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-741"><a href="#cb69-741" aria-hidden="true" tabindex="-1"></a><span class="fu">## Density and Transitivity</span></span>
<span id="cb69-742"><a href="#cb69-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-743"><a href="#cb69-743" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-744"><a href="#cb69-744" aria-hidden="true" tabindex="-1"></a>bilat_density <span class="ot">&lt;-</span> <span class="fu">edge_density</span>(pta_intercon_bilat)</span>
<span id="cb69-745"><a href="#cb69-745" aria-hidden="true" tabindex="-1"></a>bilat_transitivity <span class="ot">&lt;-</span> <span class="fu">transitivity</span>(pta_intercon_bilat)</span>
<span id="cb69-746"><a href="#cb69-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-747"><a href="#cb69-747" aria-hidden="true" tabindex="-1"></a><span class="co">#density</span></span>
<span id="cb69-748"><a href="#cb69-748" aria-hidden="true" tabindex="-1"></a>pta_density <span class="ot">&lt;-</span> <span class="fu">edge_density</span>(pta_intercon_net)</span>
<span id="cb69-749"><a href="#cb69-749" aria-hidden="true" tabindex="-1"></a>pta_transitivity <span class="ot">&lt;-</span> <span class="fu">transitivity</span>(pta_intercon_net)</span>
<span id="cb69-750"><a href="#cb69-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-751"><a href="#cb69-751" aria-hidden="true" tabindex="-1"></a>bilat_density</span>
<span id="cb69-752"><a href="#cb69-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-753"><a href="#cb69-753" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-754"><a href="#cb69-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-755"><a href="#cb69-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-756"><a href="#cb69-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-757"><a href="#cb69-757" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-758"><a href="#cb69-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-759"><a href="#cb69-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-760"><a href="#cb69-760" aria-hidden="true" tabindex="-1"></a>pta_bilat_2 <span class="ot">&lt;-</span>  <span class="fu">subgraph.edges</span>(pta_bilat_simp,<span class="fu">which</span>(<span class="fu">E</span>(pta_bilat_simp)<span class="sc">$</span>weight <span class="sc">&gt;</span> <span class="dv">1</span>))</span>
<span id="cb69-761"><a href="#cb69-761" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.igraph</span>(pta_bilat_2,</span>
<span id="cb69-762"><a href="#cb69-762" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.size =</span> <span class="dv">5</span>,</span>
<span id="cb69-763"><a href="#cb69-763" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.color =</span> <span class="st">"green"</span>,</span>
<span id="cb69-764"><a href="#cb69-764" aria-hidden="true" tabindex="-1"></a>            <span class="at">vekrtex.label =</span> <span class="fu">V</span>(pta_bilat_2)<span class="sc">$</span>name,</span>
<span id="cb69-765"><a href="#cb69-765" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.label.cex =</span> .<span class="dv">5</span>,</span>
<span id="cb69-766"><a href="#cb69-766" aria-hidden="true" tabindex="-1"></a>            <span class="at">vertex.frame.color =</span> <span class="cn">NA</span>,</span>
<span id="cb69-767"><a href="#cb69-767" aria-hidden="true" tabindex="-1"></a>            <span class="at">layout =</span> layout.fruchterman.reingold,</span>
<span id="cb69-768"><a href="#cb69-768" aria-hidden="true" tabindex="-1"></a>            <span class="at">edge.width =</span> <span class="fu">E</span>(pta_bilat_2)<span class="sc">$</span>weight,</span>
<span id="cb69-769"><a href="#cb69-769" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">"Countries with more than One Bilateral PTAs"</span></span>
<span id="cb69-770"><a href="#cb69-770" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb69-771"><a href="#cb69-771" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">filename =</span> <span class="st">"network11.png"</span>) <span class="co"># save as png</span></span>
<span id="cb69-772"><a href="#cb69-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-773"><a href="#cb69-773" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-774"><a href="#cb69-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-775"><a href="#cb69-775" aria-hidden="true" tabindex="-1"></a>********************************************************************************</span>
<span id="cb69-776"><a href="#cb69-776" aria-hidden="true" tabindex="-1"></a><span class="fu">## Community</span></span>
<span id="cb69-777"><a href="#cb69-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-778"><a href="#cb69-778" aria-hidden="true" tabindex="-1"></a>**Walktrap Algorithim**</span>
<span id="cb69-779"><a href="#cb69-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-780"><a href="#cb69-780" aria-hidden="true" tabindex="-1"></a>For this project examining the Preferential Trade Agreement (PTA) network, I use the Walktrap algorithm, we examined in the 7th tutorial. This approach seeks to find communities within this complex trade network by employing random walks. The guiding principle behind this method is that shorter, random walks will likely stay within the confines of a single community. By applying the Walktrap algorithm to the PTA network, I aim to discern the community structures present within this global trade landscape, thereby shedding light on the intricate dynamics and patterns that shape international trade agreements.</span>
<span id="cb69-781"><a href="#cb69-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-782"><a href="#cb69-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-783"><a href="#cb69-783" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-784"><a href="#cb69-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-785"><a href="#cb69-785" aria-hidden="true" tabindex="-1"></a>intercon_bilat_walktrap <span class="ot">&lt;-</span> <span class="fu">cluster_walktrap</span>(pta_intercon_bilat_sim)</span>
<span id="cb69-786"><a href="#cb69-786" aria-hidden="true" tabindex="-1"></a><span class="fu">membership</span>(intercon_bilat_walktrap)</span>
<span id="cb69-787"><a href="#cb69-787" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-788"><a href="#cb69-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-789"><a href="#cb69-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-790"><a href="#cb69-790" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-791"><a href="#cb69-791" aria-hidden="true" tabindex="-1"></a><span class="co">#bilateral walktrap</span></span>
<span id="cb69-792"><a href="#cb69-792" aria-hidden="true" tabindex="-1"></a><span class="fu">sizes</span>(intercon_bilat_walktrap)</span>
<span id="cb69-793"><a href="#cb69-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-794"><a href="#cb69-794" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-795"><a href="#cb69-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-796"><a href="#cb69-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-797"><a href="#cb69-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-798"><a href="#cb69-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-799"><a href="#cb69-799" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-800"><a href="#cb69-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-801"><a href="#cb69-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-802"><a href="#cb69-802" aria-hidden="true" tabindex="-1"></a><span class="co"># walktrap algorithim output data is in a vector named "output"</span></span>
<span id="cb69-803"><a href="#cb69-803" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">18</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">20</span>, <span class="dv">3</span>, <span class="dv">12</span>, <span class="dv">2</span>)</span>
<span id="cb69-804"><a href="#cb69-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-805"><a href="#cb69-805" aria-hidden="true" tabindex="-1"></a><span class="co"># data frame</span></span>
<span id="cb69-806"><a href="#cb69-806" aria-hidden="true" tabindex="-1"></a>output_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb69-807"><a href="#cb69-807" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Community"</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"Community_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(output)),</span>
<span id="cb69-808"><a href="#cb69-808" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Size"</span> <span class="ot">=</span> output</span>
<span id="cb69-809"><a href="#cb69-809" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-810"><a href="#cb69-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-811"><a href="#cb69-811" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the data frame</span></span>
<span id="cb69-812"><a href="#cb69-812" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(output_df)</span>
<span id="cb69-813"><a href="#cb69-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-814"><a href="#cb69-814" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-815"><a href="#cb69-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-816"><a href="#cb69-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-817"><a href="#cb69-817" aria-hidden="true" tabindex="-1"></a>**Preferential Trade Agreement(PTA) Walktrap Analysis**</span>
<span id="cb69-818"><a href="#cb69-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-819"><a href="#cb69-819" aria-hidden="true" tabindex="-1"></a>The Walktrap algorithm's output portrays the distribution of nodes across various communities in the Preferential Trade Agreement (PTA) network. Each community number is paired with a value that signifies the count of nodes (or countries) within that specific community.</span>
<span id="cb69-820"><a href="#cb69-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-821"><a href="#cb69-821" aria-hidden="true" tabindex="-1"></a>Here is what we can infer:</span>
<span id="cb69-822"><a href="#cb69-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-823"><a href="#cb69-823" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Community 1 consists of 11 nodes.</span>
<span id="cb69-824"><a href="#cb69-824" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Community 2 has 14 nodes.</span>
<span id="cb69-825"><a href="#cb69-825" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Community 3 comprises 18 nodes.</span>
<span id="cb69-826"><a href="#cb69-826" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Community 4 includes 4 nodes.</span>
<span id="cb69-827"><a href="#cb69-827" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Community 5 houses 2 nodes.</span>
<span id="cb69-828"><a href="#cb69-828" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Community 6 holds 20 nodes.</span>
<span id="cb69-829"><a href="#cb69-829" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Community 7 encapsulates 3 nodes.</span>
<span id="cb69-830"><a href="#cb69-830" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Community 8 encompasses 12 nodes.</span>
<span id="cb69-831"><a href="#cb69-831" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Community 9 shelters 2 nodes.</span>
<span id="cb69-832"><a href="#cb69-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-833"><a href="#cb69-833" aria-hidden="true" tabindex="-1"></a>This distribution provides a snapshot of the diverse interconnectedness among global trade relationships in the PTA network. Communities with larger node counts might represent robustly interconnected trading partnerships, while smaller communities may indicate more specific or self-contained trade relationships.</span>
<span id="cb69-834"><a href="#cb69-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-835"><a href="#cb69-835" aria-hidden="true" tabindex="-1"></a><span class="fu">## Density </span></span>
<span id="cb69-836"><a href="#cb69-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-837"><a href="#cb69-837" aria-hidden="true" tabindex="-1"></a>**PTA Bilateral Density Analysis**</span>
<span id="cb69-838"><a href="#cb69-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-839"><a href="#cb69-839" aria-hidden="true" tabindex="-1"></a>The value 0.04924761 represents the bilateral density in the context of the Preferential Trade Agreement (PTA) dataset. Network density measures the actual connections in a network relative to the total possible connections. </span>
<span id="cb69-840"><a href="#cb69-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-841"><a href="#cb69-841" aria-hidden="true" tabindex="-1"></a>Here, a density of 0.04924761 suggests that nearly 4.92% of all potential bilateral trade agreements among countries are realized. This means, on an average, a country in the network has a trade agreement with approximately 4.92% of all other potential trading partners. Given that this value is relatively low, it indicates that the bilateral trade network is sparsely connected, suggesting the potential for many more trade agreements to be formed.</span>
<span id="cb69-842"><a href="#cb69-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-843"><a href="#cb69-843" aria-hidden="true" tabindex="-1"></a><span class="fu">## Transitivity</span></span>
<span id="cb69-844"><a href="#cb69-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-845"><a href="#cb69-845" aria-hidden="true" tabindex="-1"></a>**PTA Bilateral Transitivity**</span>
<span id="cb69-846"><a href="#cb69-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-847"><a href="#cb69-847" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-848"><a href="#cb69-848" aria-hidden="true" tabindex="-1"></a>bilat_transitivity</span>
<span id="cb69-849"><a href="#cb69-849" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-850"><a href="#cb69-850" aria-hidden="true" tabindex="-1"></a>**Analysis**</span>
<span id="cb69-851"><a href="#cb69-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-852"><a href="#cb69-852" aria-hidden="true" tabindex="-1"></a>In the context of the Preferential Trade Agreement (PTA) dataset, a bilateral transitivity of 0.1098987 signifies that about 11% of the potential triangular trade relationships among countries are realized. This implies that if two countries both have a PTA with a third one, there is an approximately 11% probability that these two countries will also have a trade agreement directly with each other.</span>
<span id="cb69-853"><a href="#cb69-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-854"><a href="#cb69-854" aria-hidden="true" tabindex="-1"></a>This relatively low transitivity index suggests that the formation of PTAs is not extensively based on the principle of transitivity. Rather, it underscores that the establishment of PTAs among countries may be influenced by a multitude of factors, including geographical proximity and political or economic dynamics.</span>
<span id="cb69-855"><a href="#cb69-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-856"><a href="#cb69-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-857"><a href="#cb69-857" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dendrogram</span></span>
<span id="cb69-858"><a href="#cb69-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-859"><a href="#cb69-859" aria-hidden="true" tabindex="-1"></a>**Dendrogram**</span>
<span id="cb69-860"><a href="#cb69-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-861"><a href="#cb69-861" aria-hidden="true" tabindex="-1"></a>In the context of the Preferential Trade Agreement (PTA) dataset focusing on the variables, the dendrogram emerged as an influential graphical representation. It conveys the nested arrangement of relationships among countries or corresponding trade agreements, an arrangement that is guided by specified attributes or significant performance indicators. This hierarchical classification reveals nuanced patterns in international trade interactions, which contributes to a better understanding of intricate PTAs. </span>
<span id="cb69-862"><a href="#cb69-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-863"><a href="#cb69-863" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,results='hide'}</span></span>
<span id="cb69-864"><a href="#cb69-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-865"><a href="#cb69-865" aria-hidden="true" tabindex="-1"></a>dist_matrix <span class="ot">&lt;-</span> <span class="fu">dist</span>(pta_data) </span>
<span id="cb69-866"><a href="#cb69-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-867"><a href="#cb69-867" aria-hidden="true" tabindex="-1"></a><span class="co"># Hierarchical clustering using complete linkage</span></span>
<span id="cb69-868"><a href="#cb69-868" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dist_matrix, <span class="at">method =</span> <span class="st">"complete"</span>)</span>
<span id="cb69-869"><a href="#cb69-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-870"><a href="#cb69-870" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot dendrogram</span></span>
<span id="cb69-871"><a href="#cb69-871" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.6</span>, <span class="at">main =</span> <span class="st">"Dendrogram for PTA Data"</span>)</span>
<span id="cb69-872"><a href="#cb69-872" aria-hidden="true" tabindex="-1"></a><span class="co">#png(filename = "network9.png") # save as png</span></span>
<span id="cb69-873"><a href="#cb69-873" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb69-874"><a href="#cb69-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-875"><a href="#cb69-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-876"><a href="#cb69-876" aria-hidden="true" tabindex="-1"></a>********************************************************************************</span>
<span id="cb69-877"><a href="#cb69-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-878"><a href="#cb69-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-879"><a href="#cb69-879" aria-hidden="true" tabindex="-1"></a><span class="fu">## Discussion</span></span>
<span id="cb69-880"><a href="#cb69-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-881"><a href="#cb69-881" aria-hidden="true" tabindex="-1"></a>The Preferential Trade Agreement (PTA) dataset, spanning from 1958 to 2021, offers a comprehensive view into the evolution of global trade relationships. Delving into this dataset  has afforded me a richer understanding of social network analysis in the context of international trade. This journey, albeit marked by a steep learning curve, has been an enlightening one.</span>
<span id="cb69-882"><a href="#cb69-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-883"><a href="#cb69-883" aria-hidden="true" tabindex="-1"></a>The dominance of bilateral PTAs suggests that countries in the network tend to engage in preferential trade arrangements on a bilateral basis, forming direct connections with specific trading partners. This finding underscores the significance of bilateral relationships in shaping the overall structure of the inter-regional trade network. Bilateral PTAs are often favored due to their simplicity in negotiation and implementation, enabling countries to establish tailored agreements that cater to their specific needs and preferences.<span class="ot">[^4]</span> These agreements facilitate focused interactions between pairs of countries, fostering closer economic ties and potentially enhancing trade efficiency and cooperation.</span>
<span id="cb69-884"><a href="#cb69-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-885"><a href="#cb69-885" aria-hidden="true" tabindex="-1"></a>*************************************************************************************</span>
<span id="cb69-886"><a href="#cb69-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-887"><a href="#cb69-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-888"><a href="#cb69-888" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion/Reflection</span></span>
<span id="cb69-889"><a href="#cb69-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-890"><a href="#cb69-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-891"><a href="#cb69-891" aria-hidden="true" tabindex="-1"></a>Prior to this project, the critical role that variable selection plays in shaping network interpretation was an aspect I hadn't fully appreciated. Now, I understand that even with the PTA dataset, or for any social network analysis, significant effort can be poured into understanding the relationships between just a couple of variables to derive meaningful insights. Upon reflection, the prospect of analyzing data from more recent years to assess how key features like **node centrality,transitivity,density** and community structure have evolved in the midst of global challenges like the COVID-19 pandemic would merit future study, especially considering recent challenges in global trade and supply chain restrictions.</span>
<span id="cb69-892"><a href="#cb69-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-893"><a href="#cb69-893" aria-hidden="true" tabindex="-1"></a>Despite the hurdles encountered, the process of dissecting this dataset has been rewarding. Every decision made echoed in the analysis outcomes, underscoring the potential for subtle shifts to lead to major interpretation changes. I plan to continue my exploration of the PTA data and branch out to related projects to enhance my understanding of Social Network Analysis. </span>
<span id="cb69-894"><a href="#cb69-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-895"><a href="#cb69-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-896"><a href="#cb69-896" aria-hidden="true" tabindex="-1"></a>**********************************************************************************</span>
<span id="cb69-897"><a href="#cb69-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-898"><a href="#cb69-898" aria-hidden="true" tabindex="-1"></a><span class="fu">## References/Resources</span></span>
<span id="cb69-899"><a href="#cb69-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-900"><a href="#cb69-900" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]: https://www.designoftradeagreements.org/project-description/</span></span>
<span id="cb69-901"><a href="#cb69-901" aria-hidden="true" tabindex="-1"></a><span class="ot">[^2]: </span>Wasserman, S., &amp; Faust, K. (1994). Social network analysis: Methods and </span>
<span id="cb69-902"><a href="#cb69-902" aria-hidden="true" tabindex="-1"></a>      applications. Cambridge University Press.</span>
<span id="cb69-903"><a href="#cb69-903" aria-hidden="true" tabindex="-1"></a><span class="ot">[^3]: </span>Newman, M. E. J. (2018). Networks. Oxford University Press.     </span>
<span id="cb69-904"><a href="#cb69-904" aria-hidden="true" tabindex="-1"></a><span class="ot">[^4]: https://www.wto.org/</span></span>
<span id="cb69-905"><a href="#cb69-905" aria-hidden="true" tabindex="-1"></a><span class="ot">[^5]: </span>Robins, G., Pattison, P., Kalish, Y., &amp; Lusher, D. (2007). An Introduction to Exponential Random Graph (p*) Models for Social Networks. Social Networks, 29, 172-191. </span>
<span id="cb69-906"><a href="#cb69-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-907"><a href="#cb69-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-908"><a href="#cb69-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-909"><a href="#cb69-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-910"><a href="#cb69-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-911"><a href="#cb69-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-912"><a href="#cb69-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-913"><a href="#cb69-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-914"><a href="#cb69-914" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>